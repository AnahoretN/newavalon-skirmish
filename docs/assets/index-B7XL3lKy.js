(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();function Gm(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Sc={exports:{}},Vi={},jc={exports:{}},He={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ja=Symbol.for("react.element"),Vm=Symbol.for("react.portal"),Hm=Symbol.for("react.fragment"),$m=Symbol.for("react.strict_mode"),Wm=Symbol.for("react.profiler"),Km=Symbol.for("react.provider"),qm=Symbol.for("react.context"),Jm=Symbol.for("react.forward_ref"),Ym=Symbol.for("react.suspense"),Zm=Symbol.for("react.memo"),Qm=Symbol.for("react.lazy"),ru=Symbol.iterator;function Xm(e){return e===null||typeof e!="object"?null:(e=ru&&e[ru]||e["@@iterator"],typeof e=="function"?e:null)}var Ic={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Nc=Object.assign,_c={};function So(e,t,n){this.props=e,this.context=t,this.refs=_c,this.updater=n||Ic}So.prototype.isReactComponent={};So.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};So.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Dc(){}Dc.prototype=So.prototype;function $l(e,t,n){this.props=e,this.context=t,this.refs=_c,this.updater=n||Ic}var Wl=$l.prototype=new Dc;Wl.constructor=$l;Nc(Wl,So.prototype);Wl.isPureReactComponent=!0;var ou=Array.isArray,Rc=Object.prototype.hasOwnProperty,Kl={current:null},Ac={key:!0,ref:!0,__self:!0,__source:!0};function Oc(e,t,n){var r,o={},a=null,s=null;if(t!=null)for(r in t.ref!==void 0&&(s=t.ref),t.key!==void 0&&(a=""+t.key),t)Rc.call(t,r)&&!Ac.hasOwnProperty(r)&&(o[r]=t[r]);var l=arguments.length-2;if(l===1)o.children=n;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];o.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)o[r]===void 0&&(o[r]=l[r]);return{$$typeof:ja,type:e,key:a,ref:s,props:o,_owner:Kl.current}}function eh(e,t){return{$$typeof:ja,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function ql(e){return typeof e=="object"&&e!==null&&e.$$typeof===ja}function th(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var au=/\/+/g;function us(e,t){return typeof e=="object"&&e!==null&&e.key!=null?th(""+e.key):t.toString(36)}function ti(e,t,n,r,o){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var s=!1;if(e===null)s=!0;else switch(a){case"string":case"number":s=!0;break;case"object":switch(e.$$typeof){case ja:case Vm:s=!0}}if(s)return s=e,o=o(s),e=r===""?"."+us(s,0):r,ou(o)?(n="",e!=null&&(n=e.replace(au,"$&/")+"/"),ti(o,t,n,"",function(d){return d})):o!=null&&(ql(o)&&(o=eh(o,n+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(au,"$&/")+"/")+e)),t.push(o)),1;if(s=0,r=r===""?".":r+":",ou(e))for(var l=0;l<e.length;l++){a=e[l];var c=r+us(a,l);s+=ti(a,t,n,c,o)}else if(c=Xm(e),typeof c=="function")for(e=c.call(e),l=0;!(a=e.next()).done;)a=a.value,c=r+us(a,l++),s+=ti(a,t,n,c,o);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return s}function Oa(e,t,n){if(e==null)return e;var r=[],o=0;return ti(e,r,"","",function(a){return t.call(n,a,o++)}),r}function nh(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var $t={current:null},ni={transition:null},rh={ReactCurrentDispatcher:$t,ReactCurrentBatchConfig:ni,ReactCurrentOwner:Kl};function Pc(){throw Error("act(...) is not supported in production builds of React.")}He.Children={map:Oa,forEach:function(e,t,n){Oa(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Oa(e,function(){t++}),t},toArray:function(e){return Oa(e,function(t){return t})||[]},only:function(e){if(!ql(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};He.Component=So;He.Fragment=Hm;He.Profiler=Wm;He.PureComponent=$l;He.StrictMode=$m;He.Suspense=Ym;He.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rh;He.act=Pc;He.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Nc({},e.props),o=e.key,a=e.ref,s=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,s=Kl.current),t.key!==void 0&&(o=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)Rc.call(t,c)&&!Ac.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:ja,type:e.type,key:o,ref:a,props:r,_owner:s}};He.createContext=function(e){return e={$$typeof:qm,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Km,_context:e},e.Consumer=e};He.createElement=Oc;He.createFactory=function(e){var t=Oc.bind(null,e);return t.type=e,t};He.createRef=function(){return{current:null}};He.forwardRef=function(e){return{$$typeof:Jm,render:e}};He.isValidElement=ql;He.lazy=function(e){return{$$typeof:Qm,_payload:{_status:-1,_result:e},_init:nh}};He.memo=function(e,t){return{$$typeof:Zm,type:e,compare:t===void 0?null:t}};He.startTransition=function(e){var t=ni.transition;ni.transition={};try{e()}finally{ni.transition=t}};He.unstable_act=Pc;He.useCallback=function(e,t){return $t.current.useCallback(e,t)};He.useContext=function(e){return $t.current.useContext(e)};He.useDebugValue=function(){};He.useDeferredValue=function(e){return $t.current.useDeferredValue(e)};He.useEffect=function(e,t){return $t.current.useEffect(e,t)};He.useId=function(){return $t.current.useId()};He.useImperativeHandle=function(e,t,n){return $t.current.useImperativeHandle(e,t,n)};He.useInsertionEffect=function(e,t){return $t.current.useInsertionEffect(e,t)};He.useLayoutEffect=function(e,t){return $t.current.useLayoutEffect(e,t)};He.useMemo=function(e,t){return $t.current.useMemo(e,t)};He.useReducer=function(e,t,n){return $t.current.useReducer(e,t,n)};He.useRef=function(e){return $t.current.useRef(e)};He.useState=function(e){return $t.current.useState(e)};He.useSyncExternalStore=function(e,t,n){return $t.current.useSyncExternalStore(e,t,n)};He.useTransition=function(){return $t.current.useTransition()};He.version="18.3.1";jc.exports=He;var p=jc.exports;const dr=Gm(p);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oh=p,ah=Symbol.for("react.element"),ih=Symbol.for("react.fragment"),sh=Object.prototype.hasOwnProperty,lh=oh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dh={key:!0,ref:!0,__self:!0,__source:!0};function Lc(e,t,n){var r,o={},a=null,s=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(r in t)sh.call(t,r)&&!dh.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)o[r]===void 0&&(o[r]=t[r]);return{$$typeof:ah,type:e,key:a,ref:s,props:o,_owner:lh.current}}Vi.Fragment=ih;Vi.jsx=Lc;Vi.jsxs=Lc;Sc.exports=Vi;var i=Sc.exports,Vs={},Mc={exports:{}},sn={},zc={exports:{}},Uc={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(J,z){var K=J.length;J.push(z);e:for(;0<K;){var ne=K-1>>>1,W=J[ne];if(0<o(W,z))J[ne]=z,J[K]=W,K=ne;else break e}}function n(J){return J.length===0?null:J[0]}function r(J){if(J.length===0)return null;var z=J[0],K=J.pop();if(K!==z){J[0]=K;e:for(var ne=0,W=J.length,he=W>>>1;ne<he;){var Ne=2*(ne+1)-1,v=J[Ne],L=Ne+1,$=J[L];if(0>o(v,K))L<W&&0>o($,v)?(J[ne]=$,J[L]=K,ne=L):(J[ne]=v,J[Ne]=K,ne=Ne);else if(L<W&&0>o($,K))J[ne]=$,J[L]=K,ne=L;else break e}}return z}function o(J,z){var K=J.sortIndex-z.sortIndex;return K!==0?K:J.id-z.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],d=[],h=1,k=null,g=3,b=!1,x=!1,A=!1,T=typeof setTimeout=="function"?setTimeout:null,u=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function f(J){for(var z=n(d);z!==null;){if(z.callback===null)r(d);else if(z.startTime<=J)r(d),z.sortIndex=z.expirationTime,t(c,z);else break;z=n(d)}}function D(J){if(A=!1,f(J),!x)if(n(c)!==null)x=!0,ve(N);else{var z=n(d);z!==null&&Pe(D,z.startTime-J)}}function N(J,z){x=!1,A&&(A=!1,u(M),M=-1),b=!0;var K=g;try{for(f(z),k=n(c);k!==null&&(!(k.expirationTime>z)||J&&!ce());){var ne=k.callback;if(typeof ne=="function"){k.callback=null,g=k.priorityLevel;var W=ne(k.expirationTime<=z);z=e.unstable_now(),typeof W=="function"?k.callback=W:k===n(c)&&r(c),f(z)}else r(c);k=n(c)}if(k!==null)var he=!0;else{var Ne=n(d);Ne!==null&&Pe(D,Ne.startTime-z),he=!1}return he}finally{k=null,g=K,b=!1}}var _=!1,O=null,M=-1,I=5,V=-1;function ce(){return!(e.unstable_now()-V<I)}function we(){if(O!==null){var J=e.unstable_now();V=J;var z=!0;try{z=O(!0,J)}finally{z?ae():(_=!1,O=null)}}else _=!1}var ae;if(typeof m=="function")ae=function(){m(we)};else if(typeof MessageChannel<"u"){var De=new MessageChannel,me=De.port2;De.port1.onmessage=we,ae=function(){me.postMessage(null)}}else ae=function(){T(we,0)};function ve(J){O=J,_||(_=!0,ae())}function Pe(J,z){M=T(function(){J(e.unstable_now())},z)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(J){J.callback=null},e.unstable_continueExecution=function(){x||b||(x=!0,ve(N))},e.unstable_forceFrameRate=function(J){0>J||125<J?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<J?Math.floor(1e3/J):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(J){switch(g){case 1:case 2:case 3:var z=3;break;default:z=g}var K=g;g=z;try{return J()}finally{g=K}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(J,z){switch(J){case 1:case 2:case 3:case 4:case 5:break;default:J=3}var K=g;g=J;try{return z()}finally{g=K}},e.unstable_scheduleCallback=function(J,z,K){var ne=e.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?ne+K:ne):K=ne,J){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=K+W,J={id:h++,callback:z,priorityLevel:J,startTime:K,expirationTime:W,sortIndex:-1},K>ne?(J.sortIndex=K,t(d,J),n(c)===null&&J===n(d)&&(A?(u(M),M=-1):A=!0,Pe(D,K-ne))):(J.sortIndex=W,t(c,J),x||b||(x=!0,ve(N))),J},e.unstable_shouldYield=ce,e.unstable_wrapCallback=function(J){var z=g;return function(){var K=g;g=z;try{return J.apply(this,arguments)}finally{g=K}}}})(Uc);zc.exports=Uc;var uh=zc.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ch=p,an=uh;function te(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Fc=new Set,sa={};function Fr(e,t){vo(e,t),vo(e+"Capture",t)}function vo(e,t){for(sa[e]=t,e=0;e<t.length;e++)Fc.add(t[e])}var Wn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Hs=Object.prototype.hasOwnProperty,fh=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,iu={},su={};function ph(e){return Hs.call(su,e)?!0:Hs.call(iu,e)?!1:fh.test(e)?su[e]=!0:(iu[e]=!0,!1)}function mh(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hh(e,t,n,r){if(t===null||typeof t>"u"||mh(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Wt(e,t,n,r,o,a,s){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=s}var At={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){At[e]=new Wt(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];At[t]=new Wt(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){At[e]=new Wt(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){At[e]=new Wt(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){At[e]=new Wt(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){At[e]=new Wt(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){At[e]=new Wt(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){At[e]=new Wt(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){At[e]=new Wt(e,5,!1,e.toLowerCase(),null,!1,!1)});var Jl=/[\-:]([a-z])/g;function Yl(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Jl,Yl);At[t]=new Wt(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Jl,Yl);At[t]=new Wt(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Jl,Yl);At[t]=new Wt(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){At[e]=new Wt(e,1,!1,e.toLowerCase(),null,!1,!1)});At.xlinkHref=new Wt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){At[e]=new Wt(e,1,!1,e.toLowerCase(),null,!0,!0)});function Zl(e,t,n,r){var o=At.hasOwnProperty(t)?At[t]:null;(o!==null?o.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hh(t,n,o,r)&&(n=null),r||o===null?ph(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):o.mustUseProperty?e[o.propertyName]=n===null?o.type===3?!1:"":n:(t=o.attributeName,r=o.attributeNamespace,n===null?e.removeAttribute(t):(o=o.type,n=o===3||o===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Yn=ch.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pa=Symbol.for("react.element"),Qr=Symbol.for("react.portal"),Xr=Symbol.for("react.fragment"),Ql=Symbol.for("react.strict_mode"),$s=Symbol.for("react.profiler"),Bc=Symbol.for("react.provider"),Gc=Symbol.for("react.context"),Xl=Symbol.for("react.forward_ref"),Ws=Symbol.for("react.suspense"),Ks=Symbol.for("react.suspense_list"),ed=Symbol.for("react.memo"),rr=Symbol.for("react.lazy"),Vc=Symbol.for("react.offscreen"),lu=Symbol.iterator;function Mo(e){return e===null||typeof e!="object"?null:(e=lu&&e[lu]||e["@@iterator"],typeof e=="function"?e:null)}var ut=Object.assign,cs;function Wo(e){if(cs===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);cs=t&&t[1]||""}return`
`+cs+e}var fs=!1;function ps(e,t){if(!e||fs)return"";fs=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var o=d.stack.split(`
`),a=r.stack.split(`
`),s=o.length-1,l=a.length-1;1<=s&&0<=l&&o[s]!==a[l];)l--;for(;1<=s&&0<=l;s--,l--)if(o[s]!==a[l]){if(s!==1||l!==1)do if(s--,l--,0>l||o[s]!==a[l]){var c=`
`+o[s].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=s&&0<=l);break}}}finally{fs=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Wo(e):""}function yh(e){switch(e.tag){case 5:return Wo(e.type);case 16:return Wo("Lazy");case 13:return Wo("Suspense");case 19:return Wo("SuspenseList");case 0:case 2:case 15:return e=ps(e.type,!1),e;case 11:return e=ps(e.type.render,!1),e;case 1:return e=ps(e.type,!0),e;default:return""}}function qs(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Xr:return"Fragment";case Qr:return"Portal";case $s:return"Profiler";case Ql:return"StrictMode";case Ws:return"Suspense";case Ks:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Gc:return(e.displayName||"Context")+".Consumer";case Bc:return(e._context.displayName||"Context")+".Provider";case Xl:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ed:return t=e.displayName||null,t!==null?t:qs(e.type)||"Memo";case rr:t=e._payload,e=e._init;try{return qs(e(t))}catch{}}return null}function gh(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return qs(t);case 8:return t===Ql?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Hc(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function vh(e){var t=Hc(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var o=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(s){r=""+s,a.call(this,s)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function La(e){e._valueTracker||(e._valueTracker=vh(e))}function $c(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Hc(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function mi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Js(e,t){var n=t.checked;return ut({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function du(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=xr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Wc(e,t){t=t.checked,t!=null&&Zl(e,"checked",t,!1)}function Ys(e,t){Wc(e,t);var n=xr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Zs(e,t.type,n):t.hasOwnProperty("defaultValue")&&Zs(e,t.type,xr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function uu(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Zs(e,t,n){(t!=="number"||mi(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Ko=Array.isArray;function fo(e,t,n,r){if(e=e.options,t){t={};for(var o=0;o<n.length;o++)t["$"+n[o]]=!0;for(n=0;n<e.length;n++)o=t.hasOwnProperty("$"+e[n].value),e[n].selected!==o&&(e[n].selected=o),o&&r&&(e[n].defaultSelected=!0)}else{for(n=""+xr(n),t=null,o=0;o<e.length;o++){if(e[o].value===n){e[o].selected=!0,r&&(e[o].defaultSelected=!0);return}t!==null||e[o].disabled||(t=e[o])}t!==null&&(t.selected=!0)}}function Qs(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(te(91));return ut({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function cu(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(te(92));if(Ko(n)){if(1<n.length)throw Error(te(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:xr(n)}}function Kc(e,t){var n=xr(t.value),r=xr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function fu(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function qc(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Xs(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?qc(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Ma,Jc=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,o){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,o)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Ma=Ma||document.createElement("div"),Ma.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Ma.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function la(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Zo={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xh=["Webkit","ms","Moz","O"];Object.keys(Zo).forEach(function(e){xh.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zo[t]=Zo[e]})});function Yc(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Zo.hasOwnProperty(e)&&Zo[e]?(""+t).trim():t+"px"}function Zc(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,o=Yc(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,o):e[n]=o}}var wh=ut({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function el(e,t){if(t){if(wh[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(te(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(te(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(te(61))}if(t.style!=null&&typeof t.style!="object")throw Error(te(62))}}function tl(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var nl=null;function td(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var rl=null,po=null,mo=null;function pu(e){if(e=_a(e)){if(typeof rl!="function")throw Error(te(280));var t=e.stateNode;t&&(t=qi(t),rl(e.stateNode,e.type,t))}}function Qc(e){po?mo?mo.push(e):mo=[e]:po=e}function Xc(){if(po){var e=po,t=mo;if(mo=po=null,pu(e),t)for(e=0;e<t.length;e++)pu(t[e])}}function ef(e,t){return e(t)}function tf(){}var ms=!1;function nf(e,t,n){if(ms)return e(t,n);ms=!0;try{return ef(e,t,n)}finally{ms=!1,(po!==null||mo!==null)&&(tf(),Xc())}}function da(e,t){var n=e.stateNode;if(n===null)return null;var r=qi(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(te(231,t,typeof n));return n}var ol=!1;if(Wn)try{var zo={};Object.defineProperty(zo,"passive",{get:function(){ol=!0}}),window.addEventListener("test",zo,zo),window.removeEventListener("test",zo,zo)}catch{ol=!1}function kh(e,t,n,r,o,a,s,l,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(h){this.onError(h)}}var Qo=!1,hi=null,yi=!1,al=null,bh={onError:function(e){Qo=!0,hi=e}};function Ch(e,t,n,r,o,a,s,l,c){Qo=!1,hi=null,kh.apply(bh,arguments)}function Th(e,t,n,r,o,a,s,l,c){if(Ch.apply(this,arguments),Qo){if(Qo){var d=hi;Qo=!1,hi=null}else throw Error(te(198));yi||(yi=!0,al=d)}}function Br(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function rf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function mu(e){if(Br(e)!==e)throw Error(te(188))}function Eh(e){var t=e.alternate;if(!t){if(t=Br(e),t===null)throw Error(te(188));return t!==e?null:e}for(var n=e,r=t;;){var o=n.return;if(o===null)break;var a=o.alternate;if(a===null){if(r=o.return,r!==null){n=r;continue}break}if(o.child===a.child){for(a=o.child;a;){if(a===n)return mu(o),e;if(a===r)return mu(o),t;a=a.sibling}throw Error(te(188))}if(n.return!==r.return)n=o,r=a;else{for(var s=!1,l=o.child;l;){if(l===n){s=!0,n=o,r=a;break}if(l===r){s=!0,r=o,n=a;break}l=l.sibling}if(!s){for(l=a.child;l;){if(l===n){s=!0,n=a,r=o;break}if(l===r){s=!0,r=a,n=o;break}l=l.sibling}if(!s)throw Error(te(189))}}if(n.alternate!==r)throw Error(te(190))}if(n.tag!==3)throw Error(te(188));return n.stateNode.current===n?e:t}function of(e){return e=Eh(e),e!==null?af(e):null}function af(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=af(e);if(t!==null)return t;e=e.sibling}return null}var sf=an.unstable_scheduleCallback,hu=an.unstable_cancelCallback,Sh=an.unstable_shouldYield,jh=an.unstable_requestPaint,gt=an.unstable_now,Ih=an.unstable_getCurrentPriorityLevel,nd=an.unstable_ImmediatePriority,lf=an.unstable_UserBlockingPriority,gi=an.unstable_NormalPriority,Nh=an.unstable_LowPriority,df=an.unstable_IdlePriority,Hi=null,zn=null;function _h(e){if(zn&&typeof zn.onCommitFiberRoot=="function")try{zn.onCommitFiberRoot(Hi,e,void 0,(e.current.flags&128)===128)}catch{}}var In=Math.clz32?Math.clz32:Ah,Dh=Math.log,Rh=Math.LN2;function Ah(e){return e>>>=0,e===0?32:31-(Dh(e)/Rh|0)|0}var za=64,Ua=4194304;function qo(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function vi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes,s=n&268435455;if(s!==0){var l=s&~o;l!==0?r=qo(l):(a&=s,a!==0&&(r=qo(a)))}else s=n&~o,s!==0?r=qo(s):a!==0&&(r=qo(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&o)&&(o=r&-r,a=t&-t,o>=a||o===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-In(t),o=1<<n,r|=e[n],t&=~o;return r}function Oh(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ph(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,o=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-In(a),l=1<<s,c=o[s];c===-1?(!(l&n)||l&r)&&(o[s]=Oh(l,t)):c<=t&&(e.expiredLanes|=l),a&=~l}}function il(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function uf(){var e=za;return za<<=1,!(za&4194240)&&(za=64),e}function hs(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ia(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-In(t),e[t]=n}function Lh(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var o=31-In(n),a=1<<o;t[o]=0,r[o]=-1,e[o]=-1,n&=~a}}function rd(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-In(n),o=1<<r;o&t|e[r]&t&&(e[r]|=t),n&=~o}}var Ze=0;function cf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var ff,od,pf,mf,hf,sl=!1,Fa=[],ur=null,cr=null,fr=null,ua=new Map,ca=new Map,ar=[],Mh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yu(e,t){switch(e){case"focusin":case"focusout":ur=null;break;case"dragenter":case"dragleave":cr=null;break;case"mouseover":case"mouseout":fr=null;break;case"pointerover":case"pointerout":ua.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":ca.delete(t.pointerId)}}function Uo(e,t,n,r,o,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[o]},t!==null&&(t=_a(t),t!==null&&od(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,o!==null&&t.indexOf(o)===-1&&t.push(o),e)}function zh(e,t,n,r,o){switch(t){case"focusin":return ur=Uo(ur,e,t,n,r,o),!0;case"dragenter":return cr=Uo(cr,e,t,n,r,o),!0;case"mouseover":return fr=Uo(fr,e,t,n,r,o),!0;case"pointerover":var a=o.pointerId;return ua.set(a,Uo(ua.get(a)||null,e,t,n,r,o)),!0;case"gotpointercapture":return a=o.pointerId,ca.set(a,Uo(ca.get(a)||null,e,t,n,r,o)),!0}return!1}function yf(e){var t=Nr(e.target);if(t!==null){var n=Br(t);if(n!==null){if(t=n.tag,t===13){if(t=rf(n),t!==null){e.blockedOn=t,hf(e.priority,function(){pf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ri(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ll(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);nl=r,n.target.dispatchEvent(r),nl=null}else return t=_a(n),t!==null&&od(t),e.blockedOn=n,!1;t.shift()}return!0}function gu(e,t,n){ri(e)&&n.delete(t)}function Uh(){sl=!1,ur!==null&&ri(ur)&&(ur=null),cr!==null&&ri(cr)&&(cr=null),fr!==null&&ri(fr)&&(fr=null),ua.forEach(gu),ca.forEach(gu)}function Fo(e,t){e.blockedOn===t&&(e.blockedOn=null,sl||(sl=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Uh)))}function fa(e){function t(o){return Fo(o,e)}if(0<Fa.length){Fo(Fa[0],e);for(var n=1;n<Fa.length;n++){var r=Fa[n];r.blockedOn===e&&(r.blockedOn=null)}}for(ur!==null&&Fo(ur,e),cr!==null&&Fo(cr,e),fr!==null&&Fo(fr,e),ua.forEach(t),ca.forEach(t),n=0;n<ar.length;n++)r=ar[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ar.length&&(n=ar[0],n.blockedOn===null);)yf(n),n.blockedOn===null&&ar.shift()}var ho=Yn.ReactCurrentBatchConfig,xi=!0;function Fh(e,t,n,r){var o=Ze,a=ho.transition;ho.transition=null;try{Ze=1,ad(e,t,n,r)}finally{Ze=o,ho.transition=a}}function Bh(e,t,n,r){var o=Ze,a=ho.transition;ho.transition=null;try{Ze=4,ad(e,t,n,r)}finally{Ze=o,ho.transition=a}}function ad(e,t,n,r){if(xi){var o=ll(e,t,n,r);if(o===null)Es(e,t,r,wi,n),yu(e,r);else if(zh(o,e,t,n,r))r.stopPropagation();else if(yu(e,r),t&4&&-1<Mh.indexOf(e)){for(;o!==null;){var a=_a(o);if(a!==null&&ff(a),a=ll(e,t,n,r),a===null&&Es(e,t,r,wi,n),a===o)break;o=a}o!==null&&r.stopPropagation()}else Es(e,t,r,null,n)}}var wi=null;function ll(e,t,n,r){if(wi=null,e=td(r),e=Nr(e),e!==null)if(t=Br(e),t===null)e=null;else if(n=t.tag,n===13){if(e=rf(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return wi=e,null}function gf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ih()){case nd:return 1;case lf:return 4;case gi:case Nh:return 16;case df:return 536870912;default:return 16}default:return 16}}var sr=null,id=null,oi=null;function vf(){if(oi)return oi;var e,t=id,n=t.length,r,o="value"in sr?sr.value:sr.textContent,a=o.length;for(e=0;e<n&&t[e]===o[e];e++);var s=n-e;for(r=1;r<=s&&t[n-r]===o[a-r];r++);return oi=o.slice(e,1<r?1-r:void 0)}function ai(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ba(){return!0}function vu(){return!1}function ln(e){function t(n,r,o,a,s){this._reactName=n,this._targetInst=o,this.type=r,this.nativeEvent=a,this.target=s,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(a):a[l]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?Ba:vu,this.isPropagationStopped=vu,this}return ut(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ba)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ba)},persist:function(){},isPersistent:Ba}),t}var jo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sd=ln(jo),Na=ut({},jo,{view:0,detail:0}),Gh=ln(Na),ys,gs,Bo,$i=ut({},Na,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ld,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Bo&&(Bo&&e.type==="mousemove"?(ys=e.screenX-Bo.screenX,gs=e.screenY-Bo.screenY):gs=ys=0,Bo=e),ys)},movementY:function(e){return"movementY"in e?e.movementY:gs}}),xu=ln($i),Vh=ut({},$i,{dataTransfer:0}),Hh=ln(Vh),$h=ut({},Na,{relatedTarget:0}),vs=ln($h),Wh=ut({},jo,{animationName:0,elapsedTime:0,pseudoElement:0}),Kh=ln(Wh),qh=ut({},jo,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Jh=ln(qh),Yh=ut({},jo,{data:0}),wu=ln(Yh),Zh={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Qh={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xh={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ey(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Xh[e])?!!t[e]:!1}function ld(){return ey}var ty=ut({},Na,{key:function(e){if(e.key){var t=Zh[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ai(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Qh[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ld,charCode:function(e){return e.type==="keypress"?ai(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ai(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),ny=ln(ty),ry=ut({},$i,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ku=ln(ry),oy=ut({},Na,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ld}),ay=ln(oy),iy=ut({},jo,{propertyName:0,elapsedTime:0,pseudoElement:0}),sy=ln(iy),ly=ut({},$i,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),dy=ln(ly),uy=[9,13,27,32],dd=Wn&&"CompositionEvent"in window,Xo=null;Wn&&"documentMode"in document&&(Xo=document.documentMode);var cy=Wn&&"TextEvent"in window&&!Xo,xf=Wn&&(!dd||Xo&&8<Xo&&11>=Xo),bu=" ",Cu=!1;function wf(e,t){switch(e){case"keyup":return uy.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function kf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var eo=!1;function fy(e,t){switch(e){case"compositionend":return kf(t);case"keypress":return t.which!==32?null:(Cu=!0,bu);case"textInput":return e=t.data,e===bu&&Cu?null:e;default:return null}}function py(e,t){if(eo)return e==="compositionend"||!dd&&wf(e,t)?(e=vf(),oi=id=sr=null,eo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return xf&&t.locale!=="ko"?null:t.data;default:return null}}var my={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Tu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!my[e.type]:t==="textarea"}function bf(e,t,n,r){Qc(r),t=ki(t,"onChange"),0<t.length&&(n=new sd("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var ea=null,pa=null;function hy(e){Af(e,0)}function Wi(e){var t=ro(e);if($c(t))return e}function yy(e,t){if(e==="change")return t}var Cf=!1;if(Wn){var xs;if(Wn){var ws="oninput"in document;if(!ws){var Eu=document.createElement("div");Eu.setAttribute("oninput","return;"),ws=typeof Eu.oninput=="function"}xs=ws}else xs=!1;Cf=xs&&(!document.documentMode||9<document.documentMode)}function Su(){ea&&(ea.detachEvent("onpropertychange",Tf),pa=ea=null)}function Tf(e){if(e.propertyName==="value"&&Wi(pa)){var t=[];bf(t,pa,e,td(e)),nf(hy,t)}}function gy(e,t,n){e==="focusin"?(Su(),ea=t,pa=n,ea.attachEvent("onpropertychange",Tf)):e==="focusout"&&Su()}function vy(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wi(pa)}function xy(e,t){if(e==="click")return Wi(t)}function wy(e,t){if(e==="input"||e==="change")return Wi(t)}function ky(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var _n=typeof Object.is=="function"?Object.is:ky;function ma(e,t){if(_n(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var o=n[r];if(!Hs.call(t,o)||!_n(e[o],t[o]))return!1}return!0}function ju(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Iu(e,t){var n=ju(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=ju(n)}}function Ef(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ef(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Sf(){for(var e=window,t=mi();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=mi(e.document)}return t}function ud(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function by(e){var t=Sf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ef(n.ownerDocument.documentElement,n)){if(r!==null&&ud(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var o=n.textContent.length,a=Math.min(r.start,o);r=r.end===void 0?a:Math.min(r.end,o),!e.extend&&a>r&&(o=r,r=a,a=o),o=Iu(n,a);var s=Iu(n,r);o&&s&&(e.rangeCount!==1||e.anchorNode!==o.node||e.anchorOffset!==o.offset||e.focusNode!==s.node||e.focusOffset!==s.offset)&&(t=t.createRange(),t.setStart(o.node,o.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(s.node,s.offset)):(t.setEnd(s.node,s.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Cy=Wn&&"documentMode"in document&&11>=document.documentMode,to=null,dl=null,ta=null,ul=!1;function Nu(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ul||to==null||to!==mi(r)||(r=to,"selectionStart"in r&&ud(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ta&&ma(ta,r)||(ta=r,r=ki(dl,"onSelect"),0<r.length&&(t=new sd("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=to)))}function Ga(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var no={animationend:Ga("Animation","AnimationEnd"),animationiteration:Ga("Animation","AnimationIteration"),animationstart:Ga("Animation","AnimationStart"),transitionend:Ga("Transition","TransitionEnd")},ks={},jf={};Wn&&(jf=document.createElement("div").style,"AnimationEvent"in window||(delete no.animationend.animation,delete no.animationiteration.animation,delete no.animationstart.animation),"TransitionEvent"in window||delete no.transitionend.transition);function Ki(e){if(ks[e])return ks[e];if(!no[e])return e;var t=no[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in jf)return ks[e]=t[n];return e}var If=Ki("animationend"),Nf=Ki("animationiteration"),_f=Ki("animationstart"),Df=Ki("transitionend"),Rf=new Map,_u="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kr(e,t){Rf.set(e,t),Fr(t,[e])}for(var bs=0;bs<_u.length;bs++){var Cs=_u[bs],Ty=Cs.toLowerCase(),Ey=Cs[0].toUpperCase()+Cs.slice(1);kr(Ty,"on"+Ey)}kr(If,"onAnimationEnd");kr(Nf,"onAnimationIteration");kr(_f,"onAnimationStart");kr("dblclick","onDoubleClick");kr("focusin","onFocus");kr("focusout","onBlur");kr(Df,"onTransitionEnd");vo("onMouseEnter",["mouseout","mouseover"]);vo("onMouseLeave",["mouseout","mouseover"]);vo("onPointerEnter",["pointerout","pointerover"]);vo("onPointerLeave",["pointerout","pointerover"]);Fr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Fr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Fr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Fr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Fr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Fr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Jo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sy=new Set("cancel close invalid load scroll toggle".split(" ").concat(Jo));function Du(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Th(r,t,void 0,e),e.currentTarget=null}function Af(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],o=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var s=r.length-1;0<=s;s--){var l=r[s],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==a&&o.isPropagationStopped())break e;Du(o,l,d),a=c}else for(s=0;s<r.length;s++){if(l=r[s],c=l.instance,d=l.currentTarget,l=l.listener,c!==a&&o.isPropagationStopped())break e;Du(o,l,d),a=c}}}if(yi)throw e=al,yi=!1,al=null,e}function nt(e,t){var n=t[hl];n===void 0&&(n=t[hl]=new Set);var r=e+"__bubble";n.has(r)||(Of(t,e,2,!1),n.add(r))}function Ts(e,t,n){var r=0;t&&(r|=4),Of(n,e,r,t)}var Va="_reactListening"+Math.random().toString(36).slice(2);function ha(e){if(!e[Va]){e[Va]=!0,Fc.forEach(function(n){n!=="selectionchange"&&(Sy.has(n)||Ts(n,!1,e),Ts(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Va]||(t[Va]=!0,Ts("selectionchange",!1,t))}}function Of(e,t,n,r){switch(gf(t)){case 1:var o=Fh;break;case 4:o=Bh;break;default:o=ad}n=o.bind(null,t,n,e),o=void 0,!ol||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(o=!0),r?o!==void 0?e.addEventListener(t,n,{capture:!0,passive:o}):e.addEventListener(t,n,!0):o!==void 0?e.addEventListener(t,n,{passive:o}):e.addEventListener(t,n,!1)}function Es(e,t,n,r,o){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var l=r.stateNode.containerInfo;if(l===o||l.nodeType===8&&l.parentNode===o)break;if(s===4)for(s=r.return;s!==null;){var c=s.tag;if((c===3||c===4)&&(c=s.stateNode.containerInfo,c===o||c.nodeType===8&&c.parentNode===o))return;s=s.return}for(;l!==null;){if(s=Nr(l),s===null)return;if(c=s.tag,c===5||c===6){r=a=s;continue e}l=l.parentNode}}r=r.return}nf(function(){var d=a,h=td(n),k=[];e:{var g=Rf.get(e);if(g!==void 0){var b=sd,x=e;switch(e){case"keypress":if(ai(n)===0)break e;case"keydown":case"keyup":b=ny;break;case"focusin":x="focus",b=vs;break;case"focusout":x="blur",b=vs;break;case"beforeblur":case"afterblur":b=vs;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=xu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=Hh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=ay;break;case If:case Nf:case _f:b=Kh;break;case Df:b=sy;break;case"scroll":b=Gh;break;case"wheel":b=dy;break;case"copy":case"cut":case"paste":b=Jh;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=ku}var A=(t&4)!==0,T=!A&&e==="scroll",u=A?g!==null?g+"Capture":null:g;A=[];for(var m=d,f;m!==null;){f=m;var D=f.stateNode;if(f.tag===5&&D!==null&&(f=D,u!==null&&(D=da(m,u),D!=null&&A.push(ya(m,D,f)))),T)break;m=m.return}0<A.length&&(g=new b(g,x,null,n,h),k.push({event:g,listeners:A}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",g&&n!==nl&&(x=n.relatedTarget||n.fromElement)&&(Nr(x)||x[Kn]))break e;if((b||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,b?(x=n.relatedTarget||n.toElement,b=d,x=x?Nr(x):null,x!==null&&(T=Br(x),x!==T||x.tag!==5&&x.tag!==6)&&(x=null)):(b=null,x=d),b!==x)){if(A=xu,D="onMouseLeave",u="onMouseEnter",m="mouse",(e==="pointerout"||e==="pointerover")&&(A=ku,D="onPointerLeave",u="onPointerEnter",m="pointer"),T=b==null?g:ro(b),f=x==null?g:ro(x),g=new A(D,m+"leave",b,n,h),g.target=T,g.relatedTarget=f,D=null,Nr(h)===d&&(A=new A(u,m+"enter",x,n,h),A.target=f,A.relatedTarget=T,D=A),T=D,b&&x)t:{for(A=b,u=x,m=0,f=A;f;f=Jr(f))m++;for(f=0,D=u;D;D=Jr(D))f++;for(;0<m-f;)A=Jr(A),m--;for(;0<f-m;)u=Jr(u),f--;for(;m--;){if(A===u||u!==null&&A===u.alternate)break t;A=Jr(A),u=Jr(u)}A=null}else A=null;b!==null&&Ru(k,g,b,A,!1),x!==null&&T!==null&&Ru(k,T,x,A,!0)}}e:{if(g=d?ro(d):window,b=g.nodeName&&g.nodeName.toLowerCase(),b==="select"||b==="input"&&g.type==="file")var N=yy;else if(Tu(g))if(Cf)N=wy;else{N=vy;var _=gy}else(b=g.nodeName)&&b.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(N=xy);if(N&&(N=N(e,d))){bf(k,N,n,h);break e}_&&_(e,g,d),e==="focusout"&&(_=g._wrapperState)&&_.controlled&&g.type==="number"&&Zs(g,"number",g.value)}switch(_=d?ro(d):window,e){case"focusin":(Tu(_)||_.contentEditable==="true")&&(to=_,dl=d,ta=null);break;case"focusout":ta=dl=to=null;break;case"mousedown":ul=!0;break;case"contextmenu":case"mouseup":case"dragend":ul=!1,Nu(k,n,h);break;case"selectionchange":if(Cy)break;case"keydown":case"keyup":Nu(k,n,h)}var O;if(dd)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else eo?wf(e,n)&&(M="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(xf&&n.locale!=="ko"&&(eo||M!=="onCompositionStart"?M==="onCompositionEnd"&&eo&&(O=vf()):(sr=h,id="value"in sr?sr.value:sr.textContent,eo=!0)),_=ki(d,M),0<_.length&&(M=new wu(M,e,null,n,h),k.push({event:M,listeners:_}),O?M.data=O:(O=kf(n),O!==null&&(M.data=O)))),(O=cy?fy(e,n):py(e,n))&&(d=ki(d,"onBeforeInput"),0<d.length&&(h=new wu("onBeforeInput","beforeinput",null,n,h),k.push({event:h,listeners:d}),h.data=O))}Af(k,t)})}function ya(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ki(e,t){for(var n=t+"Capture",r=[];e!==null;){var o=e,a=o.stateNode;o.tag===5&&a!==null&&(o=a,a=da(e,n),a!=null&&r.unshift(ya(e,a,o)),a=da(e,t),a!=null&&r.push(ya(e,a,o))),e=e.return}return r}function Jr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Ru(e,t,n,r,o){for(var a=t._reactName,s=[];n!==null&&n!==r;){var l=n,c=l.alternate,d=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&d!==null&&(l=d,o?(c=da(n,a),c!=null&&s.unshift(ya(n,c,l))):o||(c=da(n,a),c!=null&&s.push(ya(n,c,l)))),n=n.return}s.length!==0&&e.push({event:t,listeners:s})}var jy=/\r\n?/g,Iy=/\u0000|\uFFFD/g;function Au(e){return(typeof e=="string"?e:""+e).replace(jy,`
`).replace(Iy,"")}function Ha(e,t,n){if(t=Au(t),Au(e)!==t&&n)throw Error(te(425))}function bi(){}var cl=null,fl=null;function pl(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ml=typeof setTimeout=="function"?setTimeout:void 0,Ny=typeof clearTimeout=="function"?clearTimeout:void 0,Ou=typeof Promise=="function"?Promise:void 0,_y=typeof queueMicrotask=="function"?queueMicrotask:typeof Ou<"u"?function(e){return Ou.resolve(null).then(e).catch(Dy)}:ml;function Dy(e){setTimeout(function(){throw e})}function Ss(e,t){var n=t,r=0;do{var o=n.nextSibling;if(e.removeChild(n),o&&o.nodeType===8)if(n=o.data,n==="/$"){if(r===0){e.removeChild(o),fa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=o}while(n);fa(t)}function pr(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Pu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Io=Math.random().toString(36).slice(2),Ln="__reactFiber$"+Io,ga="__reactProps$"+Io,Kn="__reactContainer$"+Io,hl="__reactEvents$"+Io,Ry="__reactListeners$"+Io,Ay="__reactHandles$"+Io;function Nr(e){var t=e[Ln];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Kn]||n[Ln]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Pu(e);e!==null;){if(n=e[Ln])return n;e=Pu(e)}return t}e=n,n=e.parentNode}return null}function _a(e){return e=e[Ln]||e[Kn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function ro(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(te(33))}function qi(e){return e[ga]||null}var yl=[],oo=-1;function br(e){return{current:e}}function rt(e){0>oo||(e.current=yl[oo],yl[oo]=null,oo--)}function Xe(e,t){oo++,yl[oo]=e.current,e.current=t}var wr={},zt=br(wr),Qt=br(!1),Or=wr;function xo(e,t){var n=e.type.contextTypes;if(!n)return wr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var o={},a;for(a in n)o[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Xt(e){return e=e.childContextTypes,e!=null}function Ci(){rt(Qt),rt(zt)}function Lu(e,t,n){if(zt.current!==wr)throw Error(te(168));Xe(zt,t),Xe(Qt,n)}function Pf(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var o in r)if(!(o in t))throw Error(te(108,gh(e)||"Unknown",o));return ut({},n,r)}function Ti(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||wr,Or=zt.current,Xe(zt,e),Xe(Qt,Qt.current),!0}function Mu(e,t,n){var r=e.stateNode;if(!r)throw Error(te(169));n?(e=Pf(e,t,Or),r.__reactInternalMemoizedMergedChildContext=e,rt(Qt),rt(zt),Xe(zt,e)):rt(Qt),Xe(Qt,n)}var Gn=null,Ji=!1,js=!1;function Lf(e){Gn===null?Gn=[e]:Gn.push(e)}function Oy(e){Ji=!0,Lf(e)}function Cr(){if(!js&&Gn!==null){js=!0;var e=0,t=Ze;try{var n=Gn;for(Ze=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}Gn=null,Ji=!1}catch(o){throw Gn!==null&&(Gn=Gn.slice(e+1)),sf(nd,Cr),o}finally{Ze=t,js=!1}}return null}var ao=[],io=0,Ei=null,Si=0,hn=[],yn=0,Pr=null,Vn=1,Hn="";function jr(e,t){ao[io++]=Si,ao[io++]=Ei,Ei=e,Si=t}function Mf(e,t,n){hn[yn++]=Vn,hn[yn++]=Hn,hn[yn++]=Pr,Pr=e;var r=Vn;e=Hn;var o=32-In(r)-1;r&=~(1<<o),n+=1;var a=32-In(t)+o;if(30<a){var s=o-o%5;a=(r&(1<<s)-1).toString(32),r>>=s,o-=s,Vn=1<<32-In(t)+o|n<<o|r,Hn=a+e}else Vn=1<<a|n<<o|r,Hn=e}function cd(e){e.return!==null&&(jr(e,1),Mf(e,1,0))}function fd(e){for(;e===Ei;)Ei=ao[--io],ao[io]=null,Si=ao[--io],ao[io]=null;for(;e===Pr;)Pr=hn[--yn],hn[yn]=null,Hn=hn[--yn],hn[yn]=null,Vn=hn[--yn],hn[yn]=null}var on=null,rn=null,at=!1,jn=null;function zf(e,t){var n=gn(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function zu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,on=e,rn=pr(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,on=e,rn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Pr!==null?{id:Vn,overflow:Hn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=gn(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,on=e,rn=null,!0):!1;default:return!1}}function gl(e){return(e.mode&1)!==0&&(e.flags&128)===0}function vl(e){if(at){var t=rn;if(t){var n=t;if(!zu(e,t)){if(gl(e))throw Error(te(418));t=pr(n.nextSibling);var r=on;t&&zu(e,t)?zf(r,n):(e.flags=e.flags&-4097|2,at=!1,on=e)}}else{if(gl(e))throw Error(te(418));e.flags=e.flags&-4097|2,at=!1,on=e}}}function Uu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;on=e}function $a(e){if(e!==on)return!1;if(!at)return Uu(e),at=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!pl(e.type,e.memoizedProps)),t&&(t=rn)){if(gl(e))throw Uf(),Error(te(418));for(;t;)zf(e,t),t=pr(t.nextSibling)}if(Uu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(te(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){rn=pr(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}rn=null}}else rn=on?pr(e.stateNode.nextSibling):null;return!0}function Uf(){for(var e=rn;e;)e=pr(e.nextSibling)}function wo(){rn=on=null,at=!1}function pd(e){jn===null?jn=[e]:jn.push(e)}var Py=Yn.ReactCurrentBatchConfig;function Go(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(te(309));var r=n.stateNode}if(!r)throw Error(te(147,e));var o=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(s){var l=o.refs;s===null?delete l[a]:l[a]=s},t._stringRef=a,t)}if(typeof e!="string")throw Error(te(284));if(!n._owner)throw Error(te(290,e))}return e}function Wa(e,t){throw e=Object.prototype.toString.call(t),Error(te(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Fu(e){var t=e._init;return t(e._payload)}function Ff(e){function t(u,m){if(e){var f=u.deletions;f===null?(u.deletions=[m],u.flags|=16):f.push(m)}}function n(u,m){if(!e)return null;for(;m!==null;)t(u,m),m=m.sibling;return null}function r(u,m){for(u=new Map;m!==null;)m.key!==null?u.set(m.key,m):u.set(m.index,m),m=m.sibling;return u}function o(u,m){return u=gr(u,m),u.index=0,u.sibling=null,u}function a(u,m,f){return u.index=f,e?(f=u.alternate,f!==null?(f=f.index,f<m?(u.flags|=2,m):f):(u.flags|=2,m)):(u.flags|=1048576,m)}function s(u){return e&&u.alternate===null&&(u.flags|=2),u}function l(u,m,f,D){return m===null||m.tag!==6?(m=Os(f,u.mode,D),m.return=u,m):(m=o(m,f),m.return=u,m)}function c(u,m,f,D){var N=f.type;return N===Xr?h(u,m,f.props.children,D,f.key):m!==null&&(m.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===rr&&Fu(N)===m.type)?(D=o(m,f.props),D.ref=Go(u,m,f),D.return=u,D):(D=fi(f.type,f.key,f.props,null,u.mode,D),D.ref=Go(u,m,f),D.return=u,D)}function d(u,m,f,D){return m===null||m.tag!==4||m.stateNode.containerInfo!==f.containerInfo||m.stateNode.implementation!==f.implementation?(m=Ps(f,u.mode,D),m.return=u,m):(m=o(m,f.children||[]),m.return=u,m)}function h(u,m,f,D,N){return m===null||m.tag!==7?(m=Ar(f,u.mode,D,N),m.return=u,m):(m=o(m,f),m.return=u,m)}function k(u,m,f){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Os(""+m,u.mode,f),m.return=u,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Pa:return f=fi(m.type,m.key,m.props,null,u.mode,f),f.ref=Go(u,null,m),f.return=u,f;case Qr:return m=Ps(m,u.mode,f),m.return=u,m;case rr:var D=m._init;return k(u,D(m._payload),f)}if(Ko(m)||Mo(m))return m=Ar(m,u.mode,f,null),m.return=u,m;Wa(u,m)}return null}function g(u,m,f,D){var N=m!==null?m.key:null;if(typeof f=="string"&&f!==""||typeof f=="number")return N!==null?null:l(u,m,""+f,D);if(typeof f=="object"&&f!==null){switch(f.$$typeof){case Pa:return f.key===N?c(u,m,f,D):null;case Qr:return f.key===N?d(u,m,f,D):null;case rr:return N=f._init,g(u,m,N(f._payload),D)}if(Ko(f)||Mo(f))return N!==null?null:h(u,m,f,D,null);Wa(u,f)}return null}function b(u,m,f,D,N){if(typeof D=="string"&&D!==""||typeof D=="number")return u=u.get(f)||null,l(m,u,""+D,N);if(typeof D=="object"&&D!==null){switch(D.$$typeof){case Pa:return u=u.get(D.key===null?f:D.key)||null,c(m,u,D,N);case Qr:return u=u.get(D.key===null?f:D.key)||null,d(m,u,D,N);case rr:var _=D._init;return b(u,m,f,_(D._payload),N)}if(Ko(D)||Mo(D))return u=u.get(f)||null,h(m,u,D,N,null);Wa(m,D)}return null}function x(u,m,f,D){for(var N=null,_=null,O=m,M=m=0,I=null;O!==null&&M<f.length;M++){O.index>M?(I=O,O=null):I=O.sibling;var V=g(u,O,f[M],D);if(V===null){O===null&&(O=I);break}e&&O&&V.alternate===null&&t(u,O),m=a(V,m,M),_===null?N=V:_.sibling=V,_=V,O=I}if(M===f.length)return n(u,O),at&&jr(u,M),N;if(O===null){for(;M<f.length;M++)O=k(u,f[M],D),O!==null&&(m=a(O,m,M),_===null?N=O:_.sibling=O,_=O);return at&&jr(u,M),N}for(O=r(u,O);M<f.length;M++)I=b(O,u,M,f[M],D),I!==null&&(e&&I.alternate!==null&&O.delete(I.key===null?M:I.key),m=a(I,m,M),_===null?N=I:_.sibling=I,_=I);return e&&O.forEach(function(ce){return t(u,ce)}),at&&jr(u,M),N}function A(u,m,f,D){var N=Mo(f);if(typeof N!="function")throw Error(te(150));if(f=N.call(f),f==null)throw Error(te(151));for(var _=N=null,O=m,M=m=0,I=null,V=f.next();O!==null&&!V.done;M++,V=f.next()){O.index>M?(I=O,O=null):I=O.sibling;var ce=g(u,O,V.value,D);if(ce===null){O===null&&(O=I);break}e&&O&&ce.alternate===null&&t(u,O),m=a(ce,m,M),_===null?N=ce:_.sibling=ce,_=ce,O=I}if(V.done)return n(u,O),at&&jr(u,M),N;if(O===null){for(;!V.done;M++,V=f.next())V=k(u,V.value,D),V!==null&&(m=a(V,m,M),_===null?N=V:_.sibling=V,_=V);return at&&jr(u,M),N}for(O=r(u,O);!V.done;M++,V=f.next())V=b(O,u,M,V.value,D),V!==null&&(e&&V.alternate!==null&&O.delete(V.key===null?M:V.key),m=a(V,m,M),_===null?N=V:_.sibling=V,_=V);return e&&O.forEach(function(we){return t(u,we)}),at&&jr(u,M),N}function T(u,m,f,D){if(typeof f=="object"&&f!==null&&f.type===Xr&&f.key===null&&(f=f.props.children),typeof f=="object"&&f!==null){switch(f.$$typeof){case Pa:e:{for(var N=f.key,_=m;_!==null;){if(_.key===N){if(N=f.type,N===Xr){if(_.tag===7){n(u,_.sibling),m=o(_,f.props.children),m.return=u,u=m;break e}}else if(_.elementType===N||typeof N=="object"&&N!==null&&N.$$typeof===rr&&Fu(N)===_.type){n(u,_.sibling),m=o(_,f.props),m.ref=Go(u,_,f),m.return=u,u=m;break e}n(u,_);break}else t(u,_);_=_.sibling}f.type===Xr?(m=Ar(f.props.children,u.mode,D,f.key),m.return=u,u=m):(D=fi(f.type,f.key,f.props,null,u.mode,D),D.ref=Go(u,m,f),D.return=u,u=D)}return s(u);case Qr:e:{for(_=f.key;m!==null;){if(m.key===_)if(m.tag===4&&m.stateNode.containerInfo===f.containerInfo&&m.stateNode.implementation===f.implementation){n(u,m.sibling),m=o(m,f.children||[]),m.return=u,u=m;break e}else{n(u,m);break}else t(u,m);m=m.sibling}m=Ps(f,u.mode,D),m.return=u,u=m}return s(u);case rr:return _=f._init,T(u,m,_(f._payload),D)}if(Ko(f))return x(u,m,f,D);if(Mo(f))return A(u,m,f,D);Wa(u,f)}return typeof f=="string"&&f!==""||typeof f=="number"?(f=""+f,m!==null&&m.tag===6?(n(u,m.sibling),m=o(m,f),m.return=u,u=m):(n(u,m),m=Os(f,u.mode,D),m.return=u,u=m),s(u)):n(u,m)}return T}var ko=Ff(!0),Bf=Ff(!1),ji=br(null),Ii=null,so=null,md=null;function hd(){md=so=Ii=null}function yd(e){var t=ji.current;rt(ji),e._currentValue=t}function xl(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function yo(e,t){Ii=e,md=so=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Yt=!0),e.firstContext=null)}function xn(e){var t=e._currentValue;if(md!==e)if(e={context:e,memoizedValue:t,next:null},so===null){if(Ii===null)throw Error(te(308));so=e,Ii.dependencies={lanes:0,firstContext:e}}else so=so.next=e;return t}var _r=null;function gd(e){_r===null?_r=[e]:_r.push(e)}function Gf(e,t,n,r){var o=t.interleaved;return o===null?(n.next=n,gd(t)):(n.next=o.next,o.next=n),t.interleaved=n,qn(e,r)}function qn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var or=!1;function vd(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function $n(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function mr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ke&2){var o=r.pending;return o===null?t.next=t:(t.next=o.next,o.next=t),r.pending=t,qn(e,n)}return o=r.interleaved,o===null?(t.next=t,gd(r)):(t.next=o.next,o.next=t),r.interleaved=t,qn(e,n)}function ii(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rd(e,n)}}function Bu(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var o=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var s={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?o=a=s:a=a.next=s,n=n.next}while(n!==null);a===null?o=a=t:a=a.next=t}else o=a=t;n={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ni(e,t,n,r){var o=e.updateQueue;or=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,l=o.shared.pending;if(l!==null){o.shared.pending=null;var c=l,d=c.next;c.next=null,s===null?a=d:s.next=d,s=c;var h=e.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==s&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=c))}if(a!==null){var k=o.baseState;s=0,h=d=c=null,l=a;do{var g=l.lane,b=l.eventTime;if((r&g)===g){h!==null&&(h=h.next={eventTime:b,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var x=e,A=l;switch(g=t,b=n,A.tag){case 1:if(x=A.payload,typeof x=="function"){k=x.call(b,k,g);break e}k=x;break e;case 3:x.flags=x.flags&-65537|128;case 0:if(x=A.payload,g=typeof x=="function"?x.call(b,k,g):x,g==null)break e;k=ut({},k,g);break e;case 2:or=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,g=o.effects,g===null?o.effects=[l]:g.push(l))}else b={eventTime:b,lane:g,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=b,c=k):h=h.next=b,s|=g;if(l=l.next,l===null){if(l=o.shared.pending,l===null)break;g=l,l=g.next,g.next=null,o.lastBaseUpdate=g,o.shared.pending=null}}while(!0);if(h===null&&(c=k),o.baseState=c,o.firstBaseUpdate=d,o.lastBaseUpdate=h,t=o.shared.interleaved,t!==null){o=t;do s|=o.lane,o=o.next;while(o!==t)}else a===null&&(o.shared.lanes=0);Mr|=s,e.lanes=s,e.memoizedState=k}}function Gu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],o=r.callback;if(o!==null){if(r.callback=null,r=n,typeof o!="function")throw Error(te(191,o));o.call(r)}}}var Da={},Un=br(Da),va=br(Da),xa=br(Da);function Dr(e){if(e===Da)throw Error(te(174));return e}function xd(e,t){switch(Xe(xa,t),Xe(va,e),Xe(Un,Da),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Xs(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Xs(t,e)}rt(Un),Xe(Un,t)}function bo(){rt(Un),rt(va),rt(xa)}function Hf(e){Dr(xa.current);var t=Dr(Un.current),n=Xs(t,e.type);t!==n&&(Xe(va,e),Xe(Un,n))}function wd(e){va.current===e&&(rt(Un),rt(va))}var lt=br(0);function _i(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Is=[];function kd(){for(var e=0;e<Is.length;e++)Is[e]._workInProgressVersionPrimary=null;Is.length=0}var si=Yn.ReactCurrentDispatcher,Ns=Yn.ReactCurrentBatchConfig,Lr=0,dt=null,Tt=null,jt=null,Di=!1,na=!1,wa=0,Ly=0;function Pt(){throw Error(te(321))}function bd(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!_n(e[n],t[n]))return!1;return!0}function Cd(e,t,n,r,o,a){if(Lr=a,dt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,si.current=e===null||e.memoizedState===null?Fy:By,e=n(r,o),na){a=0;do{if(na=!1,wa=0,25<=a)throw Error(te(301));a+=1,jt=Tt=null,t.updateQueue=null,si.current=Gy,e=n(r,o)}while(na)}if(si.current=Ri,t=Tt!==null&&Tt.next!==null,Lr=0,jt=Tt=dt=null,Di=!1,t)throw Error(te(300));return e}function Td(){var e=wa!==0;return wa=0,e}function Pn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?dt.memoizedState=jt=e:jt=jt.next=e,jt}function wn(){if(Tt===null){var e=dt.alternate;e=e!==null?e.memoizedState:null}else e=Tt.next;var t=jt===null?dt.memoizedState:jt.next;if(t!==null)jt=t,Tt=e;else{if(e===null)throw Error(te(310));Tt=e,e={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},jt===null?dt.memoizedState=jt=e:jt=jt.next=e}return jt}function ka(e,t){return typeof t=="function"?t(e):t}function _s(e){var t=wn(),n=t.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=e;var r=Tt,o=r.baseQueue,a=n.pending;if(a!==null){if(o!==null){var s=o.next;o.next=a.next,a.next=s}r.baseQueue=o=a,n.pending=null}if(o!==null){a=o.next,r=r.baseState;var l=s=null,c=null,d=a;do{var h=d.lane;if((Lr&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var k={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=k,s=r):c=c.next=k,dt.lanes|=h,Mr|=h}d=d.next}while(d!==null&&d!==a);c===null?s=r:c.next=l,_n(r,t.memoizedState)||(Yt=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){o=e;do a=o.lane,dt.lanes|=a,Mr|=a,o=o.next;while(o!==e)}else o===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ds(e){var t=wn(),n=t.queue;if(n===null)throw Error(te(311));n.lastRenderedReducer=e;var r=n.dispatch,o=n.pending,a=t.memoizedState;if(o!==null){n.pending=null;var s=o=o.next;do a=e(a,s.action),s=s.next;while(s!==o);_n(a,t.memoizedState)||(Yt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function $f(){}function Wf(e,t){var n=dt,r=wn(),o=t(),a=!_n(r.memoizedState,o);if(a&&(r.memoizedState=o,Yt=!0),r=r.queue,Ed(Jf.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||jt!==null&&jt.memoizedState.tag&1){if(n.flags|=2048,ba(9,qf.bind(null,n,r,o,t),void 0,null),It===null)throw Error(te(349));Lr&30||Kf(n,t,o)}return o}function Kf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function qf(e,t,n,r){t.value=n,t.getSnapshot=r,Yf(t)&&Zf(e)}function Jf(e,t,n){return n(function(){Yf(t)&&Zf(e)})}function Yf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!_n(e,n)}catch{return!0}}function Zf(e){var t=qn(e,1);t!==null&&Nn(t,e,1,-1)}function Vu(e){var t=Pn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ka,lastRenderedState:e},t.queue=e,e=e.dispatch=Uy.bind(null,dt,e),[t.memoizedState,e]}function ba(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=dt.updateQueue,t===null?(t={lastEffect:null,stores:null},dt.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Qf(){return wn().memoizedState}function li(e,t,n,r){var o=Pn();dt.flags|=e,o.memoizedState=ba(1|t,n,void 0,r===void 0?null:r)}function Yi(e,t,n,r){var o=wn();r=r===void 0?null:r;var a=void 0;if(Tt!==null){var s=Tt.memoizedState;if(a=s.destroy,r!==null&&bd(r,s.deps)){o.memoizedState=ba(t,n,a,r);return}}dt.flags|=e,o.memoizedState=ba(1|t,n,a,r)}function Hu(e,t){return li(8390656,8,e,t)}function Ed(e,t){return Yi(2048,8,e,t)}function Xf(e,t){return Yi(4,2,e,t)}function ep(e,t){return Yi(4,4,e,t)}function tp(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function np(e,t,n){return n=n!=null?n.concat([e]):null,Yi(4,4,tp.bind(null,t,e),n)}function Sd(){}function rp(e,t){var n=wn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&bd(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function op(e,t){var n=wn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&bd(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ap(e,t,n){return Lr&21?(_n(n,t)||(n=uf(),dt.lanes|=n,Mr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Yt=!0),e.memoizedState=n)}function My(e,t){var n=Ze;Ze=n!==0&&4>n?n:4,e(!0);var r=Ns.transition;Ns.transition={};try{e(!1),t()}finally{Ze=n,Ns.transition=r}}function ip(){return wn().memoizedState}function zy(e,t,n){var r=yr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},sp(e))lp(t,n);else if(n=Gf(e,t,n,r),n!==null){var o=Ht();Nn(n,e,r,o),dp(n,t,r)}}function Uy(e,t,n){var r=yr(e),o={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(sp(e))lp(t,o);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var s=t.lastRenderedState,l=a(s,n);if(o.hasEagerState=!0,o.eagerState=l,_n(l,s)){var c=t.interleaved;c===null?(o.next=o,gd(t)):(o.next=c.next,c.next=o),t.interleaved=o;return}}catch{}finally{}n=Gf(e,t,o,r),n!==null&&(o=Ht(),Nn(n,e,r,o),dp(n,t,r))}}function sp(e){var t=e.alternate;return e===dt||t!==null&&t===dt}function lp(e,t){na=Di=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function dp(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,rd(e,n)}}var Ri={readContext:xn,useCallback:Pt,useContext:Pt,useEffect:Pt,useImperativeHandle:Pt,useInsertionEffect:Pt,useLayoutEffect:Pt,useMemo:Pt,useReducer:Pt,useRef:Pt,useState:Pt,useDebugValue:Pt,useDeferredValue:Pt,useTransition:Pt,useMutableSource:Pt,useSyncExternalStore:Pt,useId:Pt,unstable_isNewReconciler:!1},Fy={readContext:xn,useCallback:function(e,t){return Pn().memoizedState=[e,t===void 0?null:t],e},useContext:xn,useEffect:Hu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,li(4194308,4,tp.bind(null,t,e),n)},useLayoutEffect:function(e,t){return li(4194308,4,e,t)},useInsertionEffect:function(e,t){return li(4,2,e,t)},useMemo:function(e,t){var n=Pn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Pn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=zy.bind(null,dt,e),[r.memoizedState,e]},useRef:function(e){var t=Pn();return e={current:e},t.memoizedState=e},useState:Vu,useDebugValue:Sd,useDeferredValue:function(e){return Pn().memoizedState=e},useTransition:function(){var e=Vu(!1),t=e[0];return e=My.bind(null,e[1]),Pn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=dt,o=Pn();if(at){if(n===void 0)throw Error(te(407));n=n()}else{if(n=t(),It===null)throw Error(te(349));Lr&30||Kf(r,t,n)}o.memoizedState=n;var a={value:n,getSnapshot:t};return o.queue=a,Hu(Jf.bind(null,r,a,e),[e]),r.flags|=2048,ba(9,qf.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Pn(),t=It.identifierPrefix;if(at){var n=Hn,r=Vn;n=(r&~(1<<32-In(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=wa++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Ly++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},By={readContext:xn,useCallback:rp,useContext:xn,useEffect:Ed,useImperativeHandle:np,useInsertionEffect:Xf,useLayoutEffect:ep,useMemo:op,useReducer:_s,useRef:Qf,useState:function(){return _s(ka)},useDebugValue:Sd,useDeferredValue:function(e){var t=wn();return ap(t,Tt.memoizedState,e)},useTransition:function(){var e=_s(ka)[0],t=wn().memoizedState;return[e,t]},useMutableSource:$f,useSyncExternalStore:Wf,useId:ip,unstable_isNewReconciler:!1},Gy={readContext:xn,useCallback:rp,useContext:xn,useEffect:Ed,useImperativeHandle:np,useInsertionEffect:Xf,useLayoutEffect:ep,useMemo:op,useReducer:Ds,useRef:Qf,useState:function(){return Ds(ka)},useDebugValue:Sd,useDeferredValue:function(e){var t=wn();return Tt===null?t.memoizedState=e:ap(t,Tt.memoizedState,e)},useTransition:function(){var e=Ds(ka)[0],t=wn().memoizedState;return[e,t]},useMutableSource:$f,useSyncExternalStore:Wf,useId:ip,unstable_isNewReconciler:!1};function En(e,t){if(e&&e.defaultProps){t=ut({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function wl(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ut({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Zi={isMounted:function(e){return(e=e._reactInternals)?Br(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ht(),o=yr(e),a=$n(r,o);a.payload=t,n!=null&&(a.callback=n),t=mr(e,a,o),t!==null&&(Nn(t,e,o,r),ii(t,e,o))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ht(),o=yr(e),a=$n(r,o);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=mr(e,a,o),t!==null&&(Nn(t,e,o,r),ii(t,e,o))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ht(),r=yr(e),o=$n(n,r);o.tag=2,t!=null&&(o.callback=t),t=mr(e,o,r),t!==null&&(Nn(t,e,r,n),ii(t,e,r))}};function $u(e,t,n,r,o,a,s){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,s):t.prototype&&t.prototype.isPureReactComponent?!ma(n,r)||!ma(o,a):!0}function up(e,t,n){var r=!1,o=wr,a=t.contextType;return typeof a=="object"&&a!==null?a=xn(a):(o=Xt(t)?Or:zt.current,r=t.contextTypes,a=(r=r!=null)?xo(e,o):wr),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Zi,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=a),t}function Wu(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Zi.enqueueReplaceState(t,t.state,null)}function kl(e,t,n,r){var o=e.stateNode;o.props=n,o.state=e.memoizedState,o.refs={},vd(e);var a=t.contextType;typeof a=="object"&&a!==null?o.context=xn(a):(a=Xt(t)?Or:zt.current,o.context=xo(e,a)),o.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(wl(e,t,a,n),o.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(t=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),t!==o.state&&Zi.enqueueReplaceState(o,o.state,null),Ni(e,n,o,r),o.state=e.memoizedState),typeof o.componentDidMount=="function"&&(e.flags|=4194308)}function Co(e,t){try{var n="",r=t;do n+=yh(r),r=r.return;while(r);var o=n}catch(a){o=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:o,digest:null}}function Rs(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function bl(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Vy=typeof WeakMap=="function"?WeakMap:Map;function cp(e,t,n){n=$n(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Oi||(Oi=!0,Rl=r),bl(e,t)},n}function fp(e,t,n){n=$n(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var o=t.value;n.payload=function(){return r(o)},n.callback=function(){bl(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){bl(e,t),typeof r!="function"&&(hr===null?hr=new Set([this]):hr.add(this));var s=t.stack;this.componentDidCatch(t.value,{componentStack:s!==null?s:""})}),n}function Ku(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Vy;var o=new Set;r.set(t,o)}else o=r.get(t),o===void 0&&(o=new Set,r.set(t,o));o.has(n)||(o.add(n),e=rg.bind(null,e,t,n),t.then(e,e))}function qu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Ju(e,t,n,r,o){return e.mode&1?(e.flags|=65536,e.lanes=o,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=$n(-1,1),t.tag=2,mr(n,t,1))),n.lanes|=1),e)}var Hy=Yn.ReactCurrentOwner,Yt=!1;function Gt(e,t,n,r){t.child=e===null?Bf(t,null,n,r):ko(t,e.child,n,r)}function Yu(e,t,n,r,o){n=n.render;var a=t.ref;return yo(t,o),r=Cd(e,t,n,r,a,o),n=Td(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Jn(e,t,o)):(at&&n&&cd(t),t.flags|=1,Gt(e,t,r,o),t.child)}function Zu(e,t,n,r,o){if(e===null){var a=n.type;return typeof a=="function"&&!Od(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,pp(e,t,a,r,o)):(e=fi(n.type,null,r,t,t.mode,o),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&o)){var s=a.memoizedProps;if(n=n.compare,n=n!==null?n:ma,n(s,r)&&e.ref===t.ref)return Jn(e,t,o)}return t.flags|=1,e=gr(a,r),e.ref=t.ref,e.return=t,t.child=e}function pp(e,t,n,r,o){if(e!==null){var a=e.memoizedProps;if(ma(a,r)&&e.ref===t.ref)if(Yt=!1,t.pendingProps=r=a,(e.lanes&o)!==0)e.flags&131072&&(Yt=!0);else return t.lanes=e.lanes,Jn(e,t,o)}return Cl(e,t,n,r,o)}function mp(e,t,n){var r=t.pendingProps,o=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Xe(uo,nn),nn|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Xe(uo,nn),nn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,Xe(uo,nn),nn|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,Xe(uo,nn),nn|=r;return Gt(e,t,o,n),t.child}function hp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Cl(e,t,n,r,o){var a=Xt(n)?Or:zt.current;return a=xo(t,a),yo(t,o),n=Cd(e,t,n,r,a,o),r=Td(),e!==null&&!Yt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~o,Jn(e,t,o)):(at&&r&&cd(t),t.flags|=1,Gt(e,t,n,o),t.child)}function Qu(e,t,n,r,o){if(Xt(n)){var a=!0;Ti(t)}else a=!1;if(yo(t,o),t.stateNode===null)di(e,t),up(t,n,r),kl(t,n,r,o),r=!0;else if(e===null){var s=t.stateNode,l=t.memoizedProps;s.props=l;var c=s.context,d=n.contextType;typeof d=="object"&&d!==null?d=xn(d):(d=Xt(n)?Or:zt.current,d=xo(t,d));var h=n.getDerivedStateFromProps,k=typeof h=="function"||typeof s.getSnapshotBeforeUpdate=="function";k||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==r||c!==d)&&Wu(t,s,r,d),or=!1;var g=t.memoizedState;s.state=g,Ni(t,r,s,o),c=t.memoizedState,l!==r||g!==c||Qt.current||or?(typeof h=="function"&&(wl(t,n,h,r),c=t.memoizedState),(l=or||$u(t,n,l,r,g,c,d))?(k||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(t.flags|=4194308)):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),s.props=r,s.state=c,s.context=d,r=l):(typeof s.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,Vf(e,t),l=t.memoizedProps,d=t.type===t.elementType?l:En(t.type,l),s.props=d,k=t.pendingProps,g=s.context,c=n.contextType,typeof c=="object"&&c!==null?c=xn(c):(c=Xt(n)?Or:zt.current,c=xo(t,c));var b=n.getDerivedStateFromProps;(h=typeof b=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(l!==k||g!==c)&&Wu(t,s,r,c),or=!1,g=t.memoizedState,s.state=g,Ni(t,r,s,o);var x=t.memoizedState;l!==k||g!==x||Qt.current||or?(typeof b=="function"&&(wl(t,n,b,r),x=t.memoizedState),(d=or||$u(t,n,d,r,g,x,c)||!1)?(h||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,x,c),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,x,c)),typeof s.componentDidUpdate=="function"&&(t.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=x),s.props=r,s.state=x,s.context=c,r=d):(typeof s.componentDidUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return Tl(e,t,n,r,a,o)}function Tl(e,t,n,r,o,a){hp(e,t);var s=(t.flags&128)!==0;if(!r&&!s)return o&&Mu(t,n,!1),Jn(e,t,a);r=t.stateNode,Hy.current=t;var l=s&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&s?(t.child=ko(t,e.child,null,a),t.child=ko(t,null,l,a)):Gt(e,t,l,a),t.memoizedState=r.state,o&&Mu(t,n,!0),t.child}function yp(e){var t=e.stateNode;t.pendingContext?Lu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Lu(e,t.context,!1),xd(e,t.containerInfo)}function Xu(e,t,n,r,o){return wo(),pd(o),t.flags|=256,Gt(e,t,n,r),t.child}var El={dehydrated:null,treeContext:null,retryLane:0};function Sl(e){return{baseLanes:e,cachePool:null,transitions:null}}function gp(e,t,n){var r=t.pendingProps,o=lt.current,a=!1,s=(t.flags&128)!==0,l;if((l=s)||(l=e!==null&&e.memoizedState===null?!1:(o&2)!==0),l?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(o|=1),Xe(lt,o&1),e===null)return vl(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(s=r.children,e=r.fallback,a?(r=t.mode,a=t.child,s={mode:"hidden",children:s},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=s):a=es(s,r,0,null),e=Ar(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=Sl(n),t.memoizedState=El,e):jd(t,s));if(o=e.memoizedState,o!==null&&(l=o.dehydrated,l!==null))return $y(e,t,s,r,l,o,n);if(a){a=r.fallback,s=t.mode,o=e.child,l=o.sibling;var c={mode:"hidden",children:r.children};return!(s&1)&&t.child!==o?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=gr(o,c),r.subtreeFlags=o.subtreeFlags&14680064),l!==null?a=gr(l,a):(a=Ar(a,s,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,s=e.child.memoizedState,s=s===null?Sl(n):{baseLanes:s.baseLanes|n,cachePool:null,transitions:s.transitions},a.memoizedState=s,a.childLanes=e.childLanes&~n,t.memoizedState=El,r}return a=e.child,e=a.sibling,r=gr(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function jd(e,t){return t=es({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ka(e,t,n,r){return r!==null&&pd(r),ko(t,e.child,null,n),e=jd(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function $y(e,t,n,r,o,a,s){if(n)return t.flags&256?(t.flags&=-257,r=Rs(Error(te(422))),Ka(e,t,s,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,o=t.mode,r=es({mode:"visible",children:r.children},o,0,null),a=Ar(a,o,s,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&ko(t,e.child,null,s),t.child.memoizedState=Sl(s),t.memoizedState=El,a);if(!(t.mode&1))return Ka(e,t,s,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var l=r.dgst;return r=l,a=Error(te(419)),r=Rs(a,r,void 0),Ka(e,t,s,r)}if(l=(s&e.childLanes)!==0,Yt||l){if(r=It,r!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|s)?0:o,o!==0&&o!==a.retryLane&&(a.retryLane=o,qn(e,o),Nn(r,e,o,-1))}return Ad(),r=Rs(Error(te(421))),Ka(e,t,s,r)}return o.data==="$?"?(t.flags|=128,t.child=e.child,t=og.bind(null,e),o._reactRetry=t,null):(e=a.treeContext,rn=pr(o.nextSibling),on=t,at=!0,jn=null,e!==null&&(hn[yn++]=Vn,hn[yn++]=Hn,hn[yn++]=Pr,Vn=e.id,Hn=e.overflow,Pr=t),t=jd(t,r.children),t.flags|=4096,t)}function ec(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),xl(e.return,t,n)}function As(e,t,n,r,o){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=o)}function vp(e,t,n){var r=t.pendingProps,o=r.revealOrder,a=r.tail;if(Gt(e,t,r.children,n),r=lt.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ec(e,n,t);else if(e.tag===19)ec(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Xe(lt,r),!(t.mode&1))t.memoizedState=null;else switch(o){case"forwards":for(n=t.child,o=null;n!==null;)e=n.alternate,e!==null&&_i(e)===null&&(o=n),n=n.sibling;n=o,n===null?(o=t.child,t.child=null):(o=n.sibling,n.sibling=null),As(t,!1,o,n,a);break;case"backwards":for(n=null,o=t.child,t.child=null;o!==null;){if(e=o.alternate,e!==null&&_i(e)===null){t.child=o;break}e=o.sibling,o.sibling=n,n=o,o=e}As(t,!0,n,null,a);break;case"together":As(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function di(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Jn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Mr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(te(153));if(t.child!==null){for(e=t.child,n=gr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=gr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Wy(e,t,n){switch(t.tag){case 3:yp(t),wo();break;case 5:Hf(t);break;case 1:Xt(t.type)&&Ti(t);break;case 4:xd(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,o=t.memoizedProps.value;Xe(ji,r._currentValue),r._currentValue=o;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Xe(lt,lt.current&1),t.flags|=128,null):n&t.child.childLanes?gp(e,t,n):(Xe(lt,lt.current&1),e=Jn(e,t,n),e!==null?e.sibling:null);Xe(lt,lt.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return vp(e,t,n);t.flags|=128}if(o=t.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Xe(lt,lt.current),r)break;return null;case 22:case 23:return t.lanes=0,mp(e,t,n)}return Jn(e,t,n)}var xp,jl,wp,kp;xp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jl=function(){};wp=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Dr(Un.current);var a=null;switch(n){case"input":o=Js(e,o),r=Js(e,r),a=[];break;case"select":o=ut({},o,{value:void 0}),r=ut({},r,{value:void 0}),a=[];break;case"textarea":o=Qs(e,o),r=Qs(e,r),a=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=bi)}el(n,r);var s;n=null;for(d in o)if(!r.hasOwnProperty(d)&&o.hasOwnProperty(d)&&o[d]!=null)if(d==="style"){var l=o[d];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(sa.hasOwnProperty(d)?a||(a=[]):(a=a||[]).push(d,null));for(d in r){var c=r[d];if(l=o!=null?o[d]:void 0,r.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(a||(a=[]),a.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(a=a||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(sa.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&nt("scroll",e),a||l===c||(a=[])):(a=a||[]).push(d,c))}n&&(a=a||[]).push("style",n);var d=a;(t.updateQueue=d)&&(t.flags|=4)}};kp=function(e,t,n,r){n!==r&&(t.flags|=4)};function Vo(e,t){if(!at)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Lt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=e,o=o.sibling;else for(o=e.child;o!==null;)n|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=e,o=o.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ky(e,t,n){var r=t.pendingProps;switch(fd(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Lt(t),null;case 1:return Xt(t.type)&&Ci(),Lt(t),null;case 3:return r=t.stateNode,bo(),rt(Qt),rt(zt),kd(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&($a(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,jn!==null&&(Pl(jn),jn=null))),jl(e,t),Lt(t),null;case 5:wd(t);var o=Dr(xa.current);if(n=t.type,e!==null&&t.stateNode!=null)wp(e,t,n,r,o),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(te(166));return Lt(t),null}if(e=Dr(Un.current),$a(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[Ln]=t,r[ga]=a,e=(t.mode&1)!==0,n){case"dialog":nt("cancel",r),nt("close",r);break;case"iframe":case"object":case"embed":nt("load",r);break;case"video":case"audio":for(o=0;o<Jo.length;o++)nt(Jo[o],r);break;case"source":nt("error",r);break;case"img":case"image":case"link":nt("error",r),nt("load",r);break;case"details":nt("toggle",r);break;case"input":du(r,a),nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},nt("invalid",r);break;case"textarea":cu(r,a),nt("invalid",r)}el(n,a),o=null;for(var s in a)if(a.hasOwnProperty(s)){var l=a[s];s==="children"?typeof l=="string"?r.textContent!==l&&(a.suppressHydrationWarning!==!0&&Ha(r.textContent,l,e),o=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(a.suppressHydrationWarning!==!0&&Ha(r.textContent,l,e),o=["children",""+l]):sa.hasOwnProperty(s)&&l!=null&&s==="onScroll"&&nt("scroll",r)}switch(n){case"input":La(r),uu(r,a,!0);break;case"textarea":La(r),fu(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=bi)}r=o,t.updateQueue=r,r!==null&&(t.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=qc(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=s.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=s.createElement(n,{is:r.is}):(e=s.createElement(n),n==="select"&&(s=e,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):e=s.createElementNS(e,n),e[Ln]=t,e[ga]=r,xp(e,t,!1,!1),t.stateNode=e;e:{switch(s=tl(n,r),n){case"dialog":nt("cancel",e),nt("close",e),o=r;break;case"iframe":case"object":case"embed":nt("load",e),o=r;break;case"video":case"audio":for(o=0;o<Jo.length;o++)nt(Jo[o],e);o=r;break;case"source":nt("error",e),o=r;break;case"img":case"image":case"link":nt("error",e),nt("load",e),o=r;break;case"details":nt("toggle",e),o=r;break;case"input":du(e,r),o=Js(e,r),nt("invalid",e);break;case"option":o=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=ut({},r,{value:void 0}),nt("invalid",e);break;case"textarea":cu(e,r),o=Qs(e,r),nt("invalid",e);break;default:o=r}el(n,o),l=o;for(a in l)if(l.hasOwnProperty(a)){var c=l[a];a==="style"?Zc(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Jc(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&la(e,c):typeof c=="number"&&la(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(sa.hasOwnProperty(a)?c!=null&&a==="onScroll"&&nt("scroll",e):c!=null&&Zl(e,a,c,s))}switch(n){case"input":La(e),uu(e,r,!1);break;case"textarea":La(e),fu(e);break;case"option":r.value!=null&&e.setAttribute("value",""+xr(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?fo(e,!!r.multiple,a,!1):r.defaultValue!=null&&fo(e,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(e.onclick=bi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Lt(t),null;case 6:if(e&&t.stateNode!=null)kp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(te(166));if(n=Dr(xa.current),Dr(Un.current),$a(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ln]=t,(a=r.nodeValue!==n)&&(e=on,e!==null))switch(e.tag){case 3:Ha(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ha(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ln]=t,t.stateNode=r}return Lt(t),null;case 13:if(rt(lt),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(at&&rn!==null&&t.mode&1&&!(t.flags&128))Uf(),wo(),t.flags|=98560,a=!1;else if(a=$a(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(te(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(te(317));a[Ln]=t}else wo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Lt(t),a=!1}else jn!==null&&(Pl(jn),jn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||lt.current&1?Et===0&&(Et=3):Ad())),t.updateQueue!==null&&(t.flags|=4),Lt(t),null);case 4:return bo(),jl(e,t),e===null&&ha(t.stateNode.containerInfo),Lt(t),null;case 10:return yd(t.type._context),Lt(t),null;case 17:return Xt(t.type)&&Ci(),Lt(t),null;case 19:if(rt(lt),a=t.memoizedState,a===null)return Lt(t),null;if(r=(t.flags&128)!==0,s=a.rendering,s===null)if(r)Vo(a,!1);else{if(Et!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(s=_i(e),s!==null){for(t.flags|=128,Vo(a,!1),r=s.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,s=a.alternate,s===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=s.childLanes,a.lanes=s.lanes,a.child=s.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=s.memoizedProps,a.memoizedState=s.memoizedState,a.updateQueue=s.updateQueue,a.type=s.type,e=s.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Xe(lt,lt.current&1|2),t.child}e=e.sibling}a.tail!==null&&gt()>To&&(t.flags|=128,r=!0,Vo(a,!1),t.lanes=4194304)}else{if(!r)if(e=_i(s),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Vo(a,!0),a.tail===null&&a.tailMode==="hidden"&&!s.alternate&&!at)return Lt(t),null}else 2*gt()-a.renderingStartTime>To&&n!==1073741824&&(t.flags|=128,r=!0,Vo(a,!1),t.lanes=4194304);a.isBackwards?(s.sibling=t.child,t.child=s):(n=a.last,n!==null?n.sibling=s:t.child=s,a.last=s)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=gt(),t.sibling=null,n=lt.current,Xe(lt,r?n&1|2:n&1),t):(Lt(t),null);case 22:case 23:return Rd(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?nn&1073741824&&(Lt(t),t.subtreeFlags&6&&(t.flags|=8192)):Lt(t),null;case 24:return null;case 25:return null}throw Error(te(156,t.tag))}function qy(e,t){switch(fd(t),t.tag){case 1:return Xt(t.type)&&Ci(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return bo(),rt(Qt),rt(zt),kd(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return wd(t),null;case 13:if(rt(lt),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(te(340));wo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return rt(lt),null;case 4:return bo(),null;case 10:return yd(t.type._context),null;case 22:case 23:return Rd(),null;case 24:return null;default:return null}}var qa=!1,Mt=!1,Jy=typeof WeakSet=="function"?WeakSet:Set,ge=null;function lo(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){mt(e,t,r)}else n.current=null}function Il(e,t,n){try{n()}catch(r){mt(e,t,r)}}var tc=!1;function Yy(e,t){if(cl=xi,e=Sf(),ud(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var o=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var s=0,l=-1,c=-1,d=0,h=0,k=e,g=null;t:for(;;){for(var b;k!==n||o!==0&&k.nodeType!==3||(l=s+o),k!==a||r!==0&&k.nodeType!==3||(c=s+r),k.nodeType===3&&(s+=k.nodeValue.length),(b=k.firstChild)!==null;)g=k,k=b;for(;;){if(k===e)break t;if(g===n&&++d===o&&(l=s),g===a&&++h===r&&(c=s),(b=k.nextSibling)!==null)break;k=g,g=k.parentNode}k=b}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(fl={focusedElem:e,selectionRange:n},xi=!1,ge=t;ge!==null;)if(t=ge,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ge=e;else for(;ge!==null;){t=ge;try{var x=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(x!==null){var A=x.memoizedProps,T=x.memoizedState,u=t.stateNode,m=u.getSnapshotBeforeUpdate(t.elementType===t.type?A:En(t.type,A),T);u.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var f=t.stateNode.containerInfo;f.nodeType===1?f.textContent="":f.nodeType===9&&f.documentElement&&f.removeChild(f.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(te(163))}}catch(D){mt(t,t.return,D)}if(e=t.sibling,e!==null){e.return=t.return,ge=e;break}ge=t.return}return x=tc,tc=!1,x}function ra(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&e)===e){var a=o.destroy;o.destroy=void 0,a!==void 0&&Il(t,n,a)}o=o.next}while(o!==r)}}function Qi(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Nl(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function bp(e){var t=e.alternate;t!==null&&(e.alternate=null,bp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ln],delete t[ga],delete t[hl],delete t[Ry],delete t[Ay])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Cp(e){return e.tag===5||e.tag===3||e.tag===4}function nc(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Cp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function _l(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=bi));else if(r!==4&&(e=e.child,e!==null))for(_l(e,t,n),e=e.sibling;e!==null;)_l(e,t,n),e=e.sibling}function Dl(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Dl(e,t,n),e=e.sibling;e!==null;)Dl(e,t,n),e=e.sibling}var Dt=null,Sn=!1;function tr(e,t,n){for(n=n.child;n!==null;)Tp(e,t,n),n=n.sibling}function Tp(e,t,n){if(zn&&typeof zn.onCommitFiberUnmount=="function")try{zn.onCommitFiberUnmount(Hi,n)}catch{}switch(n.tag){case 5:Mt||lo(n,t);case 6:var r=Dt,o=Sn;Dt=null,tr(e,t,n),Dt=r,Sn=o,Dt!==null&&(Sn?(e=Dt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(Sn?(e=Dt,n=n.stateNode,e.nodeType===8?Ss(e.parentNode,n):e.nodeType===1&&Ss(e,n),fa(e)):Ss(Dt,n.stateNode));break;case 4:r=Dt,o=Sn,Dt=n.stateNode.containerInfo,Sn=!0,tr(e,t,n),Dt=r,Sn=o;break;case 0:case 11:case 14:case 15:if(!Mt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var a=o,s=a.destroy;a=a.tag,s!==void 0&&(a&2||a&4)&&Il(n,t,s),o=o.next}while(o!==r)}tr(e,t,n);break;case 1:if(!Mt&&(lo(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){mt(n,t,l)}tr(e,t,n);break;case 21:tr(e,t,n);break;case 22:n.mode&1?(Mt=(r=Mt)||n.memoizedState!==null,tr(e,t,n),Mt=r):tr(e,t,n);break;default:tr(e,t,n)}}function rc(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Jy),t.forEach(function(r){var o=ag.bind(null,e,r);n.has(r)||(n.add(r),r.then(o,o))})}}function Tn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var o=n[r];try{var a=e,s=t,l=s;e:for(;l!==null;){switch(l.tag){case 5:Dt=l.stateNode,Sn=!1;break e;case 3:Dt=l.stateNode.containerInfo,Sn=!0;break e;case 4:Dt=l.stateNode.containerInfo,Sn=!0;break e}l=l.return}if(Dt===null)throw Error(te(160));Tp(a,s,o),Dt=null,Sn=!1;var c=o.alternate;c!==null&&(c.return=null),o.return=null}catch(d){mt(o,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ep(t,e),t=t.sibling}function Ep(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Tn(t,e),An(e),r&4){try{ra(3,e,e.return),Qi(3,e)}catch(A){mt(e,e.return,A)}try{ra(5,e,e.return)}catch(A){mt(e,e.return,A)}}break;case 1:Tn(t,e),An(e),r&512&&n!==null&&lo(n,n.return);break;case 5:if(Tn(t,e),An(e),r&512&&n!==null&&lo(n,n.return),e.flags&32){var o=e.stateNode;try{la(o,"")}catch(A){mt(e,e.return,A)}}if(r&4&&(o=e.stateNode,o!=null)){var a=e.memoizedProps,s=n!==null?n.memoizedProps:a,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&a.type==="radio"&&a.name!=null&&Wc(o,a),tl(l,s);var d=tl(l,a);for(s=0;s<c.length;s+=2){var h=c[s],k=c[s+1];h==="style"?Zc(o,k):h==="dangerouslySetInnerHTML"?Jc(o,k):h==="children"?la(o,k):Zl(o,h,k,d)}switch(l){case"input":Ys(o,a);break;case"textarea":Kc(o,a);break;case"select":var g=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!a.multiple;var b=a.value;b!=null?fo(o,!!a.multiple,b,!1):g!==!!a.multiple&&(a.defaultValue!=null?fo(o,!!a.multiple,a.defaultValue,!0):fo(o,!!a.multiple,a.multiple?[]:"",!1))}o[ga]=a}catch(A){mt(e,e.return,A)}}break;case 6:if(Tn(t,e),An(e),r&4){if(e.stateNode===null)throw Error(te(162));o=e.stateNode,a=e.memoizedProps;try{o.nodeValue=a}catch(A){mt(e,e.return,A)}}break;case 3:if(Tn(t,e),An(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{fa(t.containerInfo)}catch(A){mt(e,e.return,A)}break;case 4:Tn(t,e),An(e);break;case 13:Tn(t,e),An(e),o=e.child,o.flags&8192&&(a=o.memoizedState!==null,o.stateNode.isHidden=a,!a||o.alternate!==null&&o.alternate.memoizedState!==null||(_d=gt())),r&4&&rc(e);break;case 22:if(h=n!==null&&n.memoizedState!==null,e.mode&1?(Mt=(d=Mt)||h,Tn(t,e),Mt=d):Tn(t,e),An(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!h&&e.mode&1)for(ge=e,h=e.child;h!==null;){for(k=ge=h;ge!==null;){switch(g=ge,b=g.child,g.tag){case 0:case 11:case 14:case 15:ra(4,g,g.return);break;case 1:lo(g,g.return);var x=g.stateNode;if(typeof x.componentWillUnmount=="function"){r=g,n=g.return;try{t=r,x.props=t.memoizedProps,x.state=t.memoizedState,x.componentWillUnmount()}catch(A){mt(r,n,A)}}break;case 5:lo(g,g.return);break;case 22:if(g.memoizedState!==null){ac(k);continue}}b!==null?(b.return=g,ge=b):ac(k)}h=h.sibling}e:for(h=null,k=e;;){if(k.tag===5){if(h===null){h=k;try{o=k.stateNode,d?(a=o.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(l=k.stateNode,c=k.memoizedProps.style,s=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=Yc("display",s))}catch(A){mt(e,e.return,A)}}}else if(k.tag===6){if(h===null)try{k.stateNode.nodeValue=d?"":k.memoizedProps}catch(A){mt(e,e.return,A)}}else if((k.tag!==22&&k.tag!==23||k.memoizedState===null||k===e)&&k.child!==null){k.child.return=k,k=k.child;continue}if(k===e)break e;for(;k.sibling===null;){if(k.return===null||k.return===e)break e;h===k&&(h=null),k=k.return}h===k&&(h=null),k.sibling.return=k.return,k=k.sibling}}break;case 19:Tn(t,e),An(e),r&4&&rc(e);break;case 21:break;default:Tn(t,e),An(e)}}function An(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Cp(n)){var r=n;break e}n=n.return}throw Error(te(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(la(o,""),r.flags&=-33);var a=nc(e);Dl(e,a,o);break;case 3:case 4:var s=r.stateNode.containerInfo,l=nc(e);_l(e,l,s);break;default:throw Error(te(161))}}catch(c){mt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Zy(e,t,n){ge=e,Sp(e)}function Sp(e,t,n){for(var r=(e.mode&1)!==0;ge!==null;){var o=ge,a=o.child;if(o.tag===22&&r){var s=o.memoizedState!==null||qa;if(!s){var l=o.alternate,c=l!==null&&l.memoizedState!==null||Mt;l=qa;var d=Mt;if(qa=s,(Mt=c)&&!d)for(ge=o;ge!==null;)s=ge,c=s.child,s.tag===22&&s.memoizedState!==null?ic(o):c!==null?(c.return=s,ge=c):ic(o);for(;a!==null;)ge=a,Sp(a),a=a.sibling;ge=o,qa=l,Mt=d}oc(e)}else o.subtreeFlags&8772&&a!==null?(a.return=o,ge=a):oc(e)}}function oc(e){for(;ge!==null;){var t=ge;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Mt||Qi(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Mt)if(n===null)r.componentDidMount();else{var o=t.elementType===t.type?n.memoizedProps:En(t.type,n.memoizedProps);r.componentDidUpdate(o,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Gu(t,a,r);break;case 3:var s=t.updateQueue;if(s!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Gu(t,s,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var k=h.dehydrated;k!==null&&fa(k)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(te(163))}Mt||t.flags&512&&Nl(t)}catch(g){mt(t,t.return,g)}}if(t===e){ge=null;break}if(n=t.sibling,n!==null){n.return=t.return,ge=n;break}ge=t.return}}function ac(e){for(;ge!==null;){var t=ge;if(t===e){ge=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ge=n;break}ge=t.return}}function ic(e){for(;ge!==null;){var t=ge;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Qi(4,t)}catch(c){mt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var o=t.return;try{r.componentDidMount()}catch(c){mt(t,o,c)}}var a=t.return;try{Nl(t)}catch(c){mt(t,a,c)}break;case 5:var s=t.return;try{Nl(t)}catch(c){mt(t,s,c)}}}catch(c){mt(t,t.return,c)}if(t===e){ge=null;break}var l=t.sibling;if(l!==null){l.return=t.return,ge=l;break}ge=t.return}}var Qy=Math.ceil,Ai=Yn.ReactCurrentDispatcher,Id=Yn.ReactCurrentOwner,vn=Yn.ReactCurrentBatchConfig,Ke=0,It=null,kt=null,Rt=0,nn=0,uo=br(0),Et=0,Ca=null,Mr=0,Xi=0,Nd=0,oa=null,Jt=null,_d=0,To=1/0,Bn=null,Oi=!1,Rl=null,hr=null,Ja=!1,lr=null,Pi=0,aa=0,Al=null,ui=-1,ci=0;function Ht(){return Ke&6?gt():ui!==-1?ui:ui=gt()}function yr(e){return e.mode&1?Ke&2&&Rt!==0?Rt&-Rt:Py.transition!==null?(ci===0&&(ci=uf()),ci):(e=Ze,e!==0||(e=window.event,e=e===void 0?16:gf(e.type)),e):1}function Nn(e,t,n,r){if(50<aa)throw aa=0,Al=null,Error(te(185));Ia(e,n,r),(!(Ke&2)||e!==It)&&(e===It&&(!(Ke&2)&&(Xi|=n),Et===4&&ir(e,Rt)),en(e,r),n===1&&Ke===0&&!(t.mode&1)&&(To=gt()+500,Ji&&Cr()))}function en(e,t){var n=e.callbackNode;Ph(e,t);var r=vi(e,e===It?Rt:0);if(r===0)n!==null&&hu(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&hu(n),t===1)e.tag===0?Oy(sc.bind(null,e)):Lf(sc.bind(null,e)),_y(function(){!(Ke&6)&&Cr()}),n=null;else{switch(cf(r)){case 1:n=nd;break;case 4:n=lf;break;case 16:n=gi;break;case 536870912:n=df;break;default:n=gi}n=Op(n,jp.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function jp(e,t){if(ui=-1,ci=0,Ke&6)throw Error(te(327));var n=e.callbackNode;if(go()&&e.callbackNode!==n)return null;var r=vi(e,e===It?Rt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Li(e,r);else{t=r;var o=Ke;Ke|=2;var a=Np();(It!==e||Rt!==t)&&(Bn=null,To=gt()+500,Rr(e,t));do try{tg();break}catch(l){Ip(e,l)}while(!0);hd(),Ai.current=a,Ke=o,kt!==null?t=0:(It=null,Rt=0,t=Et)}if(t!==0){if(t===2&&(o=il(e),o!==0&&(r=o,t=Ol(e,o))),t===1)throw n=Ca,Rr(e,0),ir(e,r),en(e,gt()),n;if(t===6)ir(e,r);else{if(o=e.current.alternate,!(r&30)&&!Xy(o)&&(t=Li(e,r),t===2&&(a=il(e),a!==0&&(r=a,t=Ol(e,a))),t===1))throw n=Ca,Rr(e,0),ir(e,r),en(e,gt()),n;switch(e.finishedWork=o,e.finishedLanes=r,t){case 0:case 1:throw Error(te(345));case 2:Ir(e,Jt,Bn);break;case 3:if(ir(e,r),(r&130023424)===r&&(t=_d+500-gt(),10<t)){if(vi(e,0)!==0)break;if(o=e.suspendedLanes,(o&r)!==r){Ht(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=ml(Ir.bind(null,e,Jt,Bn),t);break}Ir(e,Jt,Bn);break;case 4:if(ir(e,r),(r&4194240)===r)break;for(t=e.eventTimes,o=-1;0<r;){var s=31-In(r);a=1<<s,s=t[s],s>o&&(o=s),r&=~a}if(r=o,r=gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Qy(r/1960))-r,10<r){e.timeoutHandle=ml(Ir.bind(null,e,Jt,Bn),r);break}Ir(e,Jt,Bn);break;case 5:Ir(e,Jt,Bn);break;default:throw Error(te(329))}}}return en(e,gt()),e.callbackNode===n?jp.bind(null,e):null}function Ol(e,t){var n=oa;return e.current.memoizedState.isDehydrated&&(Rr(e,t).flags|=256),e=Li(e,t),e!==2&&(t=Jt,Jt=n,t!==null&&Pl(t)),e}function Pl(e){Jt===null?Jt=e:Jt.push.apply(Jt,e)}function Xy(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var o=n[r],a=o.getSnapshot;o=o.value;try{if(!_n(a(),o))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ir(e,t){for(t&=~Nd,t&=~Xi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-In(t),r=1<<n;e[n]=-1,t&=~r}}function sc(e){if(Ke&6)throw Error(te(327));go();var t=vi(e,0);if(!(t&1))return en(e,gt()),null;var n=Li(e,t);if(e.tag!==0&&n===2){var r=il(e);r!==0&&(t=r,n=Ol(e,r))}if(n===1)throw n=Ca,Rr(e,0),ir(e,t),en(e,gt()),n;if(n===6)throw Error(te(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ir(e,Jt,Bn),en(e,gt()),null}function Dd(e,t){var n=Ke;Ke|=1;try{return e(t)}finally{Ke=n,Ke===0&&(To=gt()+500,Ji&&Cr())}}function zr(e){lr!==null&&lr.tag===0&&!(Ke&6)&&go();var t=Ke;Ke|=1;var n=vn.transition,r=Ze;try{if(vn.transition=null,Ze=1,e)return e()}finally{Ze=r,vn.transition=n,Ke=t,!(Ke&6)&&Cr()}}function Rd(){nn=uo.current,rt(uo)}function Rr(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Ny(n)),kt!==null)for(n=kt.return;n!==null;){var r=n;switch(fd(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Ci();break;case 3:bo(),rt(Qt),rt(zt),kd();break;case 5:wd(r);break;case 4:bo();break;case 13:rt(lt);break;case 19:rt(lt);break;case 10:yd(r.type._context);break;case 22:case 23:Rd()}n=n.return}if(It=e,kt=e=gr(e.current,null),Rt=nn=t,Et=0,Ca=null,Nd=Xi=Mr=0,Jt=oa=null,_r!==null){for(t=0;t<_r.length;t++)if(n=_r[t],r=n.interleaved,r!==null){n.interleaved=null;var o=r.next,a=n.pending;if(a!==null){var s=a.next;a.next=o,r.next=s}n.pending=r}_r=null}return e}function Ip(e,t){do{var n=kt;try{if(hd(),si.current=Ri,Di){for(var r=dt.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Di=!1}if(Lr=0,jt=Tt=dt=null,na=!1,wa=0,Id.current=null,n===null||n.return===null){Et=1,Ca=t,kt=null;break}e:{var a=e,s=n.return,l=n,c=t;if(t=Rt,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=l,k=h.tag;if(!(h.mode&1)&&(k===0||k===11||k===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var b=qu(s);if(b!==null){b.flags&=-257,Ju(b,s,l,a,t),b.mode&1&&Ku(a,d,t),t=b,c=d;var x=t.updateQueue;if(x===null){var A=new Set;A.add(c),t.updateQueue=A}else x.add(c);break e}else{if(!(t&1)){Ku(a,d,t),Ad();break e}c=Error(te(426))}}else if(at&&l.mode&1){var T=qu(s);if(T!==null){!(T.flags&65536)&&(T.flags|=256),Ju(T,s,l,a,t),pd(Co(c,l));break e}}a=c=Co(c,l),Et!==4&&(Et=2),oa===null?oa=[a]:oa.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var u=cp(a,c,t);Bu(a,u);break e;case 1:l=c;var m=a.type,f=a.stateNode;if(!(a.flags&128)&&(typeof m.getDerivedStateFromError=="function"||f!==null&&typeof f.componentDidCatch=="function"&&(hr===null||!hr.has(f)))){a.flags|=65536,t&=-t,a.lanes|=t;var D=fp(a,l,t);Bu(a,D);break e}}a=a.return}while(a!==null)}Dp(n)}catch(N){t=N,kt===n&&n!==null&&(kt=n=n.return);continue}break}while(!0)}function Np(){var e=Ai.current;return Ai.current=Ri,e===null?Ri:e}function Ad(){(Et===0||Et===3||Et===2)&&(Et=4),It===null||!(Mr&268435455)&&!(Xi&268435455)||ir(It,Rt)}function Li(e,t){var n=Ke;Ke|=2;var r=Np();(It!==e||Rt!==t)&&(Bn=null,Rr(e,t));do try{eg();break}catch(o){Ip(e,o)}while(!0);if(hd(),Ke=n,Ai.current=r,kt!==null)throw Error(te(261));return It=null,Rt=0,Et}function eg(){for(;kt!==null;)_p(kt)}function tg(){for(;kt!==null&&!Sh();)_p(kt)}function _p(e){var t=Ap(e.alternate,e,nn);e.memoizedProps=e.pendingProps,t===null?Dp(e):kt=t,Id.current=null}function Dp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=qy(n,t),n!==null){n.flags&=32767,kt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Et=6,kt=null;return}}else if(n=Ky(n,t,nn),n!==null){kt=n;return}if(t=t.sibling,t!==null){kt=t;return}kt=t=e}while(t!==null);Et===0&&(Et=5)}function Ir(e,t,n){var r=Ze,o=vn.transition;try{vn.transition=null,Ze=1,ng(e,t,n,r)}finally{vn.transition=o,Ze=r}return null}function ng(e,t,n,r){do go();while(lr!==null);if(Ke&6)throw Error(te(327));n=e.finishedWork;var o=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(te(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(Lh(e,a),e===It&&(kt=It=null,Rt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ja||(Ja=!0,Op(gi,function(){return go(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=vn.transition,vn.transition=null;var s=Ze;Ze=1;var l=Ke;Ke|=4,Id.current=null,Yy(e,n),Ep(n,e),by(fl),xi=!!cl,fl=cl=null,e.current=n,Zy(n),jh(),Ke=l,Ze=s,vn.transition=a}else e.current=n;if(Ja&&(Ja=!1,lr=e,Pi=o),a=e.pendingLanes,a===0&&(hr=null),_h(n.stateNode),en(e,gt()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)o=t[n],r(o.value,{componentStack:o.stack,digest:o.digest});if(Oi)throw Oi=!1,e=Rl,Rl=null,e;return Pi&1&&e.tag!==0&&go(),a=e.pendingLanes,a&1?e===Al?aa++:(aa=0,Al=e):aa=0,Cr(),null}function go(){if(lr!==null){var e=cf(Pi),t=vn.transition,n=Ze;try{if(vn.transition=null,Ze=16>e?16:e,lr===null)var r=!1;else{if(e=lr,lr=null,Pi=0,Ke&6)throw Error(te(331));var o=Ke;for(Ke|=4,ge=e.current;ge!==null;){var a=ge,s=a.child;if(ge.flags&16){var l=a.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for(ge=d;ge!==null;){var h=ge;switch(h.tag){case 0:case 11:case 15:ra(8,h,a)}var k=h.child;if(k!==null)k.return=h,ge=k;else for(;ge!==null;){h=ge;var g=h.sibling,b=h.return;if(bp(h),h===d){ge=null;break}if(g!==null){g.return=b,ge=g;break}ge=b}}}var x=a.alternate;if(x!==null){var A=x.child;if(A!==null){x.child=null;do{var T=A.sibling;A.sibling=null,A=T}while(A!==null)}}ge=a}}if(a.subtreeFlags&2064&&s!==null)s.return=a,ge=s;else e:for(;ge!==null;){if(a=ge,a.flags&2048)switch(a.tag){case 0:case 11:case 15:ra(9,a,a.return)}var u=a.sibling;if(u!==null){u.return=a.return,ge=u;break e}ge=a.return}}var m=e.current;for(ge=m;ge!==null;){s=ge;var f=s.child;if(s.subtreeFlags&2064&&f!==null)f.return=s,ge=f;else e:for(s=m;ge!==null;){if(l=ge,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Qi(9,l)}}catch(N){mt(l,l.return,N)}if(l===s){ge=null;break e}var D=l.sibling;if(D!==null){D.return=l.return,ge=D;break e}ge=l.return}}if(Ke=o,Cr(),zn&&typeof zn.onPostCommitFiberRoot=="function")try{zn.onPostCommitFiberRoot(Hi,e)}catch{}r=!0}return r}finally{Ze=n,vn.transition=t}}return!1}function lc(e,t,n){t=Co(n,t),t=cp(e,t,1),e=mr(e,t,1),t=Ht(),e!==null&&(Ia(e,1,t),en(e,t))}function mt(e,t,n){if(e.tag===3)lc(e,e,n);else for(;t!==null;){if(t.tag===3){lc(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(hr===null||!hr.has(r))){e=Co(n,e),e=fp(t,e,1),t=mr(t,e,1),e=Ht(),t!==null&&(Ia(t,1,e),en(t,e));break}}t=t.return}}function rg(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Ht(),e.pingedLanes|=e.suspendedLanes&n,It===e&&(Rt&n)===n&&(Et===4||Et===3&&(Rt&130023424)===Rt&&500>gt()-_d?Rr(e,0):Nd|=n),en(e,t)}function Rp(e,t){t===0&&(e.mode&1?(t=Ua,Ua<<=1,!(Ua&130023424)&&(Ua=4194304)):t=1);var n=Ht();e=qn(e,t),e!==null&&(Ia(e,t,n),en(e,n))}function og(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Rp(e,n)}function ag(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,o=e.memoizedState;o!==null&&(n=o.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(te(314))}r!==null&&r.delete(t),Rp(e,n)}var Ap;Ap=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Qt.current)Yt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Yt=!1,Wy(e,t,n);Yt=!!(e.flags&131072)}else Yt=!1,at&&t.flags&1048576&&Mf(t,Si,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;di(e,t),e=t.pendingProps;var o=xo(t,zt.current);yo(t,n),o=Cd(null,t,r,e,o,n);var a=Td();return t.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Xt(r)?(a=!0,Ti(t)):a=!1,t.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,vd(t),o.updater=Zi,t.stateNode=o,o._reactInternals=t,kl(t,r,e,n),t=Tl(null,t,r,!0,a,n)):(t.tag=0,at&&a&&cd(t),Gt(null,t,o,n),t=t.child),t;case 16:r=t.elementType;e:{switch(di(e,t),e=t.pendingProps,o=r._init,r=o(r._payload),t.type=r,o=t.tag=sg(r),e=En(r,e),o){case 0:t=Cl(null,t,r,e,n);break e;case 1:t=Qu(null,t,r,e,n);break e;case 11:t=Yu(null,t,r,e,n);break e;case 14:t=Zu(null,t,r,En(r.type,e),n);break e}throw Error(te(306,r,""))}return t;case 0:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:En(r,o),Cl(e,t,r,o,n);case 1:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:En(r,o),Qu(e,t,r,o,n);case 3:e:{if(yp(t),e===null)throw Error(te(387));r=t.pendingProps,a=t.memoizedState,o=a.element,Vf(e,t),Ni(t,r,null,n);var s=t.memoizedState;if(r=s.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){o=Co(Error(te(423)),t),t=Xu(e,t,r,n,o);break e}else if(r!==o){o=Co(Error(te(424)),t),t=Xu(e,t,r,n,o);break e}else for(rn=pr(t.stateNode.containerInfo.firstChild),on=t,at=!0,jn=null,n=Bf(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(wo(),r===o){t=Jn(e,t,n);break e}Gt(e,t,r,n)}t=t.child}return t;case 5:return Hf(t),e===null&&vl(t),r=t.type,o=t.pendingProps,a=e!==null?e.memoizedProps:null,s=o.children,pl(r,o)?s=null:a!==null&&pl(r,a)&&(t.flags|=32),hp(e,t),Gt(e,t,s,n),t.child;case 6:return e===null&&vl(t),null;case 13:return gp(e,t,n);case 4:return xd(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=ko(t,null,r,n):Gt(e,t,r,n),t.child;case 11:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:En(r,o),Yu(e,t,r,o,n);case 7:return Gt(e,t,t.pendingProps,n),t.child;case 8:return Gt(e,t,t.pendingProps.children,n),t.child;case 12:return Gt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,o=t.pendingProps,a=t.memoizedProps,s=o.value,Xe(ji,r._currentValue),r._currentValue=s,a!==null)if(_n(a.value,s)){if(a.children===o.children&&!Qt.current){t=Jn(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var l=a.dependencies;if(l!==null){s=a.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=$n(-1,n&-n),c.tag=2;var d=a.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),xl(a.return,n,t),l.lanes|=n;break}c=c.next}}else if(a.tag===10)s=a.type===t.type?null:a.child;else if(a.tag===18){if(s=a.return,s===null)throw Error(te(341));s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),xl(s,n,t),s=a.sibling}else s=a.child;if(s!==null)s.return=a;else for(s=a;s!==null;){if(s===t){s=null;break}if(a=s.sibling,a!==null){a.return=s.return,s=a;break}s=s.return}a=s}Gt(e,t,o.children,n),t=t.child}return t;case 9:return o=t.type,r=t.pendingProps.children,yo(t,n),o=xn(o),r=r(o),t.flags|=1,Gt(e,t,r,n),t.child;case 14:return r=t.type,o=En(r,t.pendingProps),o=En(r.type,o),Zu(e,t,r,o,n);case 15:return pp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,o=t.pendingProps,o=t.elementType===r?o:En(r,o),di(e,t),t.tag=1,Xt(r)?(e=!0,Ti(t)):e=!1,yo(t,n),up(t,r,o),kl(t,r,o,n),Tl(null,t,r,!0,e,n);case 19:return vp(e,t,n);case 22:return mp(e,t,n)}throw Error(te(156,t.tag))};function Op(e,t){return sf(e,t)}function ig(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gn(e,t,n,r){return new ig(e,t,n,r)}function Od(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sg(e){if(typeof e=="function")return Od(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xl)return 11;if(e===ed)return 14}return 2}function gr(e,t){var n=e.alternate;return n===null?(n=gn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function fi(e,t,n,r,o,a){var s=2;if(r=e,typeof e=="function")Od(e)&&(s=1);else if(typeof e=="string")s=5;else e:switch(e){case Xr:return Ar(n.children,o,a,t);case Ql:s=8,o|=8;break;case $s:return e=gn(12,n,t,o|2),e.elementType=$s,e.lanes=a,e;case Ws:return e=gn(13,n,t,o),e.elementType=Ws,e.lanes=a,e;case Ks:return e=gn(19,n,t,o),e.elementType=Ks,e.lanes=a,e;case Vc:return es(n,o,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Bc:s=10;break e;case Gc:s=9;break e;case Xl:s=11;break e;case ed:s=14;break e;case rr:s=16,r=null;break e}throw Error(te(130,e==null?e:typeof e,""))}return t=gn(s,n,t,o),t.elementType=e,t.type=r,t.lanes=a,t}function Ar(e,t,n,r){return e=gn(7,e,r,t),e.lanes=n,e}function es(e,t,n,r){return e=gn(22,e,r,t),e.elementType=Vc,e.lanes=n,e.stateNode={isHidden:!1},e}function Os(e,t,n){return e=gn(6,e,null,t),e.lanes=n,e}function Ps(e,t,n){return t=gn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function lg(e,t,n,r,o){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=hs(0),this.expirationTimes=hs(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=hs(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function Pd(e,t,n,r,o,a,s,l,c){return e=new lg(e,t,n,l,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=gn(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},vd(a),e}function dg(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Qr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Pp(e){if(!e)return wr;e=e._reactInternals;e:{if(Br(e)!==e||e.tag!==1)throw Error(te(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Xt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(te(171))}if(e.tag===1){var n=e.type;if(Xt(n))return Pf(e,n,t)}return t}function Lp(e,t,n,r,o,a,s,l,c){return e=Pd(n,r,!0,e,o,a,s,l,c),e.context=Pp(null),n=e.current,r=Ht(),o=yr(n),a=$n(r,o),a.callback=t??null,mr(n,a,o),e.current.lanes=o,Ia(e,o,r),en(e,r),e}function ts(e,t,n,r){var o=t.current,a=Ht(),s=yr(o);return n=Pp(n),t.context===null?t.context=n:t.pendingContext=n,t=$n(a,s),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=mr(o,t,s),e!==null&&(Nn(e,o,s,a),ii(e,o,s)),s}function Mi(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function dc(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Ld(e,t){dc(e,t),(e=e.alternate)&&dc(e,t)}function ug(){return null}var Mp=typeof reportError=="function"?reportError:function(e){console.error(e)};function Md(e){this._internalRoot=e}ns.prototype.render=Md.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(te(409));ts(e,t,null,null)};ns.prototype.unmount=Md.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zr(function(){ts(null,e,null,null)}),t[Kn]=null}};function ns(e){this._internalRoot=e}ns.prototype.unstable_scheduleHydration=function(e){if(e){var t=mf();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ar.length&&t!==0&&t<ar[n].priority;n++);ar.splice(n,0,e),n===0&&yf(e)}};function zd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function rs(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function uc(){}function cg(e,t,n,r,o){if(o){if(typeof r=="function"){var a=r;r=function(){var d=Mi(s);a.call(d)}}var s=Lp(t,r,e,0,null,!1,!1,"",uc);return e._reactRootContainer=s,e[Kn]=s.current,ha(e.nodeType===8?e.parentNode:e),zr(),s}for(;o=e.lastChild;)e.removeChild(o);if(typeof r=="function"){var l=r;r=function(){var d=Mi(c);l.call(d)}}var c=Pd(e,0,!1,null,null,!1,!1,"",uc);return e._reactRootContainer=c,e[Kn]=c.current,ha(e.nodeType===8?e.parentNode:e),zr(function(){ts(t,c,n,r)}),c}function os(e,t,n,r,o){var a=n._reactRootContainer;if(a){var s=a;if(typeof o=="function"){var l=o;o=function(){var c=Mi(s);l.call(c)}}ts(t,s,e,o)}else s=cg(n,t,e,o,r);return Mi(s)}ff=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=qo(t.pendingLanes);n!==0&&(rd(t,n|1),en(t,gt()),!(Ke&6)&&(To=gt()+500,Cr()))}break;case 13:zr(function(){var r=qn(e,1);if(r!==null){var o=Ht();Nn(r,e,1,o)}}),Ld(e,1)}};od=function(e){if(e.tag===13){var t=qn(e,134217728);if(t!==null){var n=Ht();Nn(t,e,134217728,n)}Ld(e,134217728)}};pf=function(e){if(e.tag===13){var t=yr(e),n=qn(e,t);if(n!==null){var r=Ht();Nn(n,e,t,r)}Ld(e,t)}};mf=function(){return Ze};hf=function(e,t){var n=Ze;try{return Ze=e,t()}finally{Ze=n}};rl=function(e,t,n){switch(t){case"input":if(Ys(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var o=qi(r);if(!o)throw Error(te(90));$c(r),Ys(r,o)}}}break;case"textarea":Kc(e,n);break;case"select":t=n.value,t!=null&&fo(e,!!n.multiple,t,!1)}};ef=Dd;tf=zr;var fg={usingClientEntryPoint:!1,Events:[_a,ro,qi,Qc,Xc,Dd]},Ho={findFiberByHostInstance:Nr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pg={bundleType:Ho.bundleType,version:Ho.version,rendererPackageName:Ho.rendererPackageName,rendererConfig:Ho.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Yn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=of(e),e===null?null:e.stateNode},findFiberByHostInstance:Ho.findFiberByHostInstance||ug,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ya=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ya.isDisabled&&Ya.supportsFiber)try{Hi=Ya.inject(pg),zn=Ya}catch{}}sn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fg;sn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!zd(t))throw Error(te(200));return dg(e,t,null,n)};sn.createRoot=function(e,t){if(!zd(e))throw Error(te(299));var n=!1,r="",o=Mp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),t=Pd(e,1,!1,null,null,n,!1,r,o),e[Kn]=t.current,ha(e.nodeType===8?e.parentNode:e),new Md(t)};sn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(te(188)):(e=Object.keys(e).join(","),Error(te(268,e)));return e=of(t),e=e===null?null:e.stateNode,e};sn.flushSync=function(e){return zr(e)};sn.hydrate=function(e,t,n){if(!rs(t))throw Error(te(200));return os(null,e,t,!0,n)};sn.hydrateRoot=function(e,t,n){if(!zd(e))throw Error(te(405));var r=n!=null&&n.hydratedSources||null,o=!1,a="",s=Mp;if(n!=null&&(n.unstable_strictMode===!0&&(o=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(s=n.onRecoverableError)),t=Lp(t,null,e,1,n??null,o,!1,a,s),e[Kn]=t.current,ha(e),r)for(e=0;e<r.length;e++)n=r[e],o=n._getVersion,o=o(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,o]:t.mutableSourceEagerHydrationData.push(n,o);return new ns(t)};sn.render=function(e,t,n){if(!rs(t))throw Error(te(200));return os(null,e,t,!1,n)};sn.unmountComponentAtNode=function(e){if(!rs(e))throw Error(te(40));return e._reactRootContainer?(zr(function(){os(null,null,e,!1,function(){e._reactRootContainer=null,e[Kn]=null})}),!0):!1};sn.unstable_batchedUpdates=Dd;sn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!rs(n))throw Error(te(200));if(e==null||e._reactInternals===void 0)throw Error(te(38));return os(e,t,n,!1,r)};sn.version="18.3.1-next-f1338f8080-20240426";function zp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(zp)}catch(e){console.error(e)}}zp(),Mc.exports=sn;var Ud=Mc.exports,cc=Ud;Vs.createRoot=cc.createRoot,Vs.hydrateRoot=cc.hydrateRoot;var Be=(e=>(e.SynchroTech="SynchroTech",e.Hoods="Hoods",e.Optimates="Optimates",e.Fusion="Fusion",e.Command="Command",e.Tokens="Tokens",e.Custom="Custom",e.Neutral="Neutral",e))(Be||{}),vr=(e=>(e.FreeForAll="FFA",e.TwoVTwo="2v2",e.ThreeVOne="3v1",e))(vr||{});const mg={ipDeptAgent:{name:"IP Dept Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253319/SYN_IP_DEPT_AGENT_mhwphu.png",fallbackImage:"/images/cards/SYN_IP_DEPT_AGENT.png",power:2,ability:`Deploy: 2 stuns a card with exploit.
Support  Commit: A player discards a revealed card of your choice.`,flavorText:`- "You've violated copyright. Open the door. We have a search warrant."`,types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},tacticalAgent:{name:"Tactical Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253342/SYN_TACTICAL_AGENT_xbb7i0.png",fallbackImage:"/images/cards/SYN_TACTICAL_AGENT.png",power:3,ability:`Deploy: Aim a card with threat.
Setup: Destroy the card with aim.`,flavorText:'- "Nobody move! SynchroTech Security Service!"',types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},patrolAgent:{name:"Patrol Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253325/SYN_PATROL_AGENT_ioetlu.png",fallbackImage:"/images/cards/SYN_PATROL_AGENT.png",power:2,ability:`Setup: Move this card to any cell in a line.
Commit: Stun an adjacent opponent card with threat.`,flavorText:"They say the city never sleeps. We make sure it doesn't even blink.",types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},riotAgent:{name:"Riot Agent",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253337/SYN_RIOT_AGENT_jurf4t.png",fallbackImage:"/images/cards/SYN_RIOT_AGENT.png",power:3,ability:`Deploy: Push an opponent card 1 cell. May take its place.
Commit: Stun an adjacent opponent card with threat.`,flavorText:'- "Citizens, disperse! This meeting is unauthorized by SynchroTech."',types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},threatAnalyst:{name:"Threat Analyst",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253338/SYN_THREAT_ANALYST_sqnpgw.png",fallbackImage:"/images/cards/SYN_THREAT_ANALYST.png",power:2,ability:`Deploy: Exploit any card.
Support  Commit: Reveal 1 card for each of your exploits on the battlefield.`,flavorText:"",types:["Unit","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},mrPearlDoF:{name:"Mr. Pearl, Director of BioSynch",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764678622/Mr._Pearl_Director_of_BioSynch_mo0cil.png",fallbackImage:"/images/cards/SYN_IP_DEPT_AGENT.png",power:1,ability:`Pass: Your other units in lines get +1 Power.
Deploy: Search your deck for a unit card and put it into your hand.`,flavorText:"Efficiency is the only metric that matters.",types:["Unit","Hero","SynchroTech"],faction:"SynchroTech",allowedPanels:["DECK_BUILDER"]},recklessProvocateur:{name:"Reckless Provocateur",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253315/HOO_RECKLESS_PROVOCATEUR_hi7a9z.png",fallbackImage:"/images/cards/HOO_RECKLESS_PROVOCATEUR.png",power:3,ability:`Deploy: Swap positions with a card in an adjacent cell.
Commit: Move all counters from an allied card on the battlefield to this card.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},dataLiberator:{name:"Data Liberator",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253317/HOO_DATA_LIBERATOR_lbtqa2.png",fallbackImage:"/images/cards/HOO_DATA_LIBERATOR.png",power:2,ability:`Deploy: Exploit any card.
Support  Pass: Cards with your exploit counters give you points.`,flavorText:`- "Information doesn't want to be free. It needs to be."`,types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},cautiousAvenger:{name:"Cautious Avenger",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253309/HOO_CAUTIOUS_AVENGER_x4g4g3.png",fallbackImage:"/images/cards/HOO_CAUTIOUS_AVENGER.png",power:2,ability:`Deploy: Aim a card in a line.
Support  Setup: Destroy the card with aim.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},vigilantSpotter:{name:"Vigilant Spotter",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253311/HOO_VIGILANT_SPOTTER_eiephm.png",fallbackImage:"/images/cards/HOO_VIGILANT_SPOTTER.png",power:1,ability:`Support  Pass: When an opponent's revealed card enters the battlefield, gain 2 points.
Commit: Reveal 1 card from an opponent's hand or face-down card.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},inventiveMaker:{name:"Inventive Maker",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253313/HOO_INVENTIVE_MAKER_uzrbg1.png",fallbackImage:"/images/cards/HOO_INVENTIVE_MAKER.png",power:1,ability:`Deploy: Place the Recon Drone token in a free adjacent cell.
Support  Setup: Return a device card from the discard pile to your hand.`,flavorText:'- "Patience is a weapon. Vengeance is an art."',types:["Unit","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},finnMW:{name:"Finn, Most Wanted",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764637482/Finn_nehk0r.png",fallbackImage:"/images/cards/HOO_RECKLESS_PROVOCATEUR.png",power:2,ability:`Setup: Move any of your cards 1 or 2 cells.
Commit: Gain 1 point for each revealed card in opponents' hands.`,flavorText:"Catch me if you can. Spoiler: You can't.",types:["Unit","Hero","Hoods"],faction:"Hoods",allowedPanels:["DECK_BUILDER"]},faber:{name:"Faber",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253324/OPT_FABER_d7uxew.png",fallbackImage:"/images/cards/OPT_FABER.png",power:1,ability:"Deploy: Discard 1  Place the Walking Turret card in a free adjacent cell.",flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},censor:{name:"Censor",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253321/OPT_CENSOR_wtxtc2.png",fallbackImage:"/images/cards/OPT_CENSOR.png",power:2,ability:`Deploy: Exploit any card.
Support  Commit: Swap 1 of your exploits for 1 stun.`,flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},princeps:{name:"Princeps",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253332/OPT_PRINCEPS_w3o5lq.png",fallbackImage:"/images/cards/OPT_PRINCEPS.png",power:3,ability:`Deploy: Shield 1. Aim a card in its line.
Setup: Destroy the card with aim.`,flavorText:"Order is not requested. It is imposed.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},immunis:{name:"Immunis",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253327/OPT_IMMUNIS_bjlncl.png",fallbackImage:"/images/cards/OPT_IMMUNIS.png",power:2,ability:"Support  Deploy: Return your Optimate from the discard pile to an adjacent cell. At the end of the phase, return the Optimate for 2 stuns.",flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},centurion:{name:"Centurion",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253330/OPT_CENTURION_aaushl.png",fallbackImage:"/images/cards/OPT_CENTURION.png",power:2,ability:"Commit: Sacrifice an allied unit  All allied cards in its lines get +1 Power.",flavorText:"In the gilded halls of the Optimates, even the tools of war are works of art.",types:["Unit","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},luciusTheImmortal:{name:"Lucius, The Immortal",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764678954/Lucius_The_Immortal_z0lemw.png",fallbackImage:"/images/cards/OPT_PRINCEPS.png",power:3,ability:`Pass: Immune to Stun. If entered from discard, gets +2 Power.
Setup: Discard 1  Search your deck for a command card.`,flavorText:"Death implies a cessation of function. I have simply optimized it.",types:["Unit","Hero","Optimates"],faction:"Optimates",allowedPanels:["DECK_BUILDER"]},codeKeeper:{name:"Code Keeper",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253298/FUS_CODE_KEEPER_qotsym.png",fallbackImage:"/images/cards/FUS_CODE_KEEPER.png",power:2,ability:`Deploy: Exploit opponent cards with threat.
Support  Commit: Move opponent card with exploit 1 cell.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},devoutSynthetic:{name:"Devout Synthetic",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253305/FUS_DEVOUT_SYNTHETIC_bavg9k.png",fallbackImage:"/images/cards/FUS_DEVOUT_SYNTHETIC.png",power:3,ability:`Deploy: Push an adjacent card 1 cell. May take its place.
Setup: Destroy an adjacent card with threat or stun.`,flavorText:"Flesh is a bug. The Signal is the patch.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},unwaveringIntegrator:{name:"Unwavering Integrator",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253303/FUS_UNWAVERING_INTEGRATOR_emret1.png",fallbackImage:"/images/cards/FUS_UNWAVERING_INTEGRATOR.png",power:1,ability:`Deploy: Exploit any card.
Support  Setup: Gain 1 point for each of your exploits in the line.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},signalProphet:{name:"Signal Prophet",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253299/FUS_SIGNAL_PROPHET_nzd7w3.png",fallbackImage:"/images/cards/FUS_SIGNAL_PROPHET.png",power:2,ability:`Deploy: Exploit each of your cards with support.
Support  Commit: Move your card with your exploit 1 cell.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},zealousMissionary:{name:"Zealous Missionary",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253301/FUS_ZEALOUS_MISSIONARY_mfv9xl.png",fallbackImage:"/images/cards/FUS_ZEALOUS_MISSIONARY.png",power:1,ability:`Deploy: Exploit any card.
Support  Commit: Reduce the power of any card with your exploit by 1.`,flavorText:"The Signal is truth. All else is noise.",types:["Unit","Fusion"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},reverendOfTheChoir:{name:"Reverend of The Choir",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764678937/Reverend_of_The_Choir_vts8im.png",fallbackImage:"/images/cards/FUS_SIGNAL_PROPHET.png",power:2,ability:`Pass: Supports all your units in lines.
Setup: Exploit any card.`,flavorText:"The hum of the servers is a hymn to the initiated.",types:["Unit","Hero","Fusion","Device"],faction:"Fusion",allowedPanels:["DECK_BUILDER"]},overwatch:{name:"Overwatch",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253291/CMD_OVERWATCH_hrba9x.png",fallbackImage:"/images/cards/CMD_OVERWATCH.png",power:0,ability:` Aim 1 on any card. Reveal 1 opponent hand card for each of your Aim counters on the battlefield. 
 Aim 1 on any card. Draw 1 card for each of your Aim counters on the battlefield.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},tacticalManeuver:{name:"Tactical Maneuver",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253296/CMD_REPOSITIONING_m7k4kf.png",fallbackImage:"/images/cards/CMD_REPOSITIONING.png",power:0,ability:` Move your unit to an open cell in its line. Draw cards equal to the moved unit's Power. 
 Move your unit to an open cell in its line. Gain points equal to the moved unit's Power.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},inspiration:{name:"Inspiration",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763260942/CMD_INSPIRATION_nxifhu.png",fallbackImage:"/images/cards/CMD_INSPIRATION.png",power:0,ability:` Remove any number of non-Support/Threat counters from your unit. Draw 1 card for each counter removed. 
 Remove any number of non-Support/Threat counters from your unit. Gain 1 point for each counter removed.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},dataInterception:{name:"Data Interception",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253290/CMD_DATA_INTERCEPTION_ks4lcv.png",fallbackImage:"/images/cards/CMD_DATA_INTERCEPTION.png",power:0,ability:` Exploit 1 on any card. Reveal 1 opponent hand card for each of your Exploit counters on the battlefield. 
 Exploit 1 on any card. Move a unit with your Exploit up to 2 cells.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},falseOrders:{name:"False Orders",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763640484/CMD_FALSE_ORDERS_ghi01y.png",fallbackImage:"/images/cards/CMD_DATA_INTERCEPTION.png",power:0,ability:` Place 1 Exploit on an opponent's card. Then move an opponent's unit with your Exploit up to 2 cells. Reveal up to 2 cards from that opponent's hand. 
 Place 1 Exploit on an opponent's card. Then move an opponent's unit with your Exploit up to 2 cells. Stun the moved unit (2 Stun).`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},experimentalStimulants:{name:"Experimental Stimulants",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Experimental_Stimulants_x8ns1g.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Your unit on the battlefield may activate its Deploy ability an additional time.
 Move your unit to an open cell in a line.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},logisticsChain:{name:"Logistics Chain",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Logistics_Chain_d4irtq.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Gain points in a chosen diagonal. Gain 1 additional point for each of your cards with Support in that diagonal.
 Gain points in a chosen diagonal. Draw 1 card for each of your cards with Support in that diagonal.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},quickResponseTeam:{name:"Quick Response Team",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507609/Quick_Response_Team_rw2cut.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Deploy a unit from your hand to any empty cell.
 Search your deck for a unit card and put it into your hand.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},temporaryShelter:{name:"Temporary Shelter",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Temporary_Shelter_o0embx.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Place a shield on your card on the battlefield. Remove all aim from that card.
 Place a shield on your card on the battlefield. Move that card 1 or 2 cells.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},enhancedInterrogation:{name:"Enhanced Interrogation",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764507610/Enhanced_Interrogation_suzvxe.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:` Aim 1 on any card. Reveal 1 opponent hand card for each of your Aim counters on the battlefield.
 Aim 1 on any card. Move any card with your Aim counter 1 or 2 cells.`,types:["Command"],faction:"Command",allowedPanels:["DECK_BUILDER"]},mobilization1:{name:"Line Breach",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763894862/line_ocsoyj.png",fallbackImage:"/images/cards/CMD_MOBILIZATION.png",power:0,ability:"Gain points in a chosen line of the battlefield.",types:["Command"],faction:"Command",allowedPanels:[]},abrGawain:{name:'ABR "Gawain"',imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764626980/Autonomous_Battle_Robot_Gawain_uoyjm5.png",fallbackImage:"/images/cards/FUS_DEVOUT_SYNTHETIC.png",power:4,ability:`Deploy: Shield 1. Aim a card in its line.
Setup: Destroy the card with aim.`,flavorText:"Protocol initiated. Threat assessment: Extreme.",types:["Unit","Device","Rarity"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},reclaimedGawain:{name:'Reclaimed "Gawain"',imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622845/Reclaimed_Gawain_sg6257.png",fallbackImage:"/images/cards/FUS_DEVOUT_SYNTHETIC.png",power:4,ability:`Deploy: Shield 1. Push an adjacent card 1 cell. May take its place.
Setup: Destroy an adjacent card with threat or stun.`,flavorText:"Once a knight of the system, now a ghost in the machine.",types:["Unit","Device","Rarity"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},secretInformant:{name:"Secret Informant",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764767153/Secret_informant_eb0nkm.png",fallbackImage:"/images/cards/SYN_THREAT_ANALYST.png",power:1,ability:"Deploy: Look at the top 3 cards of any deck. Put any number of them on the bottom of their owner's deck. Draw a card.",flavorText:"Knowledge is power. And leverage.",types:["Unit"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},FalkPD:{name:"Michael Falk, Private Detective",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764623710/Michael_Falk_wcxjnp.png",fallbackImage:"/images/cards/HOO_VIGILANT_SPOTTER.png",power:3,ability:`Deploy: Search your deck for any card and put it into your hand.
Commit: Reveal 1 card from an opponent's hand or face-down card.`,flavorText:"He finds things. Sometimes things that should stay lost.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},edithByron:{name:"Edith Byron, Extreme Engineer",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764623710/Edith_Byron_v6691r.png",fallbackImage:"/images/cards/HOO_INVENTIVE_MAKER.png",power:3,ability:`Deploy: Shield 1. Place the Recon Drone token in a free adjacent cell.
Setup: Move this card to any cell in a line.`,flavorText:"Building the future, one explosion at a time.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},pinkunonekoSV:{name:"Pinkunoneko, Street Vigilante",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622844/Pinkunoneko_nhmjfv.png",fallbackImage:"/images/cards/SYN_RIOT_AGENT.png",power:3,ability:`Deploy: Create a stack of 1 Stun token. Valid targets are any opponent cards in adjacent cells.
Setup: Destroy an adjacent card with threat or stun. Then, you may move to an adjacent cell.`,flavorText:"Neon claws in the dark alley.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},EleftheriaMD:{name:'Maria "Eleftheria" Damanaki',imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622845/Maria_Eleftheria_Damanaki_bmx6xv.png",fallbackImage:"/images/cards/SYN_TACTICAL_AGENT.png",power:3,ability:`Deploy: Aim any card.
Setup: Destroy the card with aim.`,flavorText:"Freedom has a price. She collects it.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]},ziusIJ:{name:"Zius, Independent Journalist",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764622844/Zius_cwd92f.png",fallbackImage:"/images/cards/FUS_UNWAVERING_INTEGRATOR.png",power:2,ability:`Deploy: Exploit any card.
Support  Setup: Exploit any card. Gain 1 point for each of your exploits in that line.`,flavorText:"The truth is out there, and he's streaming it live.",types:["Unit","Hero"],faction:"Neutral",allowedPanels:["DECK_BUILDER"]}},hg={reconDrone:{baseId:"reconDrone",name:"Recon Drone",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253333/TKN_RECON_DRONE_esfknf.png",fallbackImage:"/images/cards/TKN_RECON_DRONE.png",power:1,ability:`Setup: Move to any cell.
Commit: You may reveal a card from the hand of your opponent who owns an adjacent card.`,flavorText:"SynchroTech has created lightweight drones to patrol the streets, but the Hoods have other plans for them.",color:"bg-gray-400",types:["Unit","Device"],allowedPanels:["TOKEN_PANEL"]},walkingTurret:{baseId:"walkingTurret",name:"Walking Turret",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253307/TKN_WALKING_TURRET_uq6owm.png",fallbackImage:"/images/cards/TKN_WALKING_TURRET.png",power:2,ability:`Deploy: Aim a card in its line.
Setup: -1 Power to any card with Aim.`,flavorText:"This military monster clearly has no place on the city streets.",color:"bg-gray-400",types:["Unit","Optimates","Device"],allowedPanels:["TOKEN_PANEL"]}},yg={Aim:{name:"Aim",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/Aim_dcct45.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
This card is easier to destroy.`,sortOrder:1,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},Exploit:{name:"Exploit",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/Exploit_foomty.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
Hacker and programmer cards will have a greater effect on this card.`,sortOrder:2,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},LastPlayed:{name:"LastPlayed",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/LastPlayed_bfkbwb.png",description:"This card was last played by its owner.",sortOrder:99,allowedPanels:[],allowedTargets:["board"]},Revealed:{name:"Revealed",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478811/Revealed_w1gbe7.png",description:"This card's face is visible to the owner of the counter revealed. Can be placed on cards in hand.",sortOrder:7,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board","hand"]},Stun:{name:"Stun",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478811/Stun_cwqroz.png",description:`A stunned card cannot activate abilities or gain points. Its owner's effects cannot move it, but opponent effects can.
Remove 1 stun counter from the card after the Scoring Phase.`,sortOrder:4,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},Shield:{name:"Shield",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/Shield_z9sjr1.png",description:"If an effect attempts to destroy this card, remove 1 shield counter from it instead.",sortOrder:3,allowedPanels:["COUNTER_PANEL"],allowedTargets:["board"]},Support:{name:"Support",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478809/Support_ui9qpl.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
This card is adjacent to its ally.`,sortOrder:5,allowedPanels:[],allowedTargets:["board"]},Threat:{name:"Threat",imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478809/Threat_i1pbko.png",description:`This counter has no effect on its own, but it can modify the abilities of cards.
This card is surrounded and pinned to the edge of the battlefield by an opponent's cards.`,sortOrder:6,allowedPanels:[],allowedTargets:["board"]},Resurrected:{name:"Resurrected",imageUrl:"",description:"This unit recently returned from the discard pile. It will become Stunned at the start of the next phase.",sortOrder:8,allowedPanels:[],allowedTargets:[]},"Power+":{name:"Power+",imageUrl:"",description:"Increases the power of the card by 1.",sortOrder:10,allowedPanels:[],allowedTargets:["board","hand","deck","discard"]},"Power-":{name:"Power-",imageUrl:"",description:"Decreases the power of the card by 1.",sortOrder:11,allowedPanels:[],allowedTargets:["board","hand","deck","discard"]}},gg=[{id:"SynchroTech",name:"SynchroTech",isSelectable:!0,cards:[{cardId:"mrPearlDoF",quantity:1},{cardId:"EleftheriaMD",quantity:1},{cardId:"abrGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"ipDeptAgent",quantity:3},{cardId:"tacticalAgent",quantity:3},{cardId:"patrolAgent",quantity:3},{cardId:"riotAgent",quantity:3},{cardId:"threatAnalyst",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]},{id:"Hoods",name:"Hoods",isSelectable:!0,cards:[{cardId:"finnMW",quantity:1},{cardId:"pinkunonekoSV",quantity:1},{cardId:"reclaimedGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"recklessProvocateur",quantity:3},{cardId:"dataLiberator",quantity:3},{cardId:"cautiousAvenger",quantity:3},{cardId:"vigilantSpotter",quantity:3},{cardId:"inventiveMaker",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]},{id:"Optimates",name:"Optimates",isSelectable:!0,cards:[{cardId:"luciusTheImmortal",quantity:1},{cardId:"FalkPD",quantity:1},{cardId:"abrGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"faber",quantity:3},{cardId:"censor",quantity:3},{cardId:"princeps",quantity:3},{cardId:"immunis",quantity:3},{cardId:"centurion",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]},{id:"Fusion",name:"Fusion",isSelectable:!0,cards:[{cardId:"reverendOfTheChoir",quantity:1},{cardId:"ziusIJ",quantity:1},{cardId:"reclaimedGawain",quantity:1},{cardId:"secretInformant",quantity:2},{cardId:"devoutSynthetic",quantity:3},{cardId:"unwaveringIntegrator",quantity:3},{cardId:"signalProphet",quantity:3},{cardId:"zealousMissionary",quantity:3},{cardId:"codeKeeper",quantity:3},{cardId:"overwatch",quantity:1},{cardId:"tacticalManeuver",quantity:1},{cardId:"inspiration",quantity:1},{cardId:"dataInterception",quantity:1},{cardId:"falseOrders",quantity:1},{cardId:"experimentalStimulants",quantity:1},{cardId:"logisticsChain",quantity:1},{cardId:"quickResponseTeam",quantity:1},{cardId:"temporaryShelter",quantity:1},{cardId:"enhancedInterrogation",quantity:1}]}],fc={cardDatabase:mg,tokenDatabase:hg,countersDatabase:yg,deckFiles:gg};let pc=null,Ur=new Map,Ll=new Map,mc={},zi=[],hc={};const Up=new Set(["overwatch","repositioning","tacticalManeuver","mobilization","inspiration","dataInterception","falseOrders","experimentalStimulants","logisticsChain","quickResponseTeam","temporaryShelter","enhancedInterrogation"]);async function vg(){try{let e;try{const t=await fetch("/api/content/database");if(t.ok){const n=await t.json(),r=n.cards.map(([a,s])=>[a,s]),o=n.tokens.map(([a,s])=>[a,s]);e={cardDatabase:Object.fromEntries(r),tokenDatabase:Object.fromEntries(o),countersDatabase:Object.fromEntries(n.counters),deckFiles:n.deckFiles}}else e=fc}catch{e=fc}pc=e,Ur=new Map(Object.entries(e.cardDatabase)),Ll=new Map(Object.entries(e.tokenDatabase)),mc=e.countersDatabase,zi=e.deckFiles,Zr=pc,Fp=Ur,Bp=Ll,Gr=mc,wg=zi,hc=xg(),Ui=hc}catch(e){throw console.error("Failed to load content database:",e),e}}function xg(){const e={};for(const t of zi){const n=[];for(const r of t.cards){const o=Ur.get(r.cardId);if(!o){console.warn(`Card definition not found for ID: ${r.cardId} in deck: ${t.name}`);continue}const a=Up.has(r.cardId);for(let s=0;s<r.quantity;s++){const c=r.cardId.replace(/-/g,"--DASH--").toUpperCase();a?n.push({...o,deck:Be.Command,id:`CMD_${c}_${s+1}`,baseId:r.cardId,faction:o.faction||"Command"}):n.push({...o,deck:t.id,id:`${t.id.substring(0,3).toUpperCase()}_${c}_${s+1}`,baseId:r.cardId,faction:o.faction||t.id})}}e[t.id]=n}return e[Be.Tokens]=Array.from(Ll.entries()).map(([t,n])=>{const r=n.types?[...n.types]:[];return{id:`TKN_${n.name.toUpperCase().replace(/\s/g,"_")}`,baseId:t,deck:Be.Tokens,name:n.name,imageUrl:n.imageUrl,fallbackImage:n.fallbackImage,power:n.power,ability:n.ability,color:n.color,types:r,flavorText:n.flavorText,faction:"Tokens"}}),e}let Zr=null,Fp=new Map,Bp=new Map,Gr={},wg=[],Ui={};const pi=Up,Gp=()=>zi.filter(e=>e.isSelectable);function Fi(e){return Ur.get(e)}function Ls(e){return Array.from(Ur.values()).find(t=>t.name===e)}function kg(){return Array.from(Ur.entries()).map(([e,t])=>({id:e,card:t}))}function Ml(){return Ur}const Vp=4,yc={FIRST_PLAYER:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763478810/LastPlayed_bfkbwb.png",ROUND_WIN_MEDAL:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764252181/medal_rgbw8d.png"},zl={[Be.SynchroTech]:{prefix:"SYN",color:"border-cyan-400"},[Be.Hoods]:{prefix:"HOO",color:"border-purple-500"},[Be.Optimates]:{prefix:"OPT",color:"border-red-500"},[Be.Fusion]:{prefix:"FUS",color:"border-green-400"},[Be.Command]:{prefix:"CMD",color:"border-yellow-500"},[Be.Tokens]:{prefix:"TKN",color:"border-gray-400"},[Be.Custom]:{prefix:"CUS",color:"border-purple-400"},[Be.Neutral]:{prefix:"NEU",color:"border-gray-400"}},Vt={blue:{bg:"bg-blue-600",border:"border-blue-600",outline:"outline-blue-600",glow:"shadow-[0_0_15px_#2563eb]"},purple:{bg:"bg-purple-600",border:"border-purple-600",outline:"outline-purple-600",glow:"shadow-[0_0_15px_#9333ea]"},red:{bg:"bg-red-600",border:"border-red-600",outline:"outline-red-600",glow:"shadow-[0_0_15px_#dc2626]"},green:{bg:"bg-green-600",border:"border-green-600",outline:"outline-green-600",glow:"shadow-[0_0_15px_#16a34a]"},yellow:{bg:"bg-yellow-500",border:"border-yellow-500",outline:"outline-yellow-500",glow:"shadow-[0_0_15px_#eab308]"},orange:{bg:"bg-orange-500",border:"border-orange-500",outline:"outline-orange-500",glow:"shadow-[0_0_15px_#f97316]"},pink:{bg:"bg-pink-500",border:"border-pink-500",outline:"outline-pink-500",glow:"shadow-[0_0_15px_#ec4899]"},brown:{bg:"bg-[#8B4513]",border:"border-[#8B4513]",outline:"outline-[#8B4513]",glow:"shadow-[0_0_15px_#8B4513]"}},bg={blue:{r:37,g:99,b:235},purple:{r:147,g:51,b:234},red:{r:220,g:38,b:38},green:{r:22,g:163,b:74},yellow:{r:234,g:179,b:8},orange:{r:249,g:115,b:22},pink:{r:236,g:72,b:153},brown:{r:139,g:69,b:19}},gc={blue:"text-blue-400 drop-shadow-[0_0_4px_rgba(59,130,246,0.8)]",purple:"text-purple-400 drop-shadow-[0_0_4px_rgba(168,85,247,0.8)]",red:"text-red-500 drop-shadow-[0_0_4px_rgba(239,68,68,0.8)]",green:"text-green-400 drop-shadow-[0_0_4px_rgba(34,197,94,0.8)]",yellow:"text-yellow-400 drop-shadow-[0_0_4px_rgba(234,179,8,0.8)]",orange:"text-orange-400 drop-shadow-[0_0_4px_rgba(249,115,22,0.8)]",pink:"text-pink-400 drop-shadow-[0_0_4px_rgba(236,72,153,0.8)]",brown:"text-[#A0522D] drop-shadow-[0_0_4px_rgba(139,69,19,0.8)]"},Cg=["blue","purple","red","green","yellow","orange","pink","brown"],Ul=["Setup Phase","Main Phase","Commit Phase"],Za=()=>Object.fromEntries(Object.entries(Gr).map(([e,t])=>[e,t.imageUrl])),Eo=new Proxy({},{get(e,t){return Za()[t]},ownKeys(){return Object.keys(Za())},has(e,t){return t in Za()},getOwnPropertyDescriptor(e,t){const n=Za()[t];return n!==void 0?{enumerable:!0,configurable:!0,value:n}:void 0}}),Qa=()=>Object.fromEntries(Object.entries(Gr).map(([e,t])=>[e,t.description])),Bi=new Proxy({},{get(e,t){return Qa()[t]},ownKeys(){return Object.keys(Qa())},has(e,t){return t in Qa()},getOwnPropertyDescriptor(e,t){const n=Qa()[t];return n!==void 0?{enumerable:!0,configurable:!0,value:n}:void 0}}),Hp=()=>Object.entries(Gr).filter(([,e])=>!e.allowedPanels||e.allowedPanels.includes("COUNTER_PANEL")).sort(([,e],[,t])=>e.sortOrder-t.sortOrder).map(([e,t])=>({type:e,label:t.name}));Hp();const Xa=e=>{const t=[...e];for(let n=t.length-1;n>0;n--){const r=Math.floor(Math.random()*(n+1));[t[n],t[r]]=[t[r],t[n]]}return t},Tg=(e,t)=>{const n={bold:["deploy","setup","commit","support","pass","pas"],italic:["threat","aim","exploit","stun","shield","gain","point","points","reveal","move","draw","push","sacrifice","discard"]};return e.split(/(\s+|[.,:()])/).map((o,a)=>{if(!o)return null;const s=o.replace(/[.,:()]/g,"").toLowerCase(),l=n.bold.find(d=>d.toLowerCase()===s),c=n.italic.find(d=>d.toLowerCase()===s);if(l){const d=t[l]||o;return dr.createElement("strong",{key:a,className:"text-white"},d)}if(c){const d=t[c]||o;return dr.createElement("em",{key:a,className:"text-white italic font-semibold"},d)}return o})},Fd=(e,t)=>e?e.split(`
`).map((n,r)=>{const o=[];return r>0&&o.push(dr.createElement("br",{key:`br-${r}`})),o.push(...Tg(n,t)),dr.createElement(dr.Fragment,{key:r},...o.filter(Boolean))}):"",Eg={abilityKeywords:{deploy:"",setup:"",commit:"",support:"",threat:"",pass:"",aim:"",exploit:"",stun:"",shield:"",gain:"",point:"",points:"",reveal:"",move:"",draw:"",push:"",sacrifice:"",discard:""},cardTypes:{unit:"",command:"",hero:"",rarity:"",structure:"",gear:"",event:"",attachment:""},ui:{startGame:" ",joinGame:"",deckBuilding:" ",rules:"  ",settings:"",language:"",serverAddress:" ",saveApply:"",cancel:"",close:"",tokens:"",counters:"",phase:"",scoring:"...",autoAbility:"-",autoDraw:"-",newGame:" ",exit:"",surrender:"",mode:"",size:"",dummies:"",spectatorMode:" ",spectatorMsg:"   .",readyCheck:" ?",imReady:" ",waiting:"...",cancelStart:"",assignTeams:" ",confirmTeams:"  ",unassigned:"",team:"",deck:"",discard:"",showcase:"",customDeck:" ",loadDeck:"",clear:"",save:"",filter:"",currentDeck:" ",emptyDeck:"  .",clickToAdd:"   ,   .",view:"",play:"",playFaceDown:"  ",toHand:" ",toDiscard:" ",revealToAll:" ",requestReveal:" ",flipUp:"",flipDown:" ",connected:"",disconnected:"",hiddenGameTooltip:"      ''",gameOver:" ",roundComplete:" ",winner:"",roundWinner:" ",move:"",moveToBottom:" ",selectCard:" ",deckView:"",topDeckView:" ",discardView:"",selectFromDeck:"   ",selectFromDiscard:"   ",power:"",owner:"",noDescription:" ",comingSoon:"",revealed:"",reconnecting:"...",error:"",loading:"...",create:"",createGame:" ",gameCode:" ",playerName:" ",join:"",back:"",customGame:" ",privateGame:" ",publicGame:" ",freeForAll:"   ",teamBattle:" ",startingPlayer:" ",turn:"",round:"",score:"",hand:"",announced:"",effects:"",status:"",deploy:"",ability:"",recover:"",resurrect:"",destroy:"",returnToHand:"  ",shuffle:"",drawCard:" ",drawStartingHand:"   (6)",viewTopCards:"  ",highlight:"",highlightCell:" ",highlightRow:" ",highlightColumn:" ",emptyHand:" ",hidden:"",newAvalon:"New Avalon",cards:"",scorePoints:"",toWinRound:"   .",checkedAtFirstPlayer:"     .",roundVictoryCondition:"   ",reach:"",ffa:"FFA",team2v2:"2v2",team3v1:"3v1",drawCards:" ",activeGames:" ",noActiveGames:"   .",createOne:"    ?",orJoinWithCode:"   ",enterGameId:" ID ",dragToReorder:"   .",rightClickForActions:"   .",deckEmpty:" .",done:"",remove:"",toDeckTop:" ",toDeckBottom:" ",storyMode:" ",puzzles:"",changeColor:" ",firstPlayer:" ",activePlayer:" ",clearSearch:" ",resetPowerFilter:"  ",clearTypes:" ",resetFaction:" ",removeOne:" ",waitingForOthers:"  ",deckNamePlaceholder:" ",searchPlaceholder:" ...",myCustomDeck:" ",untitledDeck:" ",max1RarityHero:" 1 (/)",max2Command:" 2 ()",finalRoundMaxTurns:" !  10 .",max5Rounds:" 5 .",noTarget:" ",confirmClearDeck:" ,     ?",selectCardFromDeck:"   ",selectCardFromDiscard:"   ",languageDisabled:"     .",autoAbilitiesTooltip:"-:    ",autoDrawTooltip:"-:     (6     +    Setup)",endedOnTurn:"  ",nextRound:":",victoryCondition:" :",win2RoundsMatch:"*   2 ,   . ",max5RoundsInfo:" 5 .",matchComplete:" ",thankYouPlaying:"    New Avalon: Skirmish.",returnToMenu:"  ",continueGame:" ",startRound:" ",youLabel:"()",readyToStart:" ?",gameWillBegin:" ,     .        .",dragCardsReorder:"    .  ,      .",dragOutsideAnotherZone:" ,      .",ready:"",dragOutsideToMove:" ,      .",empty:"",dragOutsideToPlaceToken:" ,     .",holdRightClickViewHints:"      "},rules:{title:'  "New Avalon: Skirmish"',conceptTitle:"I.  ",conceptText:`**   :** New Avalon: Skirmish      ,      -.      ,            .

**:**         ,      .        (),       .`,winConditionTitle:"II.  ",winConditionText:`**   :**    2   . ,   2   ,   .
**   :**         2    ,     .

**    (   ):**  ,            (),    5- .
** :**    5     .     ,   5-       .

** :**
-  1: 20   ().
-  2: 30   ().
-  3  :    +10     (,  3  40 ).

**    :**    ,   ,         .
**   :**               ,     .`,fieldTitle:"III.    ",fieldText:`**  ():**     ,        .
** :**
- 2 :  5x5 .
- 3 :  6x6 .
- 4 :  7x7 .

** :**
- **:**       .      (Scoring).
- **:**         ().    ,      .

**:**       ,   :
- ** (Units):**   ,   (Power)  .      .
- ** (Commands):**   . ,   (   "2  3 ")    .

** :**
- ** (Hand):** ,   .
- ** (Discard):** ,       .
- ** (Showcase/Announced):**  ,       .`,setupTitle:"IV.   ()",setupText:`** :**              (  30 ).
**:**    .

** :**    6    ,   .
**  :**      .

**:**   ,    (6 ),    1                 .

**  :**        (,  ).
**:**   ,    .          Setup.`,abilitiesTitle:"V.  ",abilitiesText:`** :**
- **Deploy:**    ,         .
- **Setup:**      Setup    (  ),         .
- **Commit:**      Commit   ,         .
- ** ():**   ,        .

**  ():**
   ,   (, **Support  Deploy:** ...).
-   "   ".
-      (,   Support)     ,  ** ** .

** :**
- **Stun:**   (  Stun) ** **   ( Deploy,  ,  ).
- **Face-down:** ,   ,   .
- **:**    ( ),  ****   ,    .    ,    ().`,statusesTitle:"VI.   ()",statusesText:`          .    Stun         .

** (Support):**    Support,        (   )   .
** Stun/Support:** ,   Stun,     Support   .
**:**  Support       ,   Support  [].

** (Threat):**    Threat,      ,   .
** :**  Threat      :
1. **:**          (    ).
2. **:**               .
** Stun/Threat:** ,   Stun,     Threat   .
**:**   Threat         .`,countersTitle:"VII.  (Counters)",countersText:`    ,   .       ,         .

** (Stun):**
- **:**   Stun       Scoring,             (    ).
- **:**    Commit        1  Stun.

** (Shield):**
- **:**     (Destroy)  ,   ,       1  .    .

** (Revealed)    (Face-down):**
- **Revealed:**  -      .
- ** Face-down:** ,    (Face-down),        0 .      Revealed,   ()   ,     Face-down     (, ).

**  (Aim, Exploit):**
- **Aim ()  Exploit ():**         (,   ).        .

**  (Last Played):**
- **:**  ,    ,         .    ,        (Scoring).`,turnTitle:"VIII.    ",turnText:`     .        .        :

**1.  Setup ():**
- ** :**    1     .
- **:**          **Setup:**.
**:**          .

**2.  Main ( / ):**
- ** :**        :
  -    (**Deploy:**)       .      Deploy: .
  -     .
  - .
** :**            ,     .

**3.  Commit ( / ):**
- **:**          **Commit:**.
- ** Stun:**            1  Stun.
**:**           .

**4.  Scoring ( ):**
- ** :**       (  ),        **Last Played**.
- **:**         ,        .`,mechanicsTitle:"IX.     ",mechanicsText:`**Stun   :**
- **:**    Stun   Face-down  0    Scoring,      ,      ,   (, Spotter).

**  Last Played:**
- **:**     Last Played    (,   /)   Scoring,        (,   Last Played   ).
- **:**    Last Played    ,        Scoring.
- **:**          Last Played,            .

**  (Push, Swap):**
- **Push ():**        .   ( ),         .      .
- **Swap ():**     ,     .

** (Resurrect):**
- ** "":** ,       (),    **Resurrected**   Deploy.     (  )   ,      Stun.`,creditsTitle:"X.  ",creditsText:`**:** Nikita Anahoret

**:**
- Google AI Studio
- Gemini
- ChatGPT

** :**
- Vasilisa Versus
- Kirill Tomashchuk
- Andrey Markosov
-  

       Telegram  Discord.
       DonationAlerts  Patreon.`},counters:{Aim:{name:"",description:`       ,     .
   .`},Exploit:{name:"",description:`       ,     .
          .`},LastPlayed:{name:"",description:"      ."},Revealed:{name:"",description:"      revealed.      ."},Stun:{name:"",description:`        .       ,    .
 1         (Scoring).`},Shield:{name:"",description:"     ,      1  ."},Support:{name:"",description:`       ,     .
     .`},Threat:{name:"",description:`       ,     .
         .`},"Power+":{name:"+",description:"    1."},"Power-":{name:"-",description:"    1."}},deckNames:{SynchroTech:"",Hoods:"",Optimates:"",Fusion:""},cards:{ipDeptAgent:{name:"  IP",ability:`Deploy:  2 Stun   Exploit.
Support  Commit:    (Revealed)    .`,flavorText:'- "   .  .     ."'},tacticalAgent:{name:" ",ability:`Deploy: Aim    Threat.
Setup:    Aim.`,flavorText:'- "  !   SynchroTech!"'},patrolAgent:{name:" ",ability:`Setup:        .
Commit: Stun     Threat.`,flavorText:",    .  ,     ."},riotAgent:{name:" ",ability:`Deploy:     1 .    .
Commit: Stun     Threat.`,flavorText:'- ", !     SynchroTech."'},threatAnalyst:{name:" ",ability:`Deploy: Exploit   .
Support  Commit:  1     Exploit   .`,flavorText:""},recklessProvocateur:{name:" ",ability:`Deploy:       .
Commit:            .`,flavorText:'- "   .    ."'},dataLiberator:{name:" ",ability:`Deploy: Exploit   .
Support  Pass:     Exploit   .`,flavorText:'- "    .   ."'},cautiousAvenger:{name:" ",ability:`Deploy: Aim    .
Support  Setup:    Aim.`,flavorText:'- "   .    ."'},vigilantSpotter:{name:" ",ability:`Support  Pass:   (Revealed)     ,  2 .
Commit:  1    .`,flavorText:'- "   .    ."'},inventiveMaker:{name:" ",ability:`Deploy:       .
Support  Setup:       .`,flavorText:'- "   .    ."'},faber:{name:"",ability:"Deploy: Discard 1         .",flavorText:"         ."},censor:{name:"",ability:`Deploy: Exploit   .
Support  Commit:  1  Exploit  1 Stun.`,flavorText:"         ."},princeps:{name:"",ability:`Deploy: Shield 1. Aim      .
Setup:    Aim.`,flavorText:"  .  ."},immunis:{name:"",ability:"Support  Deploy:        .       2 Stun.",flavorText:"         ."},centurion:{name:"",ability:"Commit:   .          1.",flavorText:"         ."},codeKeeper:{name:" ",ability:`Deploy: Exploit     Threat.
Support  Commit:     Exploit  1 .`,flavorText:"   .    ."},devoutSynthetic:{name:" ",ability:`Deploy:     1 .    .
Setup:     Threat  Stun.`,flavorText:"   .    ."},unwaveringIntegrator:{name:" ",ability:`Deploy: Exploit   .
Support  Setup:  1     Exploit  .`,flavorText:"   .    ."},signalProphet:{name:" ",ability:`Deploy: Exploit      Support.
Support  Commit:      Exploit  1 .`,flavorText:"   .    ."},zealousMissionary:{name:" ",ability:`Deploy: Exploit   .
Support  Commit:       Exploit  1.`,flavorText:"   .    ."},overwatch:{name:"",ability:` Aim 1   .  1        Aim   .
 Aim 1   .  1     Aim   .`},tacticalManeuver:{name:" ",ability:`        .  ,    .
        .  ,    .`},inspiration:{name:"",ability:`       .  1     .
       .  1     .`},dataInterception:{name:" ",ability:` Exploit 1   .  1        Exploit   .
 Exploit 1   .     Exploit  1  2 .`},falseOrders:{name:" ",ability:`  1 Exploit   .       Exploit (. 2).   2    .
  1 Exploit   .       Exploit (. 2).  2 Stun  .`},experimentalStimulants:{name:" ",ability:`          Deploy   .
        .`},logisticsChain:{name:" ",ability:`     .  1        Support   .
     .  1       Support   .`},quickResponseTeam:{name:"  ",ability:`        .
           .`},temporaryShelter:{name:" ",ability:`  Shield      .   Aim   .
  Shield      .     1  2 .`},enhancedInterrogation:{name:"  ",ability:` Aim 1   .  1        Aim   .
 Aim 1   .      Aim  1  2 .`},mobilization1:{name:" ",ability:"      ."},mobilization2:{name:" ",ability:"      ."},mobilization3:{name:" ",ability:"   4   ."},reconDrone:{name:"",ability:`Setup:    .
Commit:       ,    .`,flavorText:"SynchroTech      ,   Hoods    ."},walkingTurret:{name:" ",ability:`Deploy: Aim      .
Setup: - 1      .`,flavorText:"        ."},reclaimedGawain:{name:' ""',ability:`Deploy: Shield 1.     1 .    .
Setup:     Threat  Stun.`,flavorText:"-  ,    ."},FalkPD:{name:" ,  ",ability:`Deploy:           .
Commit:  1    .`,flavorText:"  .  ,    ."},edithByron:{name:" ,  ",ability:`Deploy: Shield 1.       .
Setup:        .`,flavorText:" ,    ."},pinkunonekoSV:{name:",  ",ability:`Deploy:    1  Stun.   -      .
Setup:     Threat  Stun.       .`,flavorText:"    ."},EleftheriaMD:{name:' "" ',ability:`Deploy: Aim   .
Setup:    Aim.`,flavorText:"   .   ."},ziusIJ:{name:",  ",ability:`Deploy: Exploit   .
Support  Setup: Exploit   .  1     Exploit   .`,flavorText:" - ,     ."},abrGawain:{name:' ""',ability:`Deploy: Shield 1. Aim      .
Setup:    Aim.`,flavorText:" .  : ."},reverendOfTheChoir:{name:" ",ability:`Pass:  Support     .
Setup: Exploit   .`,flavorText:"      ."},mrPearlDoF:{name:" ,  Bio-Synch",ability:`Pass:       +1  .
Deploy:          .`,flavorText:"   ,   ."},finnMW:{name:",  ",ability:`Setup:      1  2 .
Commit:  1        .`,flavorText:" ,  . :   ."},luciusTheImmortal:{name:", ",ability:`Pass:   Stun.    ,  +2 .
Setup: Discard 1            .`,flavorText:"   .    ."},secretInformant:{name:" ",ability:"Deploy:  3    .         .  .",flavorText:" - .   ."}}},Sg={abilityKeywords:{deploy:"Deploy",setup:"Setup",commit:"Commit",support:"Podrka",threat:"Pretnja",pass:"Pass",aim:"Nianjenje",exploit:"Exploit",stun:"Ogluenje",shield:"tit",gain:"Dobij",point:"Bod",points:"Bodova",reveal:"Otkrij",move:"Pomeri",draw:"Vuci",push:"Gurni",sacrifice:"rtvuj",discard:"Baci"},cardTypes:{unit:"Jedinica",command:"Komanda",hero:"Heroj",rarity:"Retkost",structure:"Struktura",gear:"Oprema",event:"Dogaaj",attachment:"Dodatak"},ui:{startGame:"Zaponi igru",joinGame:"Pridrui se",deckBuilding:"Graditelj pila",rules:"Pravila i uputstvo",settings:"Podeavanja",language:"Jezik",serverAddress:"Adresa servera",saveApply:"Sauvaj",cancel:"Otkai",close:"Zatvori",tokens:"Tokeni",counters:"Brojai",phase:"Faza",scoring:"BODOVANJE...",autoAbility:"Auto-sposobnost",autoDraw:"Auto-drovanje",newGame:"Nova igra",exit:"Izlaz",surrender:"Predaj se",mode:"Reim",size:"Veliina",dummies:"Lutke",spectatorMode:"Reim posmatraa",spectatorMsg:"Posmatrate igru.",readyCheck:"Spremni za poetak?",imReady:"Spreman sam",waiting:"ekanje...",cancelStart:"Otkai poetak",assignTeams:"Dodeli timove",confirmTeams:"Potvrdi timove i zaponi",unassigned:"Nedodeljene igrae",team:"Tim",deck:"PIL",discard:"BAENI",showcase:"Izlog",customDeck:"Prilagoeni pil",loadDeck:"Uitaj",clear:"Obrii",save:"Sauvaj",filter:"Filter",currentDeck:"Trenutni pil",emptyDeck:"Va pil je prazan.",clickToAdd:"Kliknite na karte sa leve strane da biste ih dodali.",view:"Pogledaj",play:"Igraj",playFaceDown:"Igraj zatvoreno",toHand:"U ruku",toDiscard:"U baene",revealToAll:"Otkrij svima",requestReveal:"Zatrai otkrivanje",flipUp:"Okreni licem nagore",flipDown:"Okreni licem nadole",connected:"Povezano",disconnected:"Prekinuta veza",hiddenGameTooltip:"Skrivene igre se ne pojavljuju na listi 'Pridrui se'",gameOver:"Kraj igre",roundComplete:"Runda zavrena",winner:"Pobednik",roundWinner:"Pobednik runde",move:"Pomeri",moveToBottom:"Pomeri na dno",selectCard:"Izaberi kartu",deckView:"pil",topDeckView:"Vrh pila",discardView:"Baene karte",selectFromDeck:"Izaberi kartu iz pila",selectFromDiscard:"Izaberi kartu iz baenih",power:"Snaga",owner:"Vlasnik",noDescription:"Nema opisa",comingSoon:"Uskoro",revealed:"Otkriveno",reconnecting:"Povezivanje...",error:"Greka",loading:"Uitavanje...",create:"Kreiraj",createGame:"Kreiraj igru",gameCode:"Kod igre",playerName:"Ime igraa",join:"Pridrui se",back:"Nazad",customGame:"Prilagoena igra",privateGame:"Privatna igra",publicGame:"Javna igra",freeForAll:"Svi protiv svih",teamBattle:"Timska borba",startingPlayer:"Poetni igra",turn:"Potez",round:"Runda",score:"Rezultat",hand:"RUKA",announced:"NAJAVLJENO",effects:"Efekti",status:"Status",deploy:"Razmesti",ability:"Sposobnost",recover:"Oporavi",resurrect:"Vaskrsi",destroy:"Uniti",returnToHand:"Vrati u ruku",shuffle:"Promeaj",drawCard:"Vuci kartu",drawStartingHand:"Vuci poetnu ruku (6)",viewTopCards:"Pogledaj gornje karte",highlight:"Istakni",highlightCell:"Istakni eliju",highlightRow:"Istakni red",highlightColumn:"Istakni kolonu",emptyHand:"Isprazni ruku",hidden:"Skriveno",newAvalon:"New Avalon",cards:"Karata",scorePoints:"bodova",toWinRound:"za pobedu u rundi.",checkedAtFirstPlayer:"Proverava se u fazi postavljanja prvog igraa.",roundVictoryCondition:"Uslov pobede u rundi",reach:"Dostigni",ffa:"Svi protiv svih",team2v2:"2 protiv 2",team3v1:"3 protiv 1",drawCards:"Vuci karte",activeGames:"Aktivne igre",noActiveGames:"Nema aktivnih igara.",createOne:"Zato ne biste kreirali jednu?",orJoinWithCode:"Ili se pridruite kodom",enterGameId:"Unesite ID igre",dragToReorder:"Prevucite za reanje.",rightClickForActions:"Desni klik za radnje.",deckEmpty:"pil je prazan.",done:"Gotovo",remove:"Ukloni",toDeckTop:"Na vrh pila",toDeckBottom:"Na dno pila",storyMode:"Reim prie",puzzles:"Slagalice",changeColor:"Promeni boju",firstPlayer:"Prvi igra",activePlayer:"Aktivan igra",clearSearch:"Obrii pretragu",resetPowerFilter:"Resetuj filter snage",clearTypes:"Obrii tipove",resetFaction:"Resetuj frakciju",removeOne:"Ukloni jednu",waitingForOthers:"ekanje na ostale...",deckNamePlaceholder:"Naziv pila",searchPlaceholder:"Pretraga...",myCustomDeck:"Moj prilagoeni pil",untitledDeck:"Bezimeni pil",max1RarityHero:"Maksimum 1 (Retkost/Heroj)",max2Command:"Maksimum 2 (Komanda)",finalRoundMaxTurns:"Konana runda! Maksimum 10 poteza.",max5Rounds:"Maksimum 5 rundi.",selectCardFromDeck:"Izaberi kartu iz pila",selectCardFromDiscard:"Izaberi kartu iz baenih",noTarget:"Nema cilja",confirmClearDeck:"Da li ste sigurni da elite da obriete trenutni pil?",languageDisabled:"Izbor jezika je trenutno onemoguen.",autoAbilitiesTooltip:"Auto-sposobnosti: Omoguite automatsku aktivaciju sposobnosti",autoDrawTooltip:"Auto-deljenje: Omoguite automatsko deljenje karata (6 karata u poetnoj ruci + deljenje u Setup fazi)",endedOnTurn:"Zavreno u potezu",nextRound:"Sledee:",victoryCondition:"Uslov pobede:",win2RoundsMatch:"* Pobedite u 2 rund da biste osvojili me. ",max5RoundsInfo:"Maksimum 5 rundi.",matchComplete:"Me zavren",thankYouPlaying:"Hvala to ste igrali New Avalon: Skirmish.",returnToMenu:"Povratak u meni",continueGame:"Nastavi igru",startRound:"Zaponi rundu",youLabel:"(Vi)",readyToStart:"Spremni za poetak?",gameWillBegin:"Igra e poeti kada svi igrai budu spremni. I dalje moete promeniti ime i pil.",dragCardsReorder:"Prevucite karte za reanje. Prevucite napolje da biste premestili kartu u drugu zonu.",dragOutsideAnotherZone:"Prevucite napolje da biste premestili kartu u drugu zonu.",ready:"Spreman",dragOutsideToMove:"Prevucite napolje da biste premestili kartu u drugu zonu.",empty:"Prazno",dragOutsideToPlaceToken:"Prevucite napolje da biste postavili token na tablu.",holdRightClickViewHints:"Drite desni taster za prikaz saveta"},rules:{title:'Pravila igre "New Avalon: Skirmish"',conceptTitle:"I. Osnovni Koncept",conceptText:`**anr i uloga igraa:** New Avalon: Skirmish je dinamika taktika kartaka igra koja se odvija na ogranienom mreastom polju. Igrai preuzimaju uloge voa frakcija, rasporeujui Jedinice i Komande kako bi preuzeli kontrolu nad kljunim linijama bojita.

**Objanjenje:** Igra se fokusira na pozicionu kontrolu i vreme aktiviranja sposobnosti, a ne samo na direktan napad. Pobeda se postie ostvarivanjem Poena Za Pobedu (PZP), koji se baziraju na snazi jedinica u izabranim linijama.`,winConditionTitle:"II. Uslovi za pobedu",winConditionText:`**Uslovi za pobedu u meu:** Me se igra do 2 pobede u rundama. Igra koji prvi ostvari 2 pobede u rundama, odmah pobeduje me.
**Objanjenje nereenog:** ako se po zavretku bilo koje runde vie igraa istovremeno domogne 2 pobede u rundama, svi se proglaavaju pobednicima mea.

**Uslovi za pobedu u rundi (Pragovi i ogranienje poteza):** Runda se zavrava im jedan ili vie igraa dostigne prag Poena Za Pobedu (PZP) ili nakon zavretka 5. poteza.
**Ogranienje poteza:** Svaka runda je ograniena na 5 potpunih poteza za svakog igraa. Ako prag PZP nije dostignut, na kraju 5. poteza vri se konano bodovanje i odreivanje pobednika.

**Vrednosti praga:**
- Runda 1: 20 Poena Za Pobedu (PZP).
- Runda 2: 30 Poena Za Pobedu (PZP).
- Runda 3 i dalje: Prag se poveava za +10 PZP u odnosu na prethodnu rundu (npr. Runda 3  40 PZP).

**Odreivanje pobednika rund i nereeno:** Pobednik rund je igra koji je dostigao prag vrednost ili igra sa najveim brojem PZP posle ogranienja poteza.
**Objanjenje nereenog u rundi:** Ako se po zavretku rund dva ili vie igraa imaju isti i najvei broj poena, svi se proglaavaju pobednicima rund.`,fieldTitle:"III. Bojite i komponente",fieldText:`**Bojite (Mrea):** Igra se odvija na kvadratnoj mrei ija se veliina menja u zavisnosti od ukupnog broja uesnika.
**Objanjenje veliina:**
- 2 igraa: Polje 5x5 elija.
- 3 igraa: Polje 6x6 elija.
- 4 igraa: Polje 7x7 elija.

**Odreivanje pozicija:**
- **Linija:** To je ceo horizontalni red ili vertikalna kolona. Koristi se za mehaniku bodovanja (Scoring).
- **Susedstvo:** elije se smatraju susednim samo horizontalno i vertikalno (ortogonalno). Dijagonalno susedstvo se ne uzima u obzir, osim ako je u karti drugaije navedeno.

**Karte:** U igri se koriste dva glavna tipa karata koje se igraju iz Ruke:
- **Jedinice (Units):** Osnovne borbene jedinice koje poseduju Snagu (Power) i Sposobnosti. Ostaju na bojitu do unitenja.
- **Komande (Commands):** Karte trenutnog dejstva. Igraju se, izvre efekat (esto nudei izbor "2 od 3 opcije") i odlaze u Baene.

**Zone za igru:**
- **Ruka (Hand):** Karte skrivene od protivnika.
- **Baene (Discard):** Zona u koju odlaze unitene Jedinice i odigrane Komande.
- **Izlog (Showcase/Announced):** Privremena zona u koju se stavlja karta Komande pre njenog igranja.`,setupTitle:"IV. Poetak igre (Postavljanje)",setupText:`**Formiranje pila:** Pre poetka mea svaki igra bira frakciju ili sastavlja pil prema pravilima izgradnje (najmanje 30 karata).
**Objanjenje:** KArte u pilu se promeaju.

**Poetna ruka:** Svaki igra vue 6 karata iz svog pila, formirajui poetnu ruku.
**Objanjenje skrivene informacije:** KArte u ruci su skrivene od protivnika.

**Mulingan:** Na poetku igre, nakon to dobije poetnu ruku (6 karata), igra ima pravo 1 put da promea bilo koji broj karata iz ruku nazad u pil i vue isti broj novih karata sa vrha.

**Odreivanje prvog igraa:** Odredite prvog aktivnog igraa bilo kojim pogodnim nainom (npr. bacanjem novia).
**Objanjenje:** Igra se vidi naizmenino, poevi od prvog igraa. Prvi igra zapoinje svoj prvi potez odmah sa Faze Setup.`,abilitiesTitle:"V. Sposobnosti karata",abilitiesText:`**Tipovi sposobnosti:**
- **Deploy:** Aktivira se automatski i odmah kada se karta stavlja iz ruke na polje otvoreno.
- **Setup:** Aktivira se automatski na poetku Faze Setup svakog vaeg poteza (pre vuenja karte), ako karta ve lei na polju licem nagore.
- **Commit:** Aktivira se automatski na poetku Faze Commit svakog vaeg poteza, ako karta ve lei na polju licem nagore.
- **Pas (Pasivna):** Efekat deluje trajno dok je karta na polju u otvorenom stanju.

**Uslovi izvrenja ():**
Mnoge sposobnosti imaju zahtev oznaen strelicom (npr. **Support  Deploy:** ...).
- To znai "PROVERA USLOVA  EFEKAT".
- Ako uslov levo od strelice (npr. prisustvo statusa Support) nije ispunjen u momentu aktiviranja, sposobnost **se ne aktivira** uopte.

**Vana pravila:**
- **Stun:** Ogluene karte (sa etonom Stun) **ne aktiviraju** svoje sposobnosti (ni Deploy, ni fazne, ni pasivne).
- **Face-down:** KArte koje lee licem nadole nemaju sposobnosti.
- **Obaveznost:** Ako se sposobnost aktivirala (uslovi su ispunjeni), vi **obavezni** da primenite njen efekat ako postoje legalne mete. Ako legalne mete nema, sposobnost se primenjuje uzalud (gori).`,statusesTitle:"VI. Dinamiki statusi (Pozicioniranje)",statusesText:`Dinamiki statusi se raunaju automatski i kontinuirano pri bilo kojoj promeni na tabli. Jedinice sa statusom Stun ne mogu davati ili uestvovati u proraunu ovih statusa.

**Podrka (Support):** Jedinica ima status Support ako se u bar jednoj susednoj eliji (horizontalno ili vertikalno) nalazi saveznika jedinica.
**Objanjenje Stun/Support:** Jedinica sa etonom Stun se ne uzima u obzir pri proraunu Support za susedne saveznike.
**Vrednost:** Prisustvo Support je uslov za aktiviranje mnogih monih sposobnosti, oznaenih sintaksom Support  [Efekat].

**Pretnja (Threat):** Jedinica dobija status Threat ako se nalazi u opasnoj poziciji, stvorenoj neprijateljskim jedinicama.
**Objanjenje uslova:** Status Threat se dodeljuje u jednoj od dve situacije:
1. **Kleta:** Jedinica je zakaena kartama jednog protivnika sa bilo koje dve strane (dve susedne ili dve suprotnje).
2. **Pritisak:** Jedinica se nalazi na ivici bojita i ima bar jednu kartu protivnika za susedom.
**Objanjenje Stun/Threat:** Jedinica sa etonom Stun se ne uzima u obzir pri proraunu Threat za susedne neprijatelje.
**Vrednost:** Jedinice pod Threat su ranjive mete za mone sposobnosti kontrole i unitenja.`,countersTitle:"VII. etoni (Counters)",countersText:`etoni su trajni markeri koji se nameu sposobnostima karata. Ostaju na jedinici dok se ne skinu ili dok jedinica ne bude unitena.

**Ogluenje (Stun):**
- **Efekat:** Jedinica sa Stun donosi 0 Poena Za Pobedu u fazi Scoring, ne moe da aktivira svoje sposobnosti i ne moe biti pomerena od strane svog vlasnika (ali moe biti pomerena od strane protivnika).
- **Skidanje:** Na kraju faze Commit sa svake jedinice aktivnog igraa automatski se skida 1 eton Stun.

**tit (Shield):**
- **Efekat:** Ako sposobnost pokua da uniti (Destroy) ovu jedinicu, efekat unitenja se spreava, a sa jedinice se umesto toga skida 1 eton tita. Jedinica ostaje na polju.

**Otkriveno (Revealed) i Skrivene karte (Face-down):**
- **Revealed:** Omoguava igrau-vlasniku etona da vidi skrivenu informaciju o karti.
- **Objanjenje Face-down:** Karta odigrana licem nadole (Face-down) nema Snagu ni Sposobnosti i donosi 0 poena. Ako takva karta dobije eton Revealed, njene informacije (lice) postaju vidljive protivniku, ali karta se i dalje smatra Face-down za sve svrhe igre (snaga, sposobnosti).

**Specijalni etoni (Aim, Exploit):**
- **Aim (Nianjenje) i Exploit (Iskorienost):** Ovi etoni su markeri za interakciju frakcijskih sposobnosti (npr. snajperi ili hakeri). Sami po sebi nemaju igraki efekat.

**Poslednja odigrana (Last Played):**
- **Efekat:** Privremeni status koji se automatski dodeljuje karti koju je poslednji odigrao na polje aktivni igra u tekuem potezu. Ovaj status odreuje liniju koju igra mora da izabere za bodovanje (Scoring).`,turnTitle:"VIII. Struktura poteza i vreme",turnText:`Potez se prenosi s igraa na igraa. Sposobnosti karata se aktiviraju samo u potezu njihovog vlasnika. Potez aktivnog igraa sastoji se od etiri sekvencijalne faze:

**1. Faza Setup (Postavljanje):**
- **Vuenje karte:** Aktivni igra vue 1 kartu iz pila u ruku.
- **Sposobnosti:** Aktiviraju se sposobnosti svih karata na polju sa kljunom rei **Setup:**.
**Objanjenje:** Ova faza je namenjena dopuni ruke i poetnom pozicioniranju jedinica.

**2. Faza Main (Delovanje / Razmetanje):**
- **Glavno delovanje:** Aktivni igra moe da izvri jedno od sledeih dejstava:
  - Odigra kartu Jedinice (**Deploy:**) iz ruku na bilo koju slobodnu eliju polja. Pri tome se odmah aktivira njena Deploy: sposobnost.
  - Odigra kartu Komande iz ruke.
  - Pasira.
**Objanjenje Komandi:** KArte Komandi se moe igrati u bilo kojem broju u ovoj fazi  pre, posle ili izmeu razmetanja jedinica.

**3. Faza Commit (Zavravanje / Uvrivanje):**
- **Sposobnosti:** Aktiviraju se sposobnosti svih karata na polju sa kljunom rei **Commit:**.
- **Skidanje Stun:** Na kraju ove faze sa svake jedinice aktivnog igraa automatski se skida 1 eton Stun.
**Objanjenje:** Faza se koristi za primenu efekata kontrole i dobijanje resursa pre bodovanja.

**4. Faza Scoring (Bodovanje):**
- **Ibor linije:** Aktivni igra mora da izabere jednu Liniju (Red ili Kolonu) koja prolazi kroz njegovu kartu sa statusom **Last Played**.
- **Proraun:** Sabira se Snaga svih jedinica aktivnog igraa u izabranoj liniji i dobijeni zbir dodaje se ukupnom rezultatu igraa.`,mechanicsTitle:"IX. Reavanje konflikata i kljune mehanike",mechanicsText:`**Stun i bodovanje:**
- **Efekat:** Jedinica sa statusom Stun ili koja lei Face-down donosi 0 poena u fazi Scoring, nezavisno od njene osnovne Snage, stalnih modifikatora snage ili pasivnih sposobnosti koje donose poene (npr. Spotter).

**Prenoenje statusa Last Played:**
- **Unitenje:** Ako karta sa statusom Last Played napusti bojite (unitena, vraena u ruku/pil) pre Faze Scoring, status se prenosi na prethodnu odigranu kartu ovog igraa (onu koja je bila Last Played u prolom potezu).
- **Pomeranje:** Ako se karta sa Last Played pomera na drugu eliju, igra bira njene nove linije u Fazi Scoring.
- **Odsustvo:** Ako igra nema nijednu kartu sa statusom Last Played, igra ne moe da izabere liniju i ne dobija poene u ovom potezu.

**Pomeranje jedinica (Push, Swap):**
- **Push (Guranje):** Jedinica forsira drugu kartu da se pomera za susednu eliju. Guranje se blokira (ne deava se) ako se meti nalazi zauzeta elija ili ivica polja. Ostali efekti sposobnosti se primenjuju na metu.
- **Swap (Zamena):** Omoguava dvema kartama da zamene mesta, ak i ako su obe elije zauzete.

**Vaskrsenje (Resurrect):**
- **Mehanika "izgaranja":** Karta vraena na bojite iz Baenih (vaskrsnuta) odmah dobija status **Resurrected** u momentu Deploya. Na poetku sledee faze (pri promeni faza) ovaj status se skida i karta dobija dva etona Stun.`,creditsTitle:"X. Autori igre",creditsText:`**Autor:** Nikita Anahoret

**Korieno:**
- Google AI Studio
- Gemini
- ChatGPT

**Posebna zahvalnost:**
- Vasilisa Versus
- Kirill Tomauk
- Andrej Markosov
- Mia epelin

Za sva pitanja i predloge piite na Telegram ili Discord.
Podrite razvoj igre i autore moete kroz DonationAlerts i Patreon.`},counters:{Aim:{name:"Nianjenje",description:`Ovaj eton sam po sebi nema efekta, ali moe da menja sposobnosti karata.
Ovu kartu je lake unititi.`},Exploit:{name:"Exploit",description:`Ovaj eton sam po sebi nema efekta, ali moe da menja sposobnosti karata.
Karte hakera i programera e imati vei efekat na ovu kartu.`},LastPlayed:{name:"PoslednjaOdigrana",description:"Ova karta je odigrana poslednja od strane svog vlasnika."},Revealed:{name:"Otkriveno",description:"Lice ove karte je vidljivo vlasniku etona revealed. Moe se stavljati na karte u ruci."},Stun:{name:"Ogluenje",description:`Ogluena karta ne moe da aktivira sposobnosti ili donosi poene. Efekti njenog vlasnika je ne mogu da pomeraju, ali efekti protivnika mogu.
Skinite 1 eton ogluenja sa karte posle faze bodovanja (Scoring).`},Shield:{name:"tit",description:"Ako efekat pokua da uniti ovu kartu, umesto toga skinite sa nje 1 eton tita."},Support:{name:"Podrka",description:`Ovaj eton sam po sebi nema efekta, ali moe da menja sposobnosti karata.
Ova karta se nalazi pored saveznika.`},Threat:{name:"Pretnja",description:`Ovaj eton sam po sebi nema efekta, ali moe da menja sposobnosti karata.
Ova karta je okruena i pritisnuta na ivicu polja kartama protivnika.`},"Power+":{name:"Snaga+",description:"Poveava snagu karte za 1."},"Power-":{name:"Snaga-",description:"Smanjuje snagu karte za 1."}},deckNames:{SynchroTech:"SynchroTech",Hoods:"Kapuljae",Optimates:"Optimati",Fusion:"Fuzija"},cards:{ipDeptAgent:{name:"Agent IP Odeljenja",ability:`Deploy: Daje 2 Stun karti sa Exploit.
Support  Commit: Igra baca otkrivenu (Revealed) kartu po tvom izboru.`,flavorText:'- "Krili ste autorska prava. Otvorite vrata. Imamo nalog za pretragu."'},tacticalAgent:{name:"Taktiki Agent",ability:`Deploy: Aim na kartu sa Threat.
Setup: Uniti kartu sa Aim.`,flavorText:'- "Neko se ne kree! Bezbednosna sluba SynchroTech!"'},patrolAgent:{name:"Patrolni Agent",ability:`Setup: Pomeri ovu kartu na bilo koju eliju u liniji.
Commit: Stun susedne karte protivnika sa Threat.`,flavorText:"Kau da grad nikada ne spava. Mi pazimo da ak ni ne trepe."},riotAgent:{name:"Agent za Suzbijanje Nereda",ability:`Deploy: Gurni kartu protivnika za 1 eliju. Moe zauzeti njeno mesto.
Commit: Stun susedne karte protivnika sa Threat.`,flavorText:'- "Graani, raziite se! Ovaj skup nije odobren od strane SynchroTech."'},threatAnalyst:{name:"Analitiar Pretnji",ability:`Deploy: Exploit na bilo koju kartu.
Support  Commit: Otkrij 1 kartu za svaki tvoj Exploit na bojitu.`,flavorText:""},recklessProvocateur:{name:"Nemarni Provokator",ability:`Deploy: Zameni mesta sa kartom na susednoj eliji.
Commit: Premesti sve etone sa saveznike karte na bojitu na ovu kartu.`,flavorText:'- "Strpljenje je oruje. Osveta je umetnost."'},dataLiberator:{name:"Oslobodilac Podataka",ability:`Deploy: Exploit na bilo koju kartu.
Support  Pass: Karte sa tvojim etonima Exploit donose ti bodove.`,flavorText:'- "Informacija ne eli da bude slobodna. Ona mora biti."'},cautiousAvenger:{name:"Oprezni Osveta",ability:`Deploy: Aim na kartu u liniji.
Support  Setup: Uniti kartu sa Aim.`,flavorText:'- "Strpljenje je oruje. Osveta je umetnost."'},vigilantSpotter:{name:"Bedni Nadzornik",ability:`Support  Pass: Kada otkrivena (Revealed) karta protivnika izae na polje, dobij 2 boda.
Commit: Otkrij 1 kartu iz ruke protivnika.`,flavorText:'- "Strpljenje je oruje. Osveta je umetnost."'},inventiveMaker:{name:"Izumitelj Kreator",ability:`Deploy: Postavi token Izvidnikog Drona na slobodnu susednu eliju.
Support  Setup: Vrati kartu ureaja iz baenih u ruku.`,flavorText:'- "Strpljenje je oruje. Osveta je umetnost."'},faber:{name:"Faber",ability:"Deploy: Discard 1  Postavi kartu Hodajue Kule na slobodnu susednu eliju.",flavorText:"U pozlaenim dvoranama Optimata ak i alati ratovanja su umetnika dela."},censor:{name:"Cenzor",ability:`Deploy: Exploit na bilo koju kartu.
Support  Commit: Zameni 1 tvoj Exploit za 1 Stun.`,flavorText:"U pozlaenim dvoranama Optimata ak i alati ratovanja su umetnika dela."},princeps:{name:"Princeps",ability:`Deploy: Shield 1. Aim na bilo koju kartu u njegovoj liniji.
Setup: Uniti kartu sa Aim.`,flavorText:"Red se ne trai. On se nametne."},immunis:{name:"Immunis",ability:"Support  Deploy: Vrati tvog Optimatu iz baenih na susednu eliju. Na kraju faze vrati Optimatu za 2 Stun.",flavorText:"U pozlaenim dvoranama Optimata ak i alati ratovanja su umetnika dela."},centurion:{name:"Centurion",ability:"Commit: rtvuj savezniku jedinicu. Poveaj snagu svih saveznikih karata u njegovim linijama za 1.",flavorText:"U pozlaenim dvoranama Optimata ak i alati ratovanja su umetnika dela."},codeKeeper:{name:"uvar Koda",ability:`Deploy: Exploit na karte protivnika sa Threat.
Support  Commit: Pomeri kartu protivnika sa Exploit za 1 eliju.`,flavorText:"Signal je istina. Sve ostalo je um."},devoutSynthetic:{name:"Poboni Sintetiar",ability:`Deploy: Gurni susednu kartu za 1 eliju. Moe zauzeti njeno mesto.
Setup: Uniti susednu kartu sa Threat ili Stun.`,flavorText:"Telo je bag. Signal je zakrpa."},unwaveringIntegrator:{name:"Nepokolebljivi Integrator",ability:`Deploy: Exploit na bilo koju kartu.
Support  Setup: Dobij 1 bod za svaki tvoj Exploit u liniji.`,flavorText:"Signal je istina. Sve ostalo je um."},signalProphet:{name:"Prorok Signala",ability:`Deploy: Exploit na svaku tvoju kartu sa Support.
Support  Commit: Pomeri tvoju kartu sa tvojim Exploit za 1 eliju.`,flavorText:"Signal je istina. Sve ostalo je um."},zealousMissionary:{name:"Revni Misionar",ability:`Deploy: Exploit na bilo koju kartu.
Support  Commit: Smanji snagu bilo koje karte sa tvojim Exploit za 1.`,flavorText:"Signal je istina. Sve ostalo je um."},overwatch:{name:"Nadzor",ability:` Aim 1 na bilo koju kartu. Otkrij 1 kartu iz ruke protivnika za svaki tvoj Aim na bojitu.
 Aim 1 na bilo koju kartu. Vuci 1 kartu za svaki tvoj Aim na bojitu.`},tacticalManeuver:{name:"Taktiki Manevar",ability:` Pomeri tvoju jedinicu na slobodnu eliju u liniji. Vuci karte jednake snage premetene jedinice.
 Pomeri tvoju jedinicu na slobodnu eliju u liniji. Dobij bodove jednake snage premetene jedinice.`},inspiration:{name:"Inspiracija",ability:` Skini bilo koji broj etona (osim Support/Threat) sa tvoje jedinice. Vuci 1 kartu za svaki sklonuti eton.
 Skini bilo koji broj etona (osim Support/Threat) sa tvoje jedinice. Dobij 1 bod za svaki sklonuti eton.`},dataInterception:{name:"Presretanje Podataka",ability:` Exploit 1 na bilo koju kartu. Otkrij 1 kartu iz ruke protivnika za svaki tvoj Exploit na bojitu.
 Exploit 1 na bilo koju kartu. Pomeri jedinicu sa tvojim Exploit za 1 ili 2 elije.`},falseOrders:{name:"Lani Naredbe",ability:` Stavi 1 Exploit na kartu protivnika. Zatim pomeri jedinicu protivnika sa tvojim Exploit (Domet 2). Otkrij do 2 karte iz ruke vlasnika.
 Stavi 1 Exploit na kartu protivnika. Zatim pomeri jedinicu protivnika sa tvojim Exploit (Domet 2). Daj 2 Stun premetenoj jedinici.`},experimentalStimulants:{name:"Eksperimentalni Stimulatori",ability:` Tvoja jedinica na bojitu moe da aktivira svoju Deploy sposobnost jo jednom.
 Pomeri tvoju jedinicu na slobodnu eliju u liniji.`},logisticsChain:{name:"Lanac Logistike",ability:` Dobij bodove u izabranoj dijagonali. Dobij 1 dodatni bod za svaku tvoju kartu sa Support u ovoj dijagonali.
 Dobij bodove u izabranoj dijagonali. Vuci 1 kartu za svaku tvoju kartu sa Support u ovoj dijagonali.`},quickResponseTeam:{name:"Tim za Brzo Reagovanje",ability:` Postavi tvoju jedinicu iz ruke na bilo koju eliju.
 Pronai kartu jedinice u tvojoj pilu i vuci je u ruku.`},temporaryShelter:{name:"Privremeno Sklonite",ability:` Stavi Shield na tvoju kartu na bojitu. Skini sve Aim sa ove karte.
 Stavi Shield na tvoju kartu na bojitu. Pomeri ovu kartu za 1 ili 2 elije.`},enhancedInterrogation:{name:"Pojaani Ispitivanje",ability:` Aim 1 na bilo koju kartu. Otkrij 1 kartu iz ruke protivnika za svaki tvoj Aim na bojitu.
 Aim 1 na bilo koju kartu. Pomeri bilo koju kartu sa tvojim Aim za 1 ili 2 elije.`},mobilization1:{name:"Probijanje Linije",ability:"Dobij bodove u izabranoj liniji bojita."},mobilization2:{name:"Logistiki Lanac",ability:"Dobij bodove u izabranoj dijagonali bojita."},mobilization3:{name:"Osvojavanje Sektora",ability:"Dobij bodove od 4 susednih saveznikih karata."},reconDrone:{name:"Izvidniki Dron",ability:`Setup: Pomeri se na bilo koju eliju.
Commit: Moe otkriti kartu iz ruke protivnika iji vlasnik poseduje susednu kartu.`,flavorText:"SynchroTech je kreirao lake dronove za patrolu ulica, ali Hoodsi imaju druge planove."},walkingTurret:{name:"Hodajua Kula",ability:`Deploy: Aim na bilo koju kartu u njegovoj liniji.
Setup: - 1 snage bilo kojoj karti sa etonom Aim.`,flavorText:"Ovom ratnoj udovitu oigledno nije mesto na gradskim ulicama."},reclaimedGawain:{name:'Povraeni "Gawain"',ability:`Deploy: Shield 1. Gurni susednu kartu za 1 eliju. Moe zauzeti njeno mesto.
Setup: Uniti susednu kartu sa Threat ili Stun.`,flavorText:"Nekada vite sistema, sada duh u maini."},FalkPD:{name:"Majkl Falk, Privatni Detektiv",ability:`Deploy: Pronai bilo koju kartu u tvojoj pilu i vuci je u ruku.
Commit: Otkrij 1 kartu iz ruke protivnika.`,flavorText:"On pronalazi stvari. Ponekad stvari koje treba da ostanu izgubljene."},edithByron:{name:"Edit Bajron, Ekstremni Inenjer",ability:`Deploy: Shield 1. Postavi token Izvidnikog Drona na slobodnu susednu eliju.
Setup: Pomeri ovu kartu na bilo koju eliju u liniji.`,flavorText:"Gradi budunost, jedna eksplozija za drugom."},pinkunonekoSV:{name:"Pinkunoneko, Ulini Vigilante",ability:`Deploy: Stun susedne karte protivnika.
Setup: Uniti susednu kartu sa Threat ili Stun. Zatim moe da se pomeri na susednu eliju.`,flavorText:"Neonske kande u mranoj ulici."},EleftheriaMD:{name:'Marija "Elefterija" Damanaki',ability:`Deploy: Aim na bilo koju kartu.
Setup: Uniti kartu sa Aim.`,flavorText:"Sloboda ima cenu. Ona naplauje."},ziusIJ:{name:"Zius, Nezavisni Novinar",ability:`Deploy: Exploit na bilo koju kartu.
Support  Setup: Exploit na bilo koju kartu. Dobij 1 bod za svaki tvoj Exploit u ovoj liniji.`,flavorText:"Istina je negde u blizini, i on emituje direktni prenos."},abrGawain:{name:'Autonomna Borbena Maina "Gawain"',ability:`Deploy: Shield 1. Aim na bilo koju kartu u njegovoj liniji.
Setup: Uniti kartu sa Aim.`,flavorText:"Protokol iniciran. Procena pretnje: Ekstremna."},reverendOfTheChoir:{name:"asni Hor",ability:`Pass: Daje Support svim tvojim jedinicama u linijama.
Setup: Exploit na bilo koju kartu.`,flavorText:"Huanje servera je himna za posveene."},mrPearlDoF:{name:"Gospodin Perl, Direktor Bio-Synch",ability:`Pass: Tvoje druge jedinice u linijama dobijaju +1 snage.
Deploy: Pronai kartu jedinice u pilu i stavi je u ruku.`,flavorText:"Efikasnost je jedina metrika koja ima znaaj."},finnMW:{name:"Fin, Najtraeniji",ability:`Setup: Pomeri bilo koju tvoju kartu za 1 ili 2 elije.
Commit: Dobij 1 bod za svaku otkrivenu kartu u rukama protivnika.`,flavorText:"Uhvati me ako moe. Spoiler: Ne moe."},luciusTheImmortal:{name:"Lucije, Besmrtni",ability:`Pass: Imunitet na Stun. Ako je izaao iz baenih, dobija +2 snage.
Setup: Discard 1  Pronai kartu Komande u tvojoj pilu i vuci je u ruku.`,flavorText:"Smrt podrazumeva prestanak funkcija. Ja sam samo optimizovao to."},secretInformant:{name:"Tajni Informator",ability:"Deploy: Pogledaj 3 gornje karte bilo kog pila. Ukloni bilo koji broj pogledanih karata na dno pila njihovog vlasnika. Vuci kartu.",flavorText:"Znanje je snaga. I sredstvo pritiska."}}},jg={startGame:"Start Game",joinGame:"Join Game",deckBuilding:"Deck Building",rules:"Rules & Tutorial",settings:"Settings",language:"Language",serverAddress:"Server Address",saveApply:"Save & Apply",cancel:"Cancel",close:"Close",tokens:"Tokens",counters:"Counters",phase:"Phase",scoring:"SCORING...",autoAbility:"Auto-Ability",autoDraw:"Auto-Draw",newGame:"New Game",exit:"Exit",surrender:"Surrender",mode:"Mode",size:"Size",dummies:"Dummies",spectatorMode:"Spectator Mode",spectatorMsg:"You are watching the game.",readyCheck:"Ready to Start?",imReady:"I'm Ready",waiting:"Waiting...",cancelStart:"Cancel Start",assignTeams:"Assign Teams",confirmTeams:"Confirm Teams & Start",unassigned:"Unassigned Players",team:"Team",deck:"DECK",discard:"DISCARD",showcase:"Showcase",customDeck:"Custom Deck",loadDeck:"Load",clear:"Clear",save:"Save",filter:"Filter",currentDeck:"Current Deck",emptyDeck:"Your deck is empty.",clickToAdd:"Click cards on the left to add them.",view:"View",play:"Play",playFaceDown:"Play Face Down",toHand:"To Hand",toDiscard:"To Discard",revealToAll:"Reveal to All",requestReveal:"Request Reveal",flipUp:"Flip Face Up",flipDown:"Flip Face Down",connected:"Connected",disconnected:"Disconnected",hiddenGameTooltip:"Hidden games do not appear in the 'Join Game' list",gameOver:"Game Over",roundComplete:"Round Complete",winner:"Winner",roundWinner:"Round Winner",move:"Move",moveToBottom:"Move to Bottom",selectCard:"Select Card",deckView:"Deck",topDeckView:"Top Deck",discardView:"Discard Pile",selectFromDeck:"Select Card from Deck",selectFromDiscard:"Select Card from Discard",power:"Power",owner:"Owner",noDescription:"No description available",comingSoon:"Coming Soon",revealed:"Revealed",reconnecting:"Reconnecting...",error:"Error",loading:"Loading...",create:"Create",createGame:"Create Game",gameCode:"Game Code",playerName:"Player Name",join:"Join",back:"Back",customGame:"Custom Game",privateGame:"Private Game",publicGame:"Public Game",freeForAll:"Free For All",teamBattle:"Team Battle",startingPlayer:"Starting Player",turn:"Turn",round:"Round",score:"Score",hand:"HAND",announced:"ANNOUNCED",effects:"Effects",status:"Status",deploy:"Deploy",ability:"Ability",recover:"Recover",resurrect:"Resurrect",destroy:"Destroy",returnToHand:"Return to Hand",shuffle:"Shuffle",drawCard:"Draw Card",drawStartingHand:"Draw Starting Hand (6)",viewTopCards:"View Top Cards",highlight:"Highlight",highlightCell:"Highlight Cell",highlightRow:"Highlight Row",highlightColumn:"Highlight Column",emptyHand:"Empty Hand",hidden:"Hidden",newAvalon:"New Avalon",cards:"Cards",scorePoints:"points",toWinRound:"to win round.",checkedAtFirstPlayer:"Checked at First Player's Setup Phase.",roundVictoryCondition:"Round Victory Condition",reach:"Reach",ffa:"FFA",team2v2:"2v2",team3v1:"3v1",drawCards:"Draw Card",activeGames:"Active Games",noActiveGames:"No active games found.",createOne:"Why not create one?",orJoinWithCode:"Or Join with Code",enterGameId:"Enter Game ID",dragToReorder:"Drag to reorder.",rightClickForActions:"Right click for actions.",deckEmpty:"Deck is empty.",done:"Done",remove:"Remove",toDeckTop:"To Deck Top",toDeckBottom:"To Deck Bottom",storyMode:"Story Mode",puzzles:"Puzzles",changeColor:"Change Color",firstPlayer:"First Player",activePlayer:"Active Player",clearSearch:"Clear Search",resetPowerFilter:"Reset Power Filter",clearTypes:"Clear Types",resetFaction:"Reset Faction",removeOne:"Remove one",waitingForOthers:"Waiting for others...",deckNamePlaceholder:"Deck Name",searchPlaceholder:"Search...",myCustomDeck:"My Custom Deck",untitledDeck:"Untitled Deck",max1RarityHero:"Max 1 (Rarity/Hero)",max2Command:"Max 2 (Command)",finalRoundMaxTurns:"Final Round! Max 10 Turns.",max5Rounds:"Max 5 Rounds.",selectCardFromDeck:"Select Card from Deck",selectCardFromDiscard:"Select Card from Discard",noTarget:"No Target",confirmClearDeck:"Are you sure you want to clear the current deck?",languageDisabled:"Language selection is currently disabled.",autoAbilitiesTooltip:"Auto-Abilities: Enable automatic ability activation",autoDrawTooltip:"Auto-Draw: Enable automatic card drawing (6 card starting hand + draw at Setup phase)",endedOnTurn:"Ended on Turn",nextRound:"Next:",victoryCondition:"Victory Condition:",win2RoundsMatch:"* Win 2 rounds to win the match. ",max5RoundsInfo:"Max 5 Rounds.",matchComplete:"Match Complete",thankYouPlaying:"Thank you for playing New Avalon: Skirmish.",returnToMenu:"Return to Menu",continueGame:"Continue Game",startRound:"Start Round",youLabel:"(You)",readyToStart:"Ready to Start?",gameWillBegin:"The game will begin once all players are ready. You can still change your name and deck.",dragCardsReorder:"Drag cards to reorder. Drag outside to move card to another zone.",dragOutsideAnotherZone:"Drag outside to move card to another zone.",ready:"Ready",dragOutsideToMove:"Drag outside to move card to another zone.",empty:"Empty",dragOutsideToPlaceToken:"Drag outside to place token on the board.",holdRightClickViewHints:"Hold right click to view hints"},Ig={title:"New Avalon: Skirmish Game Rules",conceptTitle:"I. Basic Concept",conceptText:`**Genre and Player Role:** New Avalon: Skirmish is a dynamic tactical card game played on a limited grid field. Players take on the roles of faction leaders, deploying Units and Commands to capture control over key battle lines.

**Explanation:** The game focuses on positional control and ability activation timing, not just direct attacks. Victory is achieved by earning Victory Points (VP), based on the strength of units in selected lines.`,winConditionTitle:"II. Victory Conditions",winConditionText:`**Match Victory Conditions:** The match is played to 2 round wins. The first player to achieve 2 round wins immediately wins the match.
**Draw Explanation:** If, at the end of any round, multiple players simultaneously reach 2 round wins, all are declared match winners.

**Round Victory Conditions (Thresholds and Turn Limit):** A round ends as soon as one or more players reach the Victory Point (VP) threshold or after completion of turn 5.
**Turn Limit:** Each round is limited to 5 full turns per player. If the VP threshold is not reached, final scoring occurs at the end of turn 5.

**Threshold Values:**
- Round 1: 20 Victory Points (VP).
- Round 2: 30 Victory Points (VP).
- Round 3 onwards: Threshold increases by +10 VP relative to previous round (e.g., Round 3  40 VP).

**Determining Round Winner and Draw:** The round winner is the player who reached the threshold value or the player with the most VPs after the turn limit.
**Round Draw Explanation:** If, at the end of the round, two or more players have the same and highest point total, all are declared round winners.`,fieldTitle:"III. Battlefield and Components",fieldText:`**Battlefield (Grid):** The game is played on a square grid whose size changes based on total participants.
**Size Explanation:**
- 2 players: 5x5 cell field.
- 3 players: 6x6 cell field.
- 4 players: 7x7 cell field.

**Position Determination:**
- **Line:** An entire horizontal row or vertical column. Used for scoring mechanics.
- **Adjacency:** Cells are considered adjacent only horizontally and vertically (orthogonally). Diagonal adjacency is not considered unless otherwise stated on a card.

**Cards:** The game uses two main card types played from Hand:
- **Units:** Basic combat units with Power and Abilities. Remain on battlefield until destroyed.
- **Commands:** Instant action cards. Played, execute effect (often offering "2 of 3 options"), and go to Discard.

**Play Zones:**
- **Hand:** Cards hidden from opponents.
- **Discard:** Zone where destroyed Units and played Commands go.
- **Showcase (Announced):** Temporary zone where a Command card is placed before being played.`,setupTitle:"IV. Game Start (Setup)",setupText:`**Deck Formation:** Before match start, each player chooses a faction or builds a deck according to building rules (minimum 30 cards).
**Explanation:** Cards in deck are shuffled.

**Starting Hand:** Each player draws 6 cards from their deck, forming the starting hand.
**Hidden Information Explanation:** Cards in hand are hidden from opponents.

**Mulligan:** At game start, after receiving starting hand (6 cards), player has the right to shuffle any number of cards from hand back into deck and draw same number of new cards from top.

**Determining First Player:** Determine first active player by any convenient method (e.g., coin toss).
**Explanation:** Play proceeds alternately, starting with first player. First player begins their first turn immediately with Setup Phase.`,abilitiesTitle:"V. Card Abilities",abilitiesText:`**Ability Types:**
- **Deploy:** Activates automatically and immediately when card is placed from hand onto field face-up.
- **Setup:** Activates automatically at start of Setup Phase of each of your turns (before drawing), if card already lies on field face-up.
- **Commit:** Activates automatically at start of Commit Phase of each of your turns, if card already lies on field face-up.
- **Pass (Passive):** Effect applies continuously while card is on field in face-up state.

**Execution Conditions ():**
Many abilities have requirement marked by arrow (e.g., **Support  Deploy:** ...).
- This means "CONDITION CHECK  EFFECT".
- If condition left of arrow (e.g., presence of Support status) is not met at activation time, ability **does not activate** at all.

**Important Rules:**
- **Stun:** Stunned cards (with Stun token) **do not activate** their abilities (neither Deploy, nor phase, nor passive).
- **Face-down:** Cards lying face-down have no abilities.
- **Obligation:** If ability activated (conditions met), you **must** apply its effect if legal targets exist. If no legal targets, ability applies fruitlessly (burns).`,statusesTitle:"VI. Dynamic Statuses (Positioning)",statusesText:`Dynamic statuses are calculated automatically and continuously upon any board change. Units with Stun status cannot give or participate in calculation of these statuses.

**Support:** Unit has Support status if in at least one adjacent cell (horizontally or vertically) there is an allied unit.
**Stun/Support Explanation:** Unit with Stun token is not considered in Support calculation for adjacent allies.
**Value:** Presence of Support is condition for activating many powerful abilities, marked by syntax Support  [Effect].

**Threat:** Unit gains Threat status if located in dangerous position created by enemy units.
**Condition Explanation:** Threat status is assigned in one of two situations:
1. **Pincers:** Unit is caught by cards of one opponent from any two sides (two adjacent or two opposite).
2. **Pressure:** Unit is on battlefield edge and has at least one opponent card adjacent.
**Stun/Threat Explanation:** Unit with Stun token is not considered in Threat calculation for adjacent enemies.
**Value:** Units under Threat are vulnerable targets for powerful control and destruction abilities.`,countersTitle:"VII. Tokens (Counters)",countersText:`Tokens are permanent markers placed by card abilities. Remain on unit until removed or unit destroyed.

**Stun:**
- **Effect:** Unit with Stun gives 0 Victory Points in scoring phase, cannot activate its abilities and cannot be moved by its owner (but can be moved by opponents).
- **Removal:** At end of Commit phase, 1 Stun token is automatically removed from each unit of active player.

**Shield:**
- **Effect:** If ability attempts to Destroy this unit, destruction effect is prevented, and 1 Shield token is removed from unit instead. Unit remains on field.

**Revealed and Face-down Cards:**
- **Revealed:** Enables token owner to see hidden card information.
- **Face-down Explanation:** Card played face-down has no Power or Abilities and gives 0 points. If such card receives Revealed token, its information (face) becomes visible to opponent, but card is still considered face-down for all game purposes (power, abilities).

**Special Tokens (Aim, Exploit):**
- **Aim and Exploit:** These tokens are markers for faction ability interaction (e.g., snipers or hackers). Have no gameplay effect by themselves.

**Last Played:**
- **Effect:** Temporary status automatically assigned to card last played onto field by active player in current turn. This status determines line player must choose for scoring.`,turnTitle:"VIII. Turn Structure and Timing",turnText:`Turn passes from player to player. Card abilities activate only in their owner's turn. Active player's turn consists of four sequential phases:

**1. Setup Phase:**
- **Draw:** Active player draws 1 card from deck into hand.
- **Abilities:** Activate abilities of all cards on field with keyword **Setup:**.
**Explanation:** This phase is for hand replenishment and initial unit positioning.

**2. Main Phase (Action/Deployment):**
- **Main Action:** Active player may perform one of following actions:
  - Play Unit card (**Deploy:**) from hand onto any free field cell. Immediately activates its Deploy: ability.
  - Play Command card from hand.
  - Pass.
**Command Explanation:** Command cards can be played in any number during this phase  before, after, or between unit deployments.

**3. Commit Phase (Finalization):**
- **Abilities:** Activate abilities of all cards on field with keyword **Commit:**.
- **Stun Removal:** At end of this phase, 1 Stun token is automatically removed from each unit of active player.
**Explanation:** Phase used for applying control effects and gaining resources before scoring.

**4. Scoring Phase:**
- **Line Selection:** Active player must choose one Line (Row or Column) passing through their card with **Last Played** status.
- **Calculation:** Sum Power of all active player's units in selected line and add total to player's overall score.`,mechanicsTitle:"IX. Conflict Resolution and Key Mechanics",mechanicsText:`**Stun and Scoring:**
- **Effect:** Unit with Stun status or lying Face-down gives 0 points in scoring phase, regardless of its base Power, permanent power modifiers, or passive abilities that give points (e.g., Spotter).

**Last Played Status Transfer:**
- **Destruction:** If card with Last Played status leaves battlefield (destroyed, returned to hand/deck) before Scoring Phase, status transfers to previous played card of this player (the one that was Last Played in previous turn).
- **Movement:** If card with Last Played moves to another cell, player chooses its new lines in Scoring Phase.
- **Absence:** If player has no card with Last Played status, player cannot choose line and gets no points this turn.

**Unit Movement (Push, Swap):**
- **Push:** Unit forces another card to move to adjacent cell. Push is blocked (does not happen) if target cell is occupied or field edge. Other ability effects apply to target.
- **Swap:** Enables two cards to exchange places, even if both cells are occupied.

**Resurrection:**
- **"Burning" Mechanic:** Card returned to battlefield from Discard (resurrected) immediately gains **Resurrected** status at moment of Deploy. At start of next phase (on phase change) this status is removed and card receives two Stun tokens.`,creditsTitle:"X. Game Authors",creditsText:`**Author:** Nikita Anahoret

**Used:**
- Google AI Studio
- Gemini
- ChatGPT

**Special Thanks:**
- Vasilisa Versus
- Kirill Tomauk
- Andrej Markosov
- Mia epelin

For questions and suggestions write on Telegram or Discord.
You can support game development and authors through DonationAlerts and Patreon.`},Bd={};Fp.forEach((e,t)=>{Bd[t]={name:e.name,ability:e.ability,flavorText:e.flavorText}});Bp.forEach((e,t)=>{Bd[t]={name:e.name,ability:e.ability,flavorText:e.flavorText}});const $p={};Object.entries(Gr).forEach(([e,t])=>{$p[e]={name:t.name,description:t.description}});const Ng={deploy:"Deploy",setup:"Setup",commit:"Commit",support:"Support",threat:"Threat",pass:"Pass",aim:"Aim",exploit:"Exploit",stun:"Stun",shield:"Shield",gain:"Gain",point:"Point",points:"Points",reveal:"Reveal",move:"Move",draw:"Draw",push:"Push",sacrifice:"Sacrifice",discard:"Discard"},_g={unit:"Unit",command:"Command",hero:"Hero",rarity:"Rarity",structure:"Structure",gear:"Gear",event:"Event",attachment:"Attachment"},Dg={SynchroTech:"SynchroTech",Hoods:"Hoods",Optimates:"Optimates",Fusion:"Fusion"},mn={abilityKeywords:Ng,cardTypes:_g,ui:jg,rules:Ig,cards:Bd,counters:$p,deckNames:Dg},On={en:mn,ru:Eg,sr:Sg,de:mn,fr:mn,it:mn,pt:mn,zh:mn,hi:mn,es:mn,ar:mn,uk:mn,be:mn,tt:mn},Rg=["en","ru","sr"],Ag={en:"English",ru:"",de:"Deutsch",fr:"Franais",it:"Italiano",pt:"Portugus",zh:"",hi:"",es:"Espaol",ar:"",uk:"",be:"",tt:"",sr:"Srpski"},Wp=p.createContext(void 0),Og=({children:e})=>{const[t,n]=p.useState("en");p.useEffect(()=>{const d=localStorage.getItem("app_language");d&&d in On&&n(d)},[]);const r=d=>{n(d),localStorage.setItem("app_language",d)},o=d=>On[t].ui[d]||On.en.ui[d]||d,a=d=>On[t].cards[d]||On.en.cards[d],s=d=>On[t].counters[d]||On.en.counters[d],l=d=>{const h=On[t].deckNames,k=On.en.deckNames;return h[d]||k[d]};return i.jsx(Wp.Provider,{value:{language:t,setLanguage:r,t:o,getCardTranslation:a,getCounterTranslation:s,getDeckTranslation:l,resources:On[t],isRTL:!1},children:i.jsx("div",{dir:"ltr",children:e})})},Nt=()=>{const e=p.useContext(Wp);if(!e)throw new Error("useLanguage must be used within a LanguageProvider");return e},Kp=({x:e,y:t,children:n})=>{const r=p.useRef(null),[o,a]=p.useState({top:t+20,left:e+20});return p.useLayoutEffect(()=>{if(r.current){const{innerWidth:s,innerHeight:l}=window,{offsetWidth:c,offsetHeight:d}=r.current;let h=e+20;h+c>s&&(h=e-c-20),h<5&&(h=5);let k=t+20;k+d>l&&(k=t-d-20),k<5&&(k=5),a({top:k,left:h})}},[e,t,n]),Ud.createPortal(i.jsx("div",{ref:r,className:"fixed bg-gray-900 border border-gray-700 rounded-md shadow-lg z-[99999] p-3 text-white text-base pointer-events-none transition-opacity duration-100",style:{top:o.top,left:o.left,opacity:1},children:n}),document.body)},as=({card:e,statusDescriptions:t,className:n,hideOwner:r=!1,powerPosition:o="default"})=>{var _;const{resources:a,getCardTranslation:s}=Nt(),l=a.abilityKeywords,c=a.cardTypes,d=e.baseId?s(e.baseId):void 0,h=(d==null?void 0:d.name)||e.name,k=(d==null?void 0:d.ability)||e.ability,g=(_=e.types)!=null&&_.length?e.types.map(O=>c[O]||O).join(", "):e.deck==="counter"?"":`${e.deck} Card`,b=["readyDeploy","readySetup","readyCommit"],x=(e.statuses??[]).reduce((O,M)=>(b.includes(M.type)||(O[M.type]=(O[M.type]||0)+1),O),{}),A=Object.keys(x).length>0,T=e.ownerName||(e.ownerId?`Player ${e.ownerId}`:null),u=e.ability?e.ability.length:0,m=A?Object.keys(x).length*10:0,f=u>35||m>35,D=n||"relative flex flex-col text-left w-max max-w-[90vw]",N=o==="inner"?{powerContainer:"absolute top-[2px] right-[2px] w-4 h-4 rounded-full bg-gray-700 border border-gray-500 flex items-center justify-center text-xs font-bold"}:null;return i.jsxs("div",{className:D,children:[i.jsxs("div",{className:"mb-1 pr-1 whitespace-nowrap relative",children:[i.jsx("div",{className:"font-bold text-white text-lg leading-tight mb-0.5",children:h}),g&&i.jsx("div",{className:"text-xs text-gray-400 font-semibold",children:g}),N&&e.power&&e.power>0&&i.jsx("div",{className:N.powerContainer,children:e.power})]}),i.jsxs("div",{className:`flex flex-col ${!n&&f?"w-[16rem]":"w-full"} whitespace-normal break-words`,children:[k&&i.jsx("hr",{className:"border-gray-600 mt-[0px] mb-[2px]"}),k&&i.jsx("div",{className:"text-sm text-gray-200 leading-snug",children:Fd(k,l)}),k&&i.jsx("hr",{className:"border-gray-600 my-[4px]"}),A&&i.jsx("div",{className:"text-xs text-gray-200 leading-snug",children:Object.entries(x).map(([O,M],I,V)=>i.jsxs("span",{children:[i.jsx("span",{className:"font-bold text-indigo-300",children:O}),M>1&&i.jsxs("span",{className:"text-gray-400 ml-1",children:["(x",M,")"]}),(t==null?void 0:t[O])&&i.jsxs("span",{className:"text-gray-400 ml-1",children:["(",t[O],")"]}),I<V.length-1?i.jsx("span",{className:"text-gray-400 mr-1",children:", "}):""]},O))}),A&&T&&!r&&i.jsx("hr",{className:"border-gray-600 my-[2px]"}),T&&!r&&i.jsxs("div",{className:"text-xs text-gray-500 font-semibold",children:["Owner: ",i.jsx("span",{className:"text-gray-300",children:T})]})]})]})},Fl="readyDeploy",qp="readySetup",Jp="readyCommit",Yr=(e,t,n,r)=>Math.abs(e-n)+Math.abs(t-r)===1,st=(e,t,n)=>e.statuses?e.statuses.some(r=>r.type===t&&(n===void 0||r.addedByPlayerId===n)):!1,Gi=(e,t)=>e.statuses?e.statuses.some(n=>n.type===t):!1,Pg=[{baseId:"ipDeptAgent",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Stun",count:2,requiredTargetStatus:"Exploit",requireStatusFromSourceOwner:!0,placeAllAtOnce:!0})},{baseId:"ipDeptAgent",activationType:"commit",supportRequired:!0,getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:o=>st(o,"Revealed",n),allowHandTargets:!0}})},{baseId:"tacticalAgent",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Aim",count:1,requiredTargetStatus:"Threat",requireStatusFromSourceOwner:!0})},{baseId:"tacticalAgent",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:o=>st(o,"Aim",n)}})},{baseId:"patrolAgent",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"PATROL_MOVE",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"patrolAgent",activationType:"commit",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Stun",count:1,requiredTargetStatus:"Threat",onlyOpponents:!0,mustBeAdjacentToSource:!0,sourceCoords:r})},{baseId:"riotAgent",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"RIOT_PUSH",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"riotAgent",activationType:"commit",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Stun",count:1,requiredTargetStatus:"Threat",onlyOpponents:!0,mustBeAdjacentToSource:!0,sourceCoords:r})},{baseId:"threatAnalyst",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1})},{baseId:"threatAnalyst",activationType:"commit",supportRequired:!0,getAction:(e,t,n,r)=>{let o=0;return t.board.forEach(a=>{a.forEach(s=>{var l;(l=s.card)!=null&&l.statuses&&(o+=s.card.statuses.filter(c=>c.type==="Exploit"&&c.addedByPlayerId===n).length)})}),o===0?null:{type:"CREATE_STACK",tokenType:"Revealed",count:o,onlyFaceDown:!0}}},{baseId:"mrPearlDoF",activationType:"deploy",getAction:(e,t,n,r)=>({type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:e,payload:{filterType:"Unit",actionType:"RETRIEVE_FROM_DECK"}})},{baseId:"vigilantSpotter",activationType:"commit",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Revealed",count:1,onlyFaceDown:!0,excludeOwnerId:n})},{baseId:"codeKeeper",activationType:"deploy",getAction:(e,t,n,r)=>({type:"GLOBAL_AUTO_APPLY",payload:{tokenType:"Exploit",filter:o=>o.ownerId!==n&&st(o,"Threat",n)},sourceCard:e,sourceCoords:r})},{baseId:"codeKeeper",activationType:"commit",supportRequired:!0,getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:e,sourceCoords:r,payload:{filter:o=>o.ownerId!==n&&st(o,"Exploit",n)}})},{baseId:"centurion",activationType:"commit",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"SACRIFICE_AND_BUFF_LINES",filter:(o,a,s)=>{var l;return o.ownerId===n&&((l=o.types)==null?void 0:l.includes("Unit"))&&a!==void 0&&s!==void 0}}})},{baseId:"recklessProvocateur",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SWAP_POSITIONS",sourceCard:e,sourceCoords:r,payload:{filter:(o,a,s)=>Yr(a,s,r.row,r.col)}})},{baseId:"recklessProvocateur",activationType:"commit",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"TRANSFER_ALL_STATUSES",sourceCard:e,sourceCoords:r,payload:{filter:o=>o.id===e.id?!1:o.ownerId===n}})},{baseId:"dataLiberator",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1})},{baseId:"cautiousAvenger",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Aim",count:1,sourceCoords:r,mustBeInLineWithSource:!0})},{baseId:"cautiousAvenger",activationType:"setup",supportRequired:!0,getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:o=>st(o,"Aim",n)}})},{baseId:"inventiveMaker",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SPAWN_TOKEN",sourceCard:e,sourceCoords:r,payload:{tokenName:"Recon Drone"}})},{baseId:"inventiveMaker",activationType:"setup",supportRequired:!0,getAction:(e,t,n,r)=>({type:"OPEN_MODAL",mode:"RETRIEVE_DEVICE",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"faber",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"SELECT_HAND_FOR_DISCARD_THEN_SPAWN",tokenName:"Walking Turret",filter:o=>o.ownerId===n}})},{baseId:"censor",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1})},{baseId:"censor",activationType:"commit",supportRequired:!0,getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Stun",count:1,requiredTargetStatus:"Exploit",requireStatusFromSourceOwner:!0,sourceCoords:r})},{baseId:"princeps",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"PRINCEPS_SHIELD_THEN_AIM",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"princeps",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:o=>st(o,"Aim",n)}})},{baseId:"immunis",activationType:"deploy",supportRequired:!0,getAction:(e,t,n,r)=>st(e,"Support",n)?{type:"OPEN_MODAL",mode:"IMMUNIS_RETRIEVE",sourceCard:e,sourceCoords:r,payload:{filter:(o,a)=>Yr(o,a,r.row,r.col)}}:null},{baseId:"devoutSynthetic",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"RIOT_PUSH",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"devoutSynthetic",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:(o,a,s)=>Yr(a,s,r.row,r.col)&&o.ownerId!==n&&(st(o,"Threat",n)||st(o,"Stun",n))}})},{baseId:"unwaveringIntegrator",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1})},{baseId:"unwaveringIntegrator",activationType:"setup",supportRequired:!0,getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"INTEGRATOR_LINE_SELECT",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"signalProphet",activationType:"deploy",getAction:(e,t,n,r)=>({type:"GLOBAL_AUTO_APPLY",payload:{tokenType:"Exploit",filter:o=>o.ownerId===n&&st(o,"Support",n)},sourceCard:e,sourceCoords:r})},{baseId:"signalProphet",activationType:"commit",supportRequired:!0,getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:e,sourceCoords:r,payload:{filter:o=>o.ownerId===n&&st(o,"Exploit",n)}})},{baseId:"zealousMissionary",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1})},{baseId:"zealousMissionary",activationType:"commit",supportRequired:!0,getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"ZEALOUS_WEAKEN",sourceCard:e,sourceCoords:r,payload:{filter:o=>st(o,"Exploit",n)}})},{baseId:"walkingTurret",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Aim",count:1,mustBeInLineWithSource:!0,sourceCoords:r})},{baseId:"walkingTurret",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"MODIFY_POWER",amount:-1,filter:o=>st(o,"Aim",n)}})},{baseId:"reconDrone",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:e,sourceCoords:r,payload:{allowSelf:!1,range:"global"}})},{baseId:"reconDrone",activationType:"commit",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"REVEAL_ENEMY",sourceCard:e,sourceCoords:r,payload:{filter:(o,a,s)=>Yr(a,s,r.row,r.col)&&o.ownerId!==n}})},{baseId:"abrGawain",baseIdAlt:["autonomousBattleRobot"],activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"PRINCEPS_SHIELD_THEN_AIM",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"abrGawain",baseIdAlt:["autonomousBattleRobot"],activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:o=>st(o,"Aim",n)}})},{baseId:"reclaimedGawain",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SHIELD_SELF_THEN_RIOT_PUSH",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"reclaimedGawain",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:(o,a,s)=>Yr(a,s,r.row,r.col)&&o.ownerId!==n&&(st(o,"Threat",n)||st(o,"Stun",n))}})},{baseId:"FalkPD",activationType:"deploy",getAction:(e,t,n,r)=>({type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:e,payload:{filterType:"Any"}})},{baseId:"FalkPD",activationType:"commit",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Revealed",count:1,onlyFaceDown:!0,excludeOwnerId:n})},{baseId:"edithByron",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SHIELD_SELF_THEN_SPAWN",sourceCard:e,sourceCoords:r,payload:{tokenName:"Recon Drone"}})},{baseId:"edithByron",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"PATROL_MOVE",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"pinkunonekoSV",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Stun",count:1,onlyOpponents:!0,mustBeAdjacentToSource:!0,sourceCoords:r})},{baseId:"pinkunonekoSV",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:(o,a,s)=>Yr(a,s,r.row,r.col)&&(st(o,"Threat",n)||st(o,"Stun",n)),chainedAction:{type:"ENTER_MODE",mode:"SELECT_CELL",payload:{range:1,allowSelf:!0}}}})},{baseId:"EleftheriaMD",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Aim",count:1})},{baseId:"EleftheriaMD",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"DESTROY",filter:o=>st(o,"Aim",n)}})},{baseId:"ziusIJ",activationType:"deploy",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1})},{baseId:"ziusIJ",activationType:"setup",supportRequired:!0,getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:e,sourceCoords:r,recordContext:!0,chainedAction:{type:"ENTER_MODE",mode:"ZIUS_LINE_SELECT",sourceCard:e,sourceCoords:r,payload:{actionType:"ZIUS_SCORING"}}})},{baseId:"secretInformant",activationType:"deploy",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_DECK",sourceCard:e,sourceCoords:r,payload:{}})},{baseId:"reverendOfTheChoir",activationType:"setup",getAction:(e,t,n,r)=>({type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:e,sourceCoords:r})},{baseId:"luciusTheImmortal",activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:e,sourceCoords:r,payload:{actionType:"LUCIUS_SETUP",filter:o=>o.ownerId===n}})},{baseId:"finnMW",baseIdAlt:["finnSD"],activationType:"setup",getAction:(e,t,n,r)=>({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:e,sourceCoords:r,payload:{filter:o=>o.ownerId===n,range:2}})},{baseId:"finnMW",baseIdAlt:["finnSD"],activationType:"commit",getAction:(e,t,n,r)=>({type:"GLOBAL_AUTO_APPLY",payload:{customAction:"FINN_SCORING"},sourceCard:e,sourceCoords:r})}],Yp=e=>{const t=e.baseId||"";return Pg.filter(n=>{var r;return n.baseId===t||((r=n.baseIdAlt)==null?void 0:r.includes(t))})},Bl=(e,t,n,r)=>{var c;if(n!==e.ownerId)return!1;if(r&&e.ownerId!==void 0){const d=r.players.find(h=>h.id===e.ownerId);if(d!=null&&d.isDummy&&r.activePlayerId!==e.ownerId)return!1}if((c=e.statuses)!=null&&c.some(d=>d.type==="Stun"))return!1;const o=Yp(e),a=o.find(d=>d.activationType==="deploy");if(a&&Gi(e,Fl))return!(a.supportRequired&&!st(e,"Support",n));let s="",l=null;if(t===0?(s=qp,l="setup"):t===2&&(s=Jp,l="commit"),s&&l&&Gi(e,s)){const d=o.find(h=>h.activationType===l);if(d)return!(d.supportRequired&&!st(e,"Support",n))}return!1},Lg=(e,t,n,r)=>{if(n!==e.ownerId)if(e.ownerId!==void 0){const d=t.players.find(h=>h.id===e.ownerId);if(!(d!=null&&d.isDummy))return null}else return null;const o=Yp(e),a=e.ownerId??n??0;if(Gi(e,Fl)){const d=o.find(h=>h.activationType==="deploy");if(d){if(d.supportRequired&&!st(e,"Support",a))return null;const h=d.getAction(e,t,a,r);if(h)return{...h,isDeployAbility:!0,readyStatusToRemove:Fl}}}const s=t.currentPhase;let l="",c=null;if(s===0?(l=qp,c="setup"):s===2&&(l=Jp,c="commit"),l&&c&&Gi(e,l)){const d=o.find(h=>h.activationType===c);if(d){if(d.supportRequired&&!st(e,"Support",a))return null;const h=d.getAction(e,t,a,r);if(h)return{...h,readyStatusToRemove:l}}}return null},Gl="readyDeploy",Ta="readySetup",Ea="readyCommit",ia=(e,t)=>{if(!e)return!1;const n=e.toLowerCase(),r=t.toLowerCase();return n.includes(r)},Zp=(e,t,n)=>{let r,o;return typeof t=="object"?(r=t.currentPhase,n=t.activePlayerId??void 0,o=t):r=t,Bl(e,r,n??void 0,o)},Ms=(e,t)=>{e.statuses||(e.statuses=[]);const n=e.ability||"";ia(n,"deploy:")&&(e.statuses.some(r=>r.type===Gl)||e.statuses.push({type:Gl,addedByPlayerId:t})),ia(n,"setup:")&&(e.statuses.some(r=>r.type===Ta)||e.statuses.push({type:Ta,addedByPlayerId:t})),ia(n,"commit:")&&(e.statuses.some(r=>r.type===Ea)||e.statuses.push({type:Ea,addedByPlayerId:t}))},zs=e=>{e.statuses&&(e.statuses=e.statuses.filter(t=>t.type!==Gl&&t.type!==Ta&&t.type!==Ea))},Mg=(e,t)=>{e.statuses||(e.statuses=[]);const n=e.ability||"";ia(n,"setup:")&&(e.statuses.some(r=>r.type===Ta)||e.statuses.push({type:Ta,addedByPlayerId:t})),ia(n,"commit:")&&(e.statuses.some(r=>r.type===Ea)||e.statuses.push({type:Ea,addedByPlayerId:t}))},Us=p.memo(({type:e,playerId:t,count:n,refreshVersion:r,playerColorMap:o,smallStatusIcons:a=!1})=>{const s=o.get(t),l=s&&Vt[s]?Vt[s].bg:"bg-gray-500",c=p.useMemo(()=>{let A=Eo[e];if(A){const T=A.includes("?")?"&":"?";A=`${A}${T}v=${r}`}return A},[e,r]),d=["Support","Threat","Revealed","LastPlayed"].includes(e),h=!d&&n>1,k=h?"p-1.5":"p-1",g=a?"w-6 h-6":"w-8 h-8",b=a?h?"text-xs":"text-base":h?"text-base":"text-lg",x=a?"text-[10px]":"text-xs";return i.jsxs("div",{className:`relative ${g} flex items-center justify-center ${l} bg-opacity-80 rounded-sm shadow-md flex-shrink-0`,title:`${e} (Player ${t}) ${!d&&n>0?`x${n}`:""}`,children:[c?i.jsx("img",{src:c,alt:e,className:`object-contain w-full h-full transition-all duration-150 ${k}`}):i.jsx("span",{className:`text-white font-black transition-all duration-150 ${b}`,style:{textShadow:"0 0 2px black"},children:e.charAt(0)}),h&&i.jsx("span",{className:`absolute top-0 right-0.5 text-white font-bold ${x} leading-none`,style:{textShadow:"1px 1px 2px black"},children:n})]})}),zg=p.memo(({card:e,isFaceUp:t,playerColorMap:n,localPlayerId:r,imageRefreshVersion:o,disableTooltip:a=!1,smallStatusIcons:s=!1,activePhaseIndex:l,activePlayerId:c,disableActiveHighlights:d=!1,extraPowerSpacing:h=!1,hidePower:k=!1,preserveDeployAbilities:g=!1,activeAbilitySourceCoords:b=null,boardCoords:x=null,abilityCheckKey:A})=>{var _e;const{getCardTranslation:T}=Nt(),[u,m]=p.useState(!1),[f,D]=p.useState({x:0,y:0}),N=p.useRef(null),[_,O]=p.useState(!1),[M,I]=p.useState(!1),V=e.baseId?T(e.baseId):void 0,ce=V?{...e,...V}:e;p.useEffect(()=>{I(!1)},[l,A]),p.useEffect(()=>{d||I(!1)},[d]);const[we,ae]=p.useState(()=>{let Y=e.imageUrl;if(o&&Y){const Ae=Y.includes("?")?"&":"?";Y=`${Y}${Ae}v=${o}`}return Y});p.useEffect(()=>{let Y=e.imageUrl;if(o&&Y){const Ae=Y.includes("?")?"&":"?";Y=`${Y}${Ae}v=${o}`}ae(Y)},[e.imageUrl,o]);const De=()=>{let Y=e.fallbackImage;if(o&&Y){const Ae=Y.includes("?")?"&":"?";Y=`${Y}${Ae}v=${o}`}we!==Y&&ae(Y)},me=(_e=e.types)==null?void 0:_e.includes("Hero");p.useEffect(()=>{if(!me||!t){O(!1);return}let Y,Ae;const xe=()=>{const re=3e3+Math.random()*500;Y=window.setTimeout(()=>{O(!0),Ae=window.setTimeout(()=>{O(!1),xe()},750)},re)};return xe(),()=>{Y!==void 0&&window.clearTimeout(Y),Ae!==void 0&&window.clearTimeout(Ae)}},[me,t]);const ve=p.useCallback(Y=>{a||((Y.clientX!==0||Y.clientY!==0)&&D({x:Y.clientX,y:Y.clientY}),!u&&!N.current&&(N.current=window.setTimeout(()=>{m(!0)},250)))},[a,u]),Pe=p.useCallback(Y=>{a||((Y.clientX!==0||Y.clientY!==0)&&D({x:Y.clientX,y:Y.clientY}),N.current&&clearTimeout(N.current),N.current=window.setTimeout(()=>{m(!0)},250))},[a]),J=p.useCallback(()=>{N.current&&(clearTimeout(N.current),N.current=null),m(!1)},[]),z=p.useCallback(()=>{N.current&&(clearTimeout(N.current),N.current=null),m(!1)},[]),K=Zp(e,l??0,c),ne=x&&b&&x.row===b.row&&x.col===b.col,W=!d&&!M&&K&&!ne,he=p.useCallback(()=>{W&&r===e.ownerId&&I(!0)},[W,r,e.ownerId]),Ne=p.useMemo(()=>{const Y=["readyDeploy","readySetup","readyCommit"];return(e.statuses??[]).reduce((Ae,xe)=>{if(Y.includes(xe.type))return Ae;const re=`${xe.type}_${xe.addedByPlayerId}`;return Ae[re]||(Ae[re]={type:xe.type,playerId:xe.addedByPlayerId,count:0}),Ae[re].count++,Ae},{})},[e.statuses]),v=p.useMemo(()=>{const Y=e.ownerId?n.get(e.ownerId):null;return Y&&Vt[Y]?Vt[Y]:null},[e.ownerId,n]),L=p.useMemo(()=>Object.values(Ne).sort((Y,Ae)=>Y.type!==Ae.type?Y.type.localeCompare(Ae.type):Y.playerId-Ae.playerId),[Ne]),{currentPower:$,powerTextColor:ee}=p.useMemo(()=>{const Y=(e.powerModifier||0)+(e.bonusPower||0),Ae=Math.max(0,e.power+Y);let xe="text-white";return Y>0?xe="text-green-400":Y<0&&(xe="text-red-500"),{currentPower:Ae,powerTextColor:xe}},[e.power,e.powerModifier,e.bonusPower]),oe=p.useMemo(()=>u&&t&&!a&&f.x>0&&f.y>0,[u,t,a,f.x,f.y]);if(e.deck==="counter")return i.jsx("div",{title:ce.name,className:`w-full h-full ${e.color} shadow-md`,style:{clipPath:"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)"}});const Ie=h?"bottom-[10px] right-[10px]":"bottom-[5px] right-[5px]";return i.jsxs(i.Fragment,{children:[t?(()=>{var Ee;const Y=v?v.border:((Ee=zl[e.deck])==null?void 0:Ee.color)||"border-gray-300",Ae=e.deck===Be.Tokens?e.color:"bg-card-face",xe=(e.deck===Be.Tokens,"text-black"),re=["Support","Shield"],Re=L.filter(ie=>re.includes(ie.type)),Se=L.filter(ie=>!re.includes(ie.type)&&ie.type!=="LastPlayed"),de=L.find(ie=>ie.type==="LastPlayed"),q=de?[de,...Re]:Re,H=v?v.glow:"shadow-[0_0_15px_#ffffff]",Z=W?`border-[5px] shadow-2xl ${H}`:"border-4",G=e.ownerId?n.get(e.ownerId):null,le=G?bg[G]||{r:255,g:255,b:255}:null,je=W&&le?{background:`radial-gradient(circle at center, transparent 20%, rgba(${le.r}, ${le.g}, ${le.b}, 0.7) 100%)`,boxShadow:`inset 0 0 20px rgba(${le.r}, ${le.g}, ${le.b}, 0.6)`}:{};return i.jsxs("div",{onMouseEnter:Pe,onMouseLeave:J,onMouseMove:ve,onMouseDown:z,onClick:he,style:je,className:`relative w-full h-full ${Ae} rounded-md shadow-md ${Z} ${Y} ${xe} flex-shrink-0 select-none overflow-hidden transition-all duration-300 ${W?"scale-[1.10] z-10":""}`,children:[we?i.jsxs(i.Fragment,{children:[i.jsx("img",{src:we,onError:De,alt:ce.name,className:"absolute inset-0 w-full h-full object-cover"}),me&&i.jsx("div",{className:`absolute inset-0 hero-foil-overlay ${_?"animating":""}`})]}):i.jsx("div",{className:"w-full h-full p-1 flex items-center justify-center",children:i.jsx("span",{className:"text-center text-sm font-bold",children:ce.name})}),L.length>0&&i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"absolute top-[3px] left-[3px] right-[3px] flex flex-row-reverse flex-wrap justify-start items-start z-10 pointer-events-none",children:Se.map(ie=>i.jsx(Us,{type:ie.type,playerId:ie.playerId,count:ie.count,refreshVersion:o,playerColorMap:n,smallStatusIcons:s},`${ie.type}_${ie.playerId}`))}),i.jsx("div",{className:"absolute bottom-[3px] left-[3px] right-[30px] flex flex-wrap-reverse content-start items-end z-10 pointer-events-none",children:q.map(ie=>i.jsx(Us,{type:ie.type,playerId:ie.playerId,count:ie.count,refreshVersion:o,playerColorMap:n,smallStatusIcons:s},`${ie.type}_${ie.playerId}`))})]}),e.power>0&&!k&&i.jsx("div",{className:`absolute ${Ie} w-8 h-8 rounded-full ${v?v.bg:"bg-gray-600"} border-[3px] border-white flex items-center justify-center z-20 shadow-md`,children:i.jsx("span",{className:`${ee} font-bold text-lg leading-none`,style:{textShadow:"0 0 2px black"},children:$})})]})})():(()=>{const Y=v?v.bg:"bg-card-back",Ae=v?v.border:"border-blue-300",xe=L.find(re=>re.type==="LastPlayed");return i.jsx("div",{onMouseEnter:Pe,onMouseLeave:J,onMouseMove:ve,onMouseDown:z,className:`relative w-full h-full ${Y} rounded-md shadow-md border-2 ${Ae} flex-shrink-0 transition-transform duration-300 ${W?"scale-[1.10] z-10":""}`,children:xe&&i.jsx("div",{className:"absolute bottom-[3px] left-[3px] pointer-events-none",children:i.jsx(Us,{type:xe.type,playerId:xe.playerId,count:xe.count,refreshVersion:o,playerColorMap:n,smallStatusIcons:s})})})})(),oe&&i.jsx(Kp,{x:f.x,y:f.y,children:i.jsx(as,{card:ce})})]})}),Ug=(e,t)=>{var s,l,c,d,h,k,g,b;if(e.card.id!==t.card.id||e.isFaceUp!==t.isFaceUp||e.card.imageUrl!==t.card.imageUrl||e.card.fallbackImage!==t.card.fallbackImage||e.card.name!==t.card.name||e.card.deck!==t.card.deck||e.card.color!==t.card.color||e.card.baseId!==t.card.baseId)return!1;const n=e.card.types||[],r=t.card.types||[];if(n.length!==r.length)return!1;for(let x=0;x<n.length;x++)if(n[x]!==r[x])return!1;if(e.imageRefreshVersion!==t.imageRefreshVersion||e.smallStatusIcons!==t.smallStatusIcons||e.extraPowerSpacing!==t.extraPowerSpacing||e.hidePower!==t.hidePower||e.disableTooltip!==t.disableTooltip||e.disableActiveHighlights!==t.disableActiveHighlights||e.preserveDeployAbilities!==t.preserveDeployAbilities||e.activePhaseIndex!==t.activePhaseIndex||e.activePlayerId!==t.activePlayerId||e.localPlayerId!==t.localPlayerId||((s=e.activeAbilitySourceCoords)==null?void 0:s.row)!==((l=t.activeAbilitySourceCoords)==null?void 0:l.row)||((c=e.activeAbilitySourceCoords)==null?void 0:c.col)!==((d=t.activeAbilitySourceCoords)==null?void 0:d.col)||((h=e.boardCoords)==null?void 0:h.row)!==((k=t.boardCoords)==null?void 0:k.row)||((g=e.boardCoords)==null?void 0:g.col)!==((b=t.boardCoords)==null?void 0:b.col)||e.abilityCheckKey!==t.abilityCheckKey)return!1;const o=e.card.statuses||[],a=t.card.statuses||[];if(o.length!==a.length)return!1;for(let x=0;x<o.length;x++){const A=o[x],T=a[x];if(!T||A.type!==T.type||A.addedByPlayerId!==T.addedByPlayerId)return!1}return!(e.card.power!==t.card.power||e.card.powerModifier!==t.card.powerModifier||e.card.bonusPower!==t.card.bonusPower||e.card.ownerId!==t.card.ownerId||e.card.ownerId&&t.card.ownerId&&e.playerColorMap.get(e.card.ownerId)!==t.playerColorMap.get(t.card.ownerId))},Zt=p.memo(zg,Ug),Qp=p.memo(({row:e,col:t,cell:n,isGameStarted:r,handleDrop:o,draggedItem:a,setDraggedItem:s,openContextMenu:l,playMode:c,setPlayMode:d,playerColorMap:h,localPlayerId:k,onCardDoubleClick:g,onEmptyCellDoubleClick:b,imageRefreshVersion:x,cursorStack:A,currentPhase:T,activePlayerId:u,onCardClick:m,onEmptyCellClick:f,isValidTarget:D,showNoTarget:N,disableActiveHighlights:_,preserveDeployAbilities:O,abilitySourceCoords:M,abilityCheckKey:I})=>{const[V,ce]=p.useState(!1),we=p.useCallback(Y=>{Y.preventDefault(),a&&o(a,{target:"board",boardCoords:{row:e,col:t}}),ce(!1)},[a,o,e,t]),ae=p.useCallback(()=>{if(c){const Y={...c.sourceItem,card:{...c.sourceItem.card}};Y.card.isFaceDown=!!c.faceDown,o(Y,{target:"board",boardCoords:{row:e,col:t}}),d(null)}else n.card&&m?m(n.card,{row:e,col:t}):!n.card&&f&&f({row:e,col:t})},[c,n.card,m,f,o,d,e,t]),De=p.useCallback(Y=>{Y.preventDefault();const Ae=(a==null?void 0:a.source)==="counter_panel";(!n.card||n.card&&Ae)&&ce(!0)},[a,n.card]),me=p.useCallback(()=>{ce(!1)},[]),ve=p.useCallback(Y=>{n.card||l(Y,"emptyBoardCell",{boardCoords:{row:e,col:t}})},[n.card,l,e,t]),Pe=p.useCallback(()=>{n.card||b({row:e,col:t})},[n.card,b,e,t]),J=p.useCallback(()=>{n.card&&s({card:n.card,source:"board",boardCoords:{row:e,col:t},isManual:!0})},[n.card,s,e,t]),z=p.useCallback(Y=>{n.card&&l(Y,"boardItem",{card:n.card,boardCoords:{row:e,col:t}})},[n.card,l,e,t]),K=p.useCallback(Y=>{Y.stopPropagation(),!A&&n.card?g(n.card,{row:e,col:t}):ae()},[A,n.card,g,ae,e,t]),ne=!!c,W=!!A,he=!!n.card,Ne="w-full h-full rounded-lg transition-colors duration-200 flex items-center justify-center relative",v=!!a&&(!he||he&&a.source==="counter_panel"),ee=D||ne&&!he||W&&D,Ie=`bg-board-cell-active ${V&&v?"bg-indigo-400 opacity-80":""} ${ne&&he?"cursor-not-allowed":""} ${ee?"ring-4 ring-cyan-400 shadow-[0_0_15px_#22d3ee] cursor-pointer z-10":""}`,_e=p.useMemo(()=>{var Re;const Y=n.card;if(!Y)return!1;const Ae=Y.revealedTo==="all",xe=k!==null&&Array.isArray(Y.revealedTo)&&Y.revealedTo.includes(k),re=k!==null&&((Re=Y.statuses)==null?void 0:Re.some(Se=>Se.type==="Revealed"&&Se.addedByPlayerId===k));return!Y.isFaceDown||Ae||xe||re||!1},[n.card,k]);return i.jsxs("div",{onDrop:we,onDragOver:De,onDragLeave:me,onClick:ae,onContextMenu:ve,onDoubleClick:Pe,className:`${Ne} ${Ie}`,"data-interactive":!n.card,"data-board-coords":`${e},${t}`,children:[ee&&i.jsx("div",{className:"absolute inset-0 rounded-lg bg-cyan-400 bg-opacity-30 animate-pulse pointer-events-none z-10"}),N&&i.jsx("div",{className:"absolute inset-0 z-50 flex items-center justify-center pointer-events-none",children:i.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763978163/no_tarket_mic5sm.png",alt:"No Target",className:"w-24 h-24 object-contain animate-fade-out drop-shadow-[0_0_5px_rgba(255,0,0,0.8)]"})}),n.card&&i.jsx("div",{draggable:r,onDragStart:J,onDragEnd:()=>s(null),onContextMenu:z,onDoubleClick:K,className:`w-full h-full ${r?"cursor-grab":"cursor-default"} relative z-30`,"data-interactive":"true",children:i.jsx(Zt,{card:n.card,isFaceUp:_e,playerColorMap:h,localPlayerId:k,imageRefreshVersion:x,activePhaseIndex:T,activePlayerId:u,disableActiveHighlights:_,preserveDeployAbilities:O,activeAbilitySourceCoords:M,boardCoords:{row:e,col:t},abilityCheckKey:I})},n.card.id)]})});Qp.displayName="GridCell";const vc={4:"grid-cols-4 grid-rows-4",5:"grid-cols-5 grid-rows-5",6:"grid-cols-6 grid-rows-6",7:"grid-cols-7 grid-rows-7"},Xp=p.memo(({textData:e,playerColorMap:t})=>{const n=p.useMemo(()=>{const r=t.get(e.playerId);return r&&gc[r]?gc[r]:"text-white"},[t,e.playerId]);return i.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-[60] animate-float-up",children:i.jsx("span",{className:`text-4xl font-black ${n}`,style:{textShadow:"2px 2px 0 #000"},children:e.text})})});Xp.displayName="FloatingTextOverlay";const em=p.memo(({board:e,isGameStarted:t,activeGridSize:n,handleDrop:r,draggedItem:o,setDraggedItem:a,openContextMenu:s,playMode:l,setPlayMode:c,highlight:d,playerColorMap:h,localPlayerId:k,onCardDoubleClick:g,onEmptyCellDoubleClick:b,imageRefreshVersion:x,cursorStack:A,currentPhase:T,activePlayerId:u,onCardClick:m,onEmptyCellClick:f,validTargets:D,noTargetOverlay:N,disableActiveHighlights:_,preserveDeployAbilities:O=!1,activeFloatingTexts:M,abilitySourceCoords:I=null,abilityCheckKey:V})=>{const ce=p.useMemo(()=>{const De=e.length,me=Math.floor((De-n)/2);return e.slice(me,me+n).map(ve=>ve.slice(me,me+n))},[e,n]),we=p.useMemo(()=>{if(!d)return null;const{type:De,row:me,col:ve,playerId:Pe}=d,J=h.get(Pe),K=`outline outline-[8px] ${J&&Vt[J]?Vt[J].outline:"outline-yellow-400"} rounded-lg`,ne=e.length,W=Math.floor((ne-n)/2);if(De==="row"&&me!==void 0&&me>=W&&me<W+n){const he=me-W+1;return i.jsx("div",{className:K,style:{gridArea:`${he} / 1 / ${he+1} / ${n+1}`}})}if(De==="col"&&ve!==void 0&&ve>=W&&ve<W+n){const he=ve-W+1;return i.jsx("div",{className:K,style:{gridArea:`1 / ${he} / ${n+1} / ${he+1}`}})}if(De==="cell"&&me!==void 0&&ve!==void 0&&me>=W&&me<W+n&&ve>=W&&ve<W+n){const he=me-W+1,Ne=ve-W+1;return i.jsx("div",{className:K,style:{gridArea:`${he} / ${Ne} / ${he+1} / ${Ne+1}`}})}return null},[d,h,n,e.length]),ae=p.useMemo(()=>{const De=e.length,me=Math.floor((De-n)/2),ve=new Set((D==null?void 0:D.map(Pe=>`${Pe.row}-${Pe.col}`))||[]);return ce.map((Pe,J)=>Pe.map((z,K)=>{const ne=J+me,W=K+me,he=`${ne}-${W}`;return{cellKey:he,originalRowIndex:ne,originalColIndex:W,cell:z,isValidTarget:ve.has(he),isNoTarget:(N==null?void 0:N.row)===ne&&N.col===W,cellFloatingTexts:(M==null?void 0:M.filter(Ne=>Ne.row===ne&&Ne.col===W))||[]}}))},[ce,e.length,n,D,N,M]);return i.jsxs("div",{className:"relative p-2 bg-board-bg rounded-xl shadow-2xl h-full aspect-square transition-all duration-300",children:[i.jsx("div",{className:`grid ${vc[n]} gap-0.5 h-full w-full`,children:ae.map(De=>De.map(({cellKey:me,originalRowIndex:ve,originalColIndex:Pe,cell:J,isValidTarget:z,isNoTarget:K,cellFloatingTexts:ne})=>i.jsxs("div",{className:"relative w-full h-full",children:[i.jsx(Qp,{row:ve,col:Pe,cell:J,isGameStarted:t,handleDrop:r,draggedItem:o,setDraggedItem:a,openContextMenu:s,playMode:l,setPlayMode:c,playerColorMap:h,localPlayerId:k,onCardDoubleClick:g,onEmptyCellDoubleClick:b,imageRefreshVersion:x,cursorStack:A,currentPhase:T,activePlayerId:u,onCardClick:m,onEmptyCellClick:f,isValidTarget:z,showNoTarget:K,disableActiveHighlights:_,preserveDeployAbilities:O,abilitySourceCoords:I,abilityCheckKey:V}),ne.map(W=>i.jsx(Xp,{textData:W,playerColorMap:h},W.id||`${W.row}-${W.col}-${W.timestamp}`))]},me)))}),d&&i.jsx("div",{className:`absolute top-2 right-2 bottom-2 left-2 grid ${vc[n]} gap-0.5 pointer-events-none z-20`,children:we})]})});em.displayName="GameBoard";const co=60,tm=e=>{if(typeof e.deckName!="string"||!Array.isArray(e.cards))return{isValid:!1,error:"Invalid file structure. Must have 'deckName' (string) and 'cards' (array)."};let t=0;for(const r of e.cards){if(typeof r.cardId!="string"||typeof r.quantity!="number"||r.quantity<1||!Number.isInteger(r.quantity))return{isValid:!1,error:`Invalid card entry: ${JSON.stringify(r)}`};if(!Fi(r.cardId))return{isValid:!1,error:`Card with ID '${r.cardId}' does not exist.`};t+=r.quantity}if(t>co)return{isValid:!1,error:`Deck exceeds the ${co} card limit (found ${t} cards).`};const n=e.cards.map(r=>({cardId:r.cardId,quantity:r.quantity}));return{isValid:!0,deckFile:{deckName:e.deckName,cards:n}}},Fg=p.memo(({player:e,canEditSettings:t,selectedColors:n,onColorChange:r})=>{const[o,a]=p.useState(!1),s=p.useRef(null);return p.useEffect(()=>{const l=c=>{s.current&&!s.current.contains(c.target)&&a(!1)};return o&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[o]),t?i.jsxs("div",{className:"relative",ref:s,children:[i.jsx("button",{onClick:()=>a(!o),className:`w-9 h-9 rounded-md ${Vt[e.color].bg} border-2 border-gray-600 hover:border-white transition-all shadow-md flex items-center justify-center group flex-shrink-0`,title:"Change Color",children:i.jsx("svg",{className:"w-4 h-4 text-white/60 group-hover:text-white transition-colors drop-shadow-md",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M19 9l-7 7-7-7"})})}),o&&i.jsx("div",{className:"absolute top-full left-0 mt-2 p-2 bg-gray-800 border border-gray-600 rounded-lg shadow-xl z-50 grid grid-cols-4 gap-2 w-max animate-fade-in",children:Object.keys(Vt).map(l=>{const c=l,d=n.has(c)&&e.color!==c,h=e.color===c;return i.jsx("button",{onClick:()=>{d||(r(c),a(!1))},disabled:d,className:`w-8 h-8 rounded-md ${Vt[c].bg} border-2 ${h?"border-white ring-1 ring-white scale-110":d?"border-transparent opacity-20 cursor-not-allowed":"border-transparent hover:border-white hover:scale-110 hover:shadow-lg"} transition-all duration-150`,title:c},c)})})]}):i.jsx("div",{className:`w-9 h-9 rounded-md ${Vt[e.color].bg} border border-white/30 shadow-md flex-shrink-0`})}),nr=({onDrop:e,className:t,isOverClassName:n,children:r,onContextMenu:o})=>{const[a,s]=p.useState(!1);return i.jsx("div",{onDragOver:l=>{l.preventDefault(),s(!0)},onDragLeave:()=>s(!1),onDrop:l=>{l.preventDefault(),l.stopPropagation(),s(!1),e()},onContextMenu:o,className:`${t||""} ${a&&n||""}`,children:r})},Bg=({score:e,onChange:t,canEdit:n})=>i.jsxs("div",{className:"w-full h-full bg-gray-800 rounded flex flex-col items-center justify-between text-white select-none overflow-hidden py-0.5",children:[i.jsx("button",{onClick:()=>n&&t(1),disabled:!n,className:"flex-1 w-full flex items-center justify-center bg-gray-700 hover:bg-gray-600 active:bg-gray-500 transition-colors text-[10px] font-bold disabled:opacity-50 disabled:cursor-default leading-none",children:"+"}),i.jsx("div",{className:"flex-shrink-0 flex items-center justify-center font-bold text-sm bg-gray-800 w-full py-0.5",children:e}),i.jsx("button",{onClick:()=>n&&t(-1),disabled:!n,className:"flex-1 w-full flex items-center justify-center bg-gray-700 hover:bg-gray-600 active:bg-gray-500 transition-colors text-[10px] font-bold disabled:opacity-50 disabled:cursor-default leading-none",children:"-"})]}),xc=({label:e,count:t,onClick:n,children:r,className:o})=>i.jsx("div",{onClick:n,className:`w-full h-full rounded flex flex-col items-center justify-center cursor-pointer hover:ring-2 ring-indigo-400 transition-all shadow-sm select-none text-white border border-gray-600 relative overflow-hidden ${o||""}`,children:r||i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-[9px] font-bold mb-0.5 opacity-80 uppercase tracking-tighter",children:e}),i.jsx("span",{className:"text-base font-bold",children:t})]})}),wc=p.memo(({player:e,isLocalPlayer:t,localPlayerId:n,isGameStarted:r,onNameChange:o,onColorChange:a,onScoreChange:s,onDeckChange:l,onLoadCustomDeck:c,onDrawCard:d,handleDrop:h,draggedItem:k,setDraggedItem:g,openContextMenu:b,onHandCardDoubleClick:x,playerColorMap:A,allPlayers:T,localPlayerTeamId:u,activePlayerId:m,onToggleActivePlayer:f,imageRefreshVersion:D,layoutMode:N,onCardClick:_,validHandTargets:O,onAnnouncedCardDoubleClick:M,currentPhase:I,disableActiveHighlights:V,preserveDeployAbilities:ce=!1,roundWinners:we,startingPlayerId:ae,onDeckClick:De,isDeckSelectable:me})=>{const{t:ve,resources:Pe}=Nt(),J=p.useRef(null),z=t||!!e.isDummy,K=m===e.id,ne=u!==void 0&&e.teamId===u&&!t,W=!!e.isDisconnected,he=Gp(),Ne=new Set(T.map(xe=>xe.color)),v=we?Object.values(we).filter(xe=>xe.includes(e.id)).length:0,L=ae===e.id,$=yc.FIRST_PLAYER,ee=yc.ROUND_WIN_MEDAL,oe=K&&I===0,Ie=xe=>{l(xe.target.value)},_e=xe=>{var Se;const re=(Se=xe.target.files)==null?void 0:Se[0];if(!re)return;const Re=new FileReader;Re.onload=de=>{var q;try{const H=JSON.parse((q=de.target)==null?void 0:q.result),Z=tm(H);if(!Z.isValid){console.error("Failed to load deck:",Z.error);return}const{deckFile:G}=Z;c(G)}catch(H){console.error("Failed to parse deck file",H)}},Re.readAsText(re)},Y=()=>{var xe;(xe=J.current)==null||xe.click()},Ae=()=>{me&&De?De(e.id):z&&d()};if(N==="list-local"){const xe=K?"border-yellow-400":"border-gray-700";return i.jsxs("div",{className:`w-full h-full flex flex-col p-4 bg-panel-bg border-2 ${xe} rounded-lg shadow-2xl ${W?"opacity-60":""}`,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-[3px] flex-shrink-0 relative z-50",children:[i.jsx(Fg,{player:e,canEditSettings:!r&&z,selectedColors:Ne,onColorChange:a}),i.jsxs("div",{className:"flex-grow relative flex items-center min-w-0",children:[i.jsx("input",{type:"text",value:e.name,onChange:re=>o(re.target.value),readOnly:r||!z,className:"bg-transparent font-bold text-xl p-1 flex-grow focus:bg-gray-800 rounded focus:outline-none border-b border-gray-600 mr-3 text-white truncate"}),L&&i.jsx("img",{src:$,alt:"First Player",className:"w-6 h-6 drop-shadow-md mr-3 flex-shrink-0",title:"First Player"}),v>0&&Array.from({length:v}).map((re,Re)=>i.jsx("img",{src:ee,alt:"Round Winner",className:"w-6 h-6 drop-shadow-md mr-2 flex-shrink-0",title:"Round Winner"},`win-${Re}`)),i.jsx("input",{type:"checkbox",checked:K,onChange:()=>f(e.id),disabled:!t&&!e.isDummy,className:`w-6 h-6 text-yellow-400 bg-gray-700 border-gray-600 rounded flex-shrink-0 ${!t&&!e.isDummy?"cursor-default":"cursor-pointer"}`,title:"Active Player"})]})]}),i.jsx("div",{className:"bg-gray-800 p-1 rounded-lg mb-1 flex-shrink-0",children:i.jsxs("div",{className:"grid grid-cols-4 gap-1 sm:gap-2",children:[i.jsx(nr,{className:"relative",onDrop:()=>k&&h(k,{target:"deck",playerId:e.id,deckPosition:"top"}),onContextMenu:re=>b(re,"deckPile",{player:e}),children:i.jsxs("div",{onClick:Ae,className:`aspect-square bg-card-back rounded flex flex-col items-center justify-center cursor-pointer hover:ring-2 ring-indigo-400 transition-all shadow-md select-none text-white border-2 border-transparent ${oe?"animate-deck-start":""} ${me?"ring-4 ring-sky-400 shadow-[0_0_15px_#38bdf8] animate-pulse":""}`,children:[i.jsx("span",{className:"text-[10px] sm:text-xs font-bold mb-0.5 uppercase tracking-tight",children:ve("deck")}),i.jsx("span",{className:"text-base sm:text-lg font-bold",children:e.deck.length})]})}),i.jsx(nr,{onDrop:()=>k&&h(k,{target:"discard",playerId:e.id}),onContextMenu:re=>b(re,"discardPile",{player:e}),isOverClassName:"bg-indigo-600 ring-2",children:i.jsxs("div",{className:"aspect-square bg-gray-700 rounded flex flex-col items-center justify-center cursor-pointer hover:bg-gray-600 transition-all shadow-md border border-gray-600 select-none text-white",children:[i.jsx("span",{className:"text-[10px] sm:text-xs font-bold mb-0.5 text-gray-400 uppercase tracking-tight",children:ve("discard")}),i.jsx("span",{className:"text-base sm:text-lg font-bold",children:e.discard.length})]})}),i.jsx(nr,{onDrop:()=>k&&h(k,{target:"announced",playerId:e.id}),children:i.jsx("div",{className:"aspect-square bg-gray-800 border border-dashed border-gray-600 rounded flex items-center justify-center relative overflow-hidden",children:e.announcedCard?i.jsx("div",{className:"w-full h-full p-1 cursor-pointer",draggable:z,onDragStart:()=>z&&g({card:e.announcedCard,source:"announced",playerId:e.id,isManual:!0}),onDragEnd:()=>g(null),onContextMenu:re=>z&&e.announcedCard&&b(re,"announcedCard",{card:e.announcedCard,player:e}),onDoubleClick:()=>M==null?void 0:M(e,e.announcedCard),children:i.jsx(Zt,{card:e.announcedCard,isFaceUp:!0,playerColorMap:A,imageRefreshVersion:D,activePhaseIndex:I,activePlayerId:m,disableActiveHighlights:V,preserveDeployAbilities:ce})}):i.jsx("span",{className:"text-[10px] sm:text-xs font-bold text-gray-500 select-none uppercase tracking-tight",children:ve("showcase")})})}),i.jsxs("div",{className:"flex flex-col items-center justify-between h-full select-none text-white gap-1",children:[i.jsx("button",{onClick:()=>s(1),className:"flex-1 w-full bg-gray-700 rounded font-bold hover:bg-gray-600 flex items-center justify-center text-base sm:text-lg transition-colors",children:"+"}),i.jsx("span",{className:"font-bold text-lg sm:text-xl flex items-center justify-center flex-1",children:e.score}),i.jsx("button",{onClick:()=>s(-1),className:"flex-1 w-full bg-gray-700 rounded font-bold hover:bg-gray-600 flex items-center justify-center text-base sm:text-lg transition-colors",children:""})]})]})}),!r&&z&&i.jsxs("div",{className:"mb-[3px] flex-shrink-0 text-white",children:[i.jsxs("select",{value:e.selectedDeck,onChange:Ie,className:"w-full bg-gray-700 border border-gray-600 rounded p-2 mb-2",children:[he.map(re=>i.jsx("option",{value:re.id,children:Pe.deckNames[re.id]||re.name},re.id)),i.jsx("option",{value:Be.Custom,children:ve("customDeck")})]}),e.selectedDeck===Be.Custom&&i.jsxs("div",{className:"flex gap-2",children:[i.jsx("input",{type:"file",ref:J,onChange:_e,accept:".json",className:"hidden"}),i.jsx("button",{onClick:Y,className:"w-full bg-indigo-600 hover:bg-indigo-700 py-1 rounded font-bold",children:ve("loadDeck")})]})]}),i.jsx("div",{className:"flex-grow flex flex-col min-h-0",children:i.jsx(nr,{onDrop:()=>k&&h(k,{target:"hand",playerId:e.id}),className:"flex-grow bg-gray-800 rounded-lg p-2 overflow-y-scroll border border-gray-700 custom-scrollbar",children:i.jsx("div",{className:"flex flex-col gap-[2px]",children:e.hand.map((re,Re)=>{const de=(O==null?void 0:O.some(q=>q.playerId===e.id&&q.cardIndex===Re))?"ring-4 ring-cyan-400 shadow-[0_0_15px_#22d3ee] rounded-md z-10":"";return i.jsxs("div",{className:`flex bg-gray-900 border border-gray-700 rounded p-2 ${de}`,draggable:z,onDragStart:()=>z&&g({card:re,source:"hand",playerId:e.id,cardIndex:Re,isManual:!0}),onDragEnd:()=>g(null),onContextMenu:q=>z&&b(q,"handCard",{card:re,player:e,cardIndex:Re}),onDoubleClick:()=>x(e,re,Re),onClick:()=>_==null?void 0:_(e,re,Re),"data-hand-card":`${e.id},${Re}`,"data-interactive":"true",children:[i.jsx("div",{className:"w-[120px] h-[120px] flex-shrink-0 mr-3",children:i.jsx(Zt,{card:re,isFaceUp:!0,playerColorMap:A,localPlayerId:n,imageRefreshVersion:D,disableTooltip:!0,disableActiveHighlights:V,preserveDeployAbilities:ce})}),i.jsx("div",{className:"flex-grow min-w-0",children:i.jsx(as,{card:re,className:"relative flex flex-col text-left w-full h-full justify-start whitespace-normal break-words",hideOwner:re.ownerId===e.id})})]},`${re.id}-${Re}`)})})})})]})}if(N==="list-remote"){const xe=K?"border-yellow-400":"border-gray-700";return i.jsxs("div",{className:`w-full h-full flex flex-col p-1 pt-[1px] bg-panel-bg border-2 ${xe} rounded-lg shadow-xl ${W?"opacity-60":""} overflow-hidden`,children:[i.jsxs("div",{className:"flex items-center gap-2 mb-0 px-2 flex-shrink-0 min-h-[25px] mt-[2px]",children:[i.jsx("div",{className:`w-[18px] h-[18px] rounded-sm ${Vt[e.color].bg} shadow-sm border border-white/20`}),i.jsx("span",{className:"font-bold text-white text-[14px] truncate leading-none pt-0.5 max-w-[120px]",children:e.name}),!r&&e.isDummy&&z&&i.jsxs("select",{value:e.selectedDeck,onChange:Ie,className:"text-sm bg-gray-700 text-white border border-gray-600 rounded px-1 py-0 h-6 w-[135px] focus:outline-none truncate",children:[he.map(re=>i.jsx("option",{value:re.id,children:Pe.deckNames[re.id]||re.name},re.id)),i.jsx("option",{value:Be.Custom,children:ve("customDeck")})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex items-center gap-1",children:[L&&i.jsx("img",{src:$,className:"w-5 h-5",title:"First Player"}),v>0&&i.jsxs("span",{className:"text-yellow-500 text-base font-bold",children:["",v]}),i.jsx("input",{type:"checkbox",checked:K,onChange:()=>f(e.id),disabled:!z,className:"w-4 h-4 text-yellow-400 bg-gray-700 border-gray-600 rounded cursor-pointer flex-shrink-0 accent-yellow-500",title:"Active Player"})]})]}),i.jsxs("div",{className:"flex flex-col flex-1 min-h-0 overflow-hidden",children:[i.jsxs("div",{className:"flex items-center gap-1 px-2 mb-2 h-[77px] flex-shrink-0 mt-[2px]",children:[i.jsx(nr,{className:"h-full aspect-square relative",onDrop:()=>k&&h(k,{target:"deck",playerId:e.id,deckPosition:"top"}),onContextMenu:re=>b(re,"deckPile",{player:e}),children:i.jsx(xc,{label:ve("deck"),count:e.deck.length,onClick:Ae,className:`bg-card-back ${oe?"animate-deck-start":""} ${me?"ring-4 ring-sky-400 shadow-[0_0_15px_#38bdf8] animate-pulse":""}`})}),i.jsx(nr,{className:"h-full aspect-square relative",onDrop:()=>k&&h(k,{target:"discard",playerId:e.id}),onContextMenu:re=>b(re,"discardPile",{player:e}),isOverClassName:"ring-2 ring-indigo-500",children:i.jsx(xc,{label:ve("discard"),count:e.discard.length,className:"bg-gray-700"})}),i.jsx(nr,{className:"h-full aspect-square relative",onDrop:()=>k&&h(k,{target:"announced",playerId:e.id}),children:i.jsx("div",{className:"w-full h-full bg-gray-800 border border-dashed border-gray-600 rounded flex items-center justify-center relative overflow-hidden",children:e.announcedCard?i.jsx("div",{className:"w-full h-full",draggable:z,onDragStart:()=>z&&g({card:e.announcedCard,source:"announced",playerId:e.id,isManual:!0}),onDragEnd:()=>g(null),onContextMenu:re=>e.announcedCard&&b(re,"announcedCard",{card:e.announcedCard,player:e}),onDoubleClick:()=>M==null?void 0:M(e,e.announcedCard),children:i.jsx(Zt,{card:e.announcedCard,isFaceUp:!0,playerColorMap:A,imageRefreshVersion:D,disableTooltip:!1,disableActiveHighlights:V,preserveDeployAbilities:ce})}):i.jsx("span",{className:"text-[9px] font-bold text-gray-500 select-none uppercase",children:"SHOW"})})}),i.jsx("div",{className:"flex-1"}),i.jsx("div",{className:"h-full w-[33px]",children:i.jsx(Bg,{score:e.score,onChange:s,canEdit:z})})]}),i.jsx(nr,{onDrop:()=>k&&h(k,{target:"hand",playerId:e.id}),className:"grid grid-cols-6 gap-1 px-2 overflow-y-scroll custom-scrollbar flex-grow content-start min-h-[30px]",children:e.hand.map((re,Re)=>{var ie;const de=(O==null?void 0:O.some(ke=>ke.playerId===e.id&&ke.cardIndex===Re))?"ring-2 ring-cyan-400 shadow-[0_0_8px_#22d3ee] rounded-md z-10":"",q=re.revealedTo==="all",H=n!==null&&Array.isArray(re.revealedTo)&&re.revealedTo.includes(n),Z=n!==null&&((ie=re.statuses)==null?void 0:ie.some(ke=>ke.type==="Revealed"&&ke.addedByPlayerId===n)),G=T.find(ke=>ke.id===re.ownerId),le=G==null?void 0:G.isDummy,Ee=n===re.ownerId||!!le||ne||q||!!H||!!Z;return i.jsx("div",{className:`aspect-square relative ${de}`,draggable:z,onDragStart:()=>z&&g({card:re,source:"hand",playerId:e.id,cardIndex:Re,isManual:!0}),onDragEnd:()=>g(null),onContextMenu:ke=>{ke.preventDefault(),ke.stopPropagation(),b(ke,"handCard",{card:re,player:e,cardIndex:Re})},onDoubleClick:()=>x(e,re,Re),onClick:()=>_==null?void 0:_(e,re,Re),"data-hand-card":`${e.id},${Re}`,"data-interactive":"true",children:i.jsx("div",{className:"w-full h-full",children:i.jsx(Zt,{card:re,isFaceUp:Ee,playerColorMap:A,localPlayerId:n,imageRefreshVersion:D,disableTooltip:!Ee,disableActiveHighlights:V,smallStatusIcons:!0,preserveDeployAbilities:ce})})},`${re.id}-${Re}`)})}),e.hand.length===0&&i.jsx("div",{className:"text-center text-gray-600 text-[10px] mt-2 italic",children:ve("emptyHand")})]})]})}return null}),nm=p.memo(({connectionStatus:e,t})=>{const n=p.useMemo(()=>{switch(e){case"Connected":return{color:"bg-green-500 animate-pulse",text:t("connected")};case"Disconnected":return{color:"bg-red-500",text:t("disconnected")};default:return{color:"bg-gray-500",text:t("loading")}}},[e,t]);return i.jsxs("div",{className:"flex items-center space-x-2",title:n.text,children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${n.color} transition-colors`}),i.jsx("span",{className:"text-sm text-gray-400 hidden sm:block",children:n.text})]})});nm.displayName="StatusIndicator";const rm=p.memo(({currentRound:e,turnNumber:t,onMouseEnter:n,onMouseLeave:r,showTooltip:o,t:a})=>{const s=p.useMemo(()=>e*10+10,[e]);return i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"flex items-center bg-gray-800 rounded-lg px-3 py-1.5 border border-gray-700 shadow-md cursor-help",onMouseEnter:n,onMouseLeave:r,children:[i.jsxs("span",{className:"text-yellow-500 font-bold text-sm tracking-wider",children:[a("round").toUpperCase()," ",e]}),i.jsx("span",{className:"text-gray-500 mx-2",children:"|"}),i.jsxs("span",{className:"text-gray-300 text-xs font-mono",children:[a("turn").toUpperCase()," ",t]})]}),o&&i.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 mt-2 z-[100] bg-gray-900 text-white p-3 rounded-lg shadow-xl border border-gray-700 text-sm whitespace-nowrap min-w-max",children:i.jsxs("div",{className:"text-center",children:[i.jsxs("p",{className:"font-bold text-yellow-400 mb-1 whitespace-nowrap",children:[a("round")," ",e," ",a("roundVictoryCondition")]}),i.jsxs("p",{className:"whitespace-nowrap",children:[a("reach")," ",i.jsxs("span",{className:"font-bold text-white",children:[s," ",a("scorePoints")]})," ",a("toWinRound")]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:a("checkedAtFirstPlayer")})]})})]})});rm.displayName="RoundTracker";const Gg=p.memo(({gameId:e,isGameStarted:t,onStartGame:n,onResetGame:r,activeGridSize:o,onGridSizeChange:a,dummyPlayerCount:s,onDummyPlayerCountChange:l,realPlayerCount:c,connectionStatus:d,onExitGame:h,onOpenTokensModal:k,onOpenCountersModal:g,gameMode:b,onGameModeChange:x,isPrivate:A,onPrivacyChange:T,isHost:u,onSyncGame:m,currentPhase:f,onNextPhase:D,onPrevPhase:N,isAutoAbilitiesEnabled:_,onToggleAutoAbilities:O,isAutoDrawEnabled:M,onToggleAutoDraw:I,isScoringStep:V,currentRound:ce=1,turnNumber:we=1})=>{const{t:ae}=Nt(),De=p.useMemo(()=>[0,1,2,3],[]),[me,ve]=p.useState(!1),Pe=p.useCallback(()=>{ve(!0)},[]),J=p.useCallback(()=>{ve(!1)},[]);return i.jsxs("header",{className:"fixed top-0 left-0 right-0 h-14 bg-panel-bg bg-opacity-80 backdrop-blur-sm z-50 flex items-center justify-between px-4 shadow-lg",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("h1",{className:"text-xl font-bold text-indigo-400 hidden lg:block",children:ae("newAvalon")}),i.jsx(nm,{connectionStatus:d,t:ae}),i.jsxs("div",{className:"flex items-center space-x-3",children:[e&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("span",{className:"text-sm text-gray-400 hidden md:inline",children:"ID:"}),i.jsx("span",{className:"font-mono bg-gray-700 px-2 py-1 rounded text-indigo-300 w-24 md:w-44 text-center truncate",children:e})]}),i.jsxs("label",{className:"flex items-center space-x-1.5 cursor-pointer hidden md:flex",title:ae("hiddenGameTooltip"),children:[i.jsx("input",{type:"checkbox",checked:A,onChange:z=>T(z.target.checked),disabled:t||!u,className:"w-4 h-4 text-indigo-600 bg-gray-700 border-gray-600 rounded focus:ring-indigo-500 disabled:opacity-70 disabled:cursor-not-allowed"}),i.jsx("span",{className:"text-sm text-gray-300",children:ae("hidden")})]}),i.jsx("span",{className:"text-gray-600 hidden md:inline",children:"|"}),i.jsx("button",{onClick:k,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-3 rounded text-sm",children:ae("tokens")}),i.jsx("button",{onClick:g,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-3 rounded text-sm",children:ae("counters")})]})]}),t&&i.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-2",children:[i.jsx(rm,{currentRound:ce,turnNumber:we,onMouseEnter:Pe,onMouseLeave:J,showTooltip:me,t:ae}),i.jsxs("div",{className:"flex items-center bg-gray-800 rounded-lg p-1 border border-gray-700 shadow-md",children:[i.jsx("button",{onClick:N,className:"w-8 h-8 flex items-center justify-center text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors",children:i.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M15 6 L8 12 L15 18 Z"})})}),i.jsx("div",{className:"bg-gray-800 text-white font-bold text-sm text-center px-2 min-w-[120px] uppercase",children:V?i.jsx("span",{className:"text-yellow-400 animate-pulse",children:ae("scoring")}):Ul[f]}),i.jsx("button",{onClick:D,className:"w-8 h-8 flex items-center justify-center text-gray-300 hover:text-white hover:bg-gray-700 rounded transition-colors",children:i.jsx("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"currentColor",children:i.jsx("path",{d:"M9 6 L16 12 L9 18 Z"})})})]})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[t&&i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("button",{onClick:()=>O(!_),className:`w-10 h-10 font-bold rounded text-sm flex items-center justify-center transition-colors ${_?"bg-gray-600 hover:bg-gray-700 text-white border-2 border-green-500":"bg-gray-700 hover:bg-gray-600 text-gray-400 border-2 border-gray-600"}`,title:ae("autoAbilitiesTooltip"),"aria-label":ae("autoAbility"),children:"AA"}),i.jsx("button",{onClick:()=>I(!M),className:`w-10 h-10 font-bold rounded text-sm flex items-center justify-center transition-colors ${M?"bg-gray-600 hover:bg-gray-700 text-white border-2 border-green-500":"bg-gray-700 hover:bg-gray-600 text-gray-400 border-2 border-gray-600"}`,title:ae("autoDrawTooltip"),"aria-label":ae("autoDraw"),children:"AD"})]}),t?u&&i.jsx("button",{onClick:r,className:"bg-yellow-600 hover:bg-yellow-700 text-white font-bold py-2 px-4 rounded text-sm hidden md:block",children:ae("newGame")}):i.jsx("button",{onClick:n,disabled:!u,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded text-sm animate-pulse disabled:bg-gray-600 disabled:opacity-70 disabled:cursor-not-allowed disabled:animate-none",children:ae("startGame")}),i.jsxs("div",{className:"flex items-center space-x-2 hidden lg:flex",children:[i.jsxs("label",{htmlFor:"game-mode",className:"text-sm font-medium text-gray-300",children:[ae("mode"),":"]}),i.jsxs("select",{id:"game-mode",value:b,onChange:z=>x(z.target.value),disabled:t||!u,className:"bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2 disabled:opacity-70",children:[i.jsx("option",{value:vr.FreeForAll,children:ae("ffa")}),i.jsx("option",{value:vr.TwoVTwo,children:ae("team2v2")}),i.jsx("option",{value:vr.ThreeVOne,children:ae("team3v1")})]})]}),i.jsxs("div",{className:"flex items-center space-x-2 hidden xl:flex",children:[i.jsxs("label",{htmlFor:"grid-size",className:"text-sm font-medium text-gray-300",children:[ae("size"),":"]}),i.jsxs("select",{id:"grid-size",value:o,onChange:z=>a(parseInt(z.target.value,10)),disabled:t||!u,className:"bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2 disabled:opacity-70",children:[i.jsx("option",{value:"4",children:"4x4"}),i.jsx("option",{value:"5",children:"5x5"}),i.jsx("option",{value:"6",children:"6x6"}),i.jsx("option",{value:"7",children:"7x7"})]})]}),i.jsxs("div",{className:"flex items-center space-x-2 hidden xl:flex",children:[i.jsxs("label",{htmlFor:"dummy-players",className:"text-sm font-medium text-gray-300",children:[ae("dummies"),":"]}),i.jsx("select",{id:"dummy-players",value:s,onChange:z=>l(parseInt(z.target.value,10)),disabled:t||!u,className:"bg-gray-700 border border-gray-600 text-white text-sm rounded-lg block w-full p-2 disabled:opacity-70",children:De.map(z=>i.jsx("option",{value:z,disabled:c+z>Vp,children:z},z))})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[u&&t&&i.jsx("button",{onClick:m,className:"bg-yellow-600 hover:bg-yellow-700 text-white font-bold p-2 rounded text-sm",children:i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 110 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"})})}),i.jsx("button",{onClick:h,className:`bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded text-sm ${t?"bg-red-600 hover:bg-red-700":""}`,children:ae(t?"surrender":"exit")})]})]})]})}),Vg=({isOpen:e,onClose:t,title:n,player:r,cards:o,setDraggedItem:a,onCardContextMenu:s,onCardDoubleClick:l,onCardClick:c,onReorder:d,canInteract:h,isDeckView:k=!1,playerColorMap:g,localPlayerId:b,imageRefreshVersion:x,highlightFilter:A})=>{const{t:T}=Nt(),[u,m]=p.useState(null),[f,D]=p.useState(null),[N,_]=p.useState(null),[O,M]=p.useState(o),[I,V]=p.useState(!1),ce=p.useRef(null),we=p.useRef(null);p.useEffect(()=>{e&&(m(null),D(null),_(null),M(o),V(!1),we.current=null)},[e,o]);const ae=p.useMemo(()=>{if(f!==null&&N!==null&&f!==N){const W=[...O],[he]=W.splice(f,1);return W.splice(N,0,he),W}return O},[O,f,N]),De=p.useCallback((W,he)=>{h&&(D(he),m(W.id),we.current=W,V(!1))},[h]),me=p.useCallback((W,he)=>{W.preventDefault(),W.dataTransfer.dropEffect="move",N!==he&&_(he)},[N]),ve=p.useCallback(W=>{if(!we.current||!ce.current)return;const he=ce.current.getBoundingClientRect(),Ne=W.clientX,v=W.clientY;if(Ne<he.left||Ne>he.right||v<he.top||v>he.bottom){const L=we.current,$=f??0;a({card:L,source:k?"deck":"discard",playerId:r.id,cardIndex:$}),V(!0),t()}},[f,k,r.id,a,t]),Pe=p.useCallback(()=>{I||(m(null),D(null),_(null)),we.current=null},[I]),J=p.useCallback((W,he)=>{if(W.preventDefault(),W.stopPropagation(),I)return;if(f===null||f===he){D(null),m(null),_(null);return}const Ne=[...O],[v]=Ne.splice(f,1);Ne.splice(he,0,v),M(Ne),d&&d(r.id,Ne),D(null),m(null),_(null)},[f,O,d,r.id,I]),K=Math.ceil(o.length/5)>5,ne="calc(5 * 7rem + 4 * 0.5rem + 1rem)";return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 pointer-events-auto",onClick:t,onContextMenu:W=>W.preventDefault(),children:i.jsxs("div",{ref:ce,onClick:W=>W.stopPropagation(),onDragLeave:ve,className:"bg-gray-800 rounded-lg p-4 shadow-xl w-auto max-w-4xl max-h-[95vh] flex flex-col",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0",children:[i.jsx("h2",{className:"text-xl font-bold",children:n}),i.jsx("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-1 px-3 rounded text-sm",children:T("close")})]}),i.jsx("div",{className:`bg-gray-900 rounded p-2 ${K?"overflow-y-auto":""}`,style:K?{height:ne}:{},children:i.jsxs("div",{className:"grid grid-cols-5 gap-2",children:[ae.map((W,he)=>{const Ne=O.findIndex(_e=>_e.id===W.id),v=A?A(W):!0,L=v,$=u===W.id,ee=N===he&&f!==he,oe=h&&v,Ie=$?.5:v?1:.3;return i.jsx("div",{style:{opacity:Ie},draggable:oe,onDragStart:()=>De(W,Ne),onDragOver:_e=>me(_e,he),onDragEnd:Pe,onDrop:_e=>J(_e,he),onContextMenu:_e=>{_e.preventDefault(),_e.stopPropagation(),s&&s(_e,Ne)},onClick:()=>oe&&(c==null?void 0:c(Ne)),onDoubleClick:()=>oe&&(l==null?void 0:l(Ne)),"data-interactive":oe,className:`w-28 h-28 relative transition-all rounded-lg
                    ${oe?"cursor-grab active:cursor-grabbing":"cursor-default"}
                    ${ee?"scale-105 z-10":""}
                    ${$?"scale-95":"hover:scale-105"}
                  `,children:i.jsx("div",{className:`w-full h-full ${L&&A?"ring-4 ring-cyan-400 rounded-md shadow-[0_0_15px_#22d3ee]":""}`,children:i.jsx(Zt,{card:W,isFaceUp:!0,playerColorMap:g,localPlayerId:b,imageRefreshVersion:x,disableActiveHighlights:!v})})},`${W.id}-${he}`)}),ae.length===0&&i.jsx("p",{className:"col-span-5 w-full text-center text-gray-400 py-8",children:T("empty")})]})}),i.jsx("p",{className:"text-gray-400 text-xs mt-2 text-center",children:T("dragCardsReorder")})]})}):null},Hg=({isOpen:e,onClose:t,setDraggedItem:n,openContextMenu:r,canInteract:o,anchorEl:a,imageRefreshVersion:s})=>{const{t:l}=Nt(),[c,d]=p.useState(null),[h,k]=p.useState(!1),g=p.useRef(null),b=p.useRef(null);if(p.useEffect(()=>{e&&(d(null),k(!1),b.current=null)},[e]),!e||!a)return null;const x=(Ui[Be.Tokens]||[]).filter(f=>!f.allowedPanels||f.allowedPanels.includes("TOKEN_PANEL")),A={position:"fixed",top:`${a.top}px`,left:`${a.left}px`,zIndex:60},T=f=>{o&&(d(f.id),b.current=f,k(!1))},u=f=>{if(!b.current||!g.current)return;const D=g.current.getBoundingClientRect(),N=f.clientX,_=f.clientY;(N<D.left||N>D.right||_<D.top||_>D.bottom)&&(n({card:b.current,source:"token_panel"}),k(!0),t())},m=()=>{h||d(null),b.current=null};return i.jsx("div",{style:A,className:"pointer-events-auto",ref:g,onDragLeave:u,children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 shadow-xl w-96 max-w-[90vw] h-auto flex flex-col",onClick:f=>f.stopPropagation(),children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("h2",{className:"text-xl font-bold",children:l("tokens")}),i.jsx("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-1 px-3 rounded text-sm",children:l("close")})]}),i.jsx("div",{className:"flex-grow bg-gray-900 rounded p-2 overflow-y-auto",children:i.jsx("div",{className:"grid grid-cols-3 gap-2",children:x.map(f=>{const D=c===f.id,N=D?.5:1;return i.jsx("div",{style:{opacity:N},draggable:o,onDragStart:()=>T(f),onDragEnd:m,onContextMenu:_=>o&&r(_,"token_panel_item",{card:f}),"data-interactive":o,className:`w-24 h-24 transition-all rounded-lg ${o?"cursor-grab active:cursor-grabbing hover:scale-105":"cursor-not-allowed"} ${D?"scale-95":""}`,children:i.jsx(Zt,{card:f,isFaceUp:!0,playerColorMap:new Map,imageRefreshVersion:s})},f.id)})})}),i.jsx("p",{className:"text-gray-400 text-xs mt-2 text-center",children:l("dragOutsideToPlaceToken")})]})})},$g="https://res.cloudinary.com/dxxh6meej/image/upload/v1763653192/background_counter_socvss.png",Wg=({isOpen:e,onClose:t,canInteract:n,anchorEl:r,imageRefreshVersion:o,onCounterMouseDown:a,cursorStack:s})=>{const{getCounterTranslation:l,t:c}=Nt(),[d,h]=p.useState(null),[k,g]=p.useState({x:0,y:0}),b=p.useMemo(()=>Hp(),[Ml().size]);if(!e||!r)return null;const x={position:"fixed",top:`${r.top}px`,left:`${r.left}px`,zIndex:60},A=N=>{let _=Eo[N];if(_&&o){const O=_.includes("?")?"&":"?";_=`${_}${O}v=${o}`}return _},T=(N,_,O)=>{if(N.button===2){const M=l(_),I=M?M.name:O,V=M?M.description:Bi[_]||"",ce={id:`tooltip_${_}_${Date.now()}`,deck:"counter",name:I,imageUrl:"",fallbackImage:"",power:0,ability:V,types:[],statuses:[]};h(ce),g({x:N.clientX,y:N.clientY})}else N.button===0&&n&&a(_,N)},u=()=>{h(null)},m=N=>{d&&g({x:N.clientX,y:N.clientY})},f=()=>{s&&t(),h(null)},D=N=>{const _=N.currentTarget.getBoundingClientRect(),O=N.clientX,M=N.clientY;(O<_.left||O>=_.right||M<_.top||M>=_.bottom)&&t()};return i.jsxs(i.Fragment,{children:[i.jsx("div",{style:x,className:"pointer-events-auto counter-modal-content",onMouseLeave:f,onDragLeave:D,children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 shadow-xl w-80 max-w-[90vw] h-auto flex flex-col",onClick:N=>N.stopPropagation(),children:[i.jsxs("div",{className:"mb-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-xl font-bold",children:c("counters")}),i.jsx("button",{onClick:t,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-1 px-3 rounded text-sm",children:c("close")})]}),i.jsx("p",{className:"text-xs text-gray-400 mt-1",children:c("holdRightClickViewHints")})]}),i.jsx("div",{className:"bg-gray-900 rounded p-4",children:i.jsx("div",{className:"grid grid-cols-4 gap-1",children:b.map(N=>{const _=A(N.type),O=N.type.startsWith("Power"),M=l(N.type),I=M?M.name:N.label;return i.jsx("button",{onContextMenu:V=>V.preventDefault(),onMouseDown:V=>T(V,N.type,I),onMouseUp:u,onMouseMove:m,className:`w-12 h-12 rounded-full border-white flex items-center justify-center shadow-lg mx-auto relative select-none ${n?"cursor-pointer hover:ring-2 ring-indigo-400":"cursor-not-allowed"}`,style:{backgroundImage:`url(${$g})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:_?i.jsx("img",{src:_,alt:I,className:"w-full h-full object-contain p-1 pointer-events-none"}):i.jsx("span",{className:`font-bold text-white pointer-events-none ${O?"text-sm":"text-lg"}`,style:{textShadow:"0 0 2px black"},children:O?I:N.type.charAt(0)})},N.type)})})})]})}),d&&i.jsx(Kp,{x:k.x,y:k.y,children:i.jsx(as,{card:d,statusDescriptions:Bi})})]})},om=({player:e,onDragStart:t})=>{const n=Vt[e.color]||Vt.blue;return i.jsxs("div",{draggable:!0,onDragStart:r=>t(r,e.id),className:"flex items-center gap-2 bg-gray-600 p-2 rounded-md cursor-grab active:cursor-grabbing",children:[i.jsx("div",{className:`w-4 h-4 rounded-full ${n.bg} border border-white/50`}),i.jsx("span",{className:"font-medium",children:e.name})]})},kc=({teamId:e,teamName:t,players:n,capacity:r,onDrop:o,onDragOver:a,onDragLeave:s,onPlayerDragStart:l,isOver:c})=>i.jsxs("div",{onDrop:d=>o(d,e),onDragOver:a,onDragLeave:s,className:`bg-gray-800 p-4 rounded-lg border-2 ${c?"border-indigo-500":"border-gray-700"} transition-colors`,children:[i.jsxs("h3",{className:"text-lg font-bold mb-3 border-b border-gray-700 pb-2",children:[t," (",n.length,"/",r,")"]}),i.jsx("div",{className:"space-y-2 min-h-[4rem]",children:n.map(d=>i.jsx(om,{player:d,onDragStart:l},d.id))})]}),Kg=({players:e,gameMode:t,onCancel:n,onConfirm:r})=>{const{t:o}=Nt(),[a,s]=p.useState(e),[l,c]=p.useState([]),[d,h]=p.useState([]),[k,g]=p.useState(null),[b,x]=p.useState(null),{team1Capacity:A,team2Capacity:T}=p.useMemo(()=>t===vr.TwoVTwo?{team1Capacity:2,team2Capacity:2}:t===vr.ThreeVOne?{team1Capacity:3,team2Capacity:1}:(console.warn(`Unexpected gameMode: ${t}, falling back to TwoVTwo capacities`),{team1Capacity:2,team2Capacity:2}),[t]),u=a.length===0&&l.length===A&&d.length===T,m=(_,O)=>{_.dataTransfer.effectAllowed="move",g(O)},f=_=>{_.preventDefault(),_.dataTransfer.dropEffect="move"},D=(_,O)=>{if(_.preventDefault(),k===null)return;const M=e.find(me=>me.id===k);if(!M)return;const I=[...a],V=[...l],ce=[...d],we=I.findIndex(me=>me.id===k);we>-1&&I.splice(we,1);const ae=V.findIndex(me=>me.id===k);ae>-1&&V.splice(ae,1);const De=ce.findIndex(me=>me.id===k);De>-1&&ce.splice(De,1),O===1&&V.length<A?V.push(M):O===2&&ce.length<T?ce.push(M):I.push(M),s(I),c(V),h(ce),g(null),x(null)},N=()=>{if(!u)return;const _={1:l.map(O=>O.id),2:d.map(O=>O.id)};r(_)};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-lg p-8 shadow-xl w-full max-w-4xl",children:[i.jsx("h2",{className:"text-3xl font-bold mb-2",children:o("assignTeams")}),i.jsx("p",{className:"text-gray-400 mb-6",children:o("dragToReorder")}),i.jsxs("div",{className:"grid grid-cols-3 gap-6",children:[i.jsxs("div",{onDrop:_=>D(_,"unassigned"),onDragOver:_=>{f(_),x("unassigned")},onDragLeave:()=>x(null),className:`bg-gray-800 p-4 rounded-lg border-2 ${b==="unassigned"?"border-indigo-500":"border-gray-700"} transition-colors`,children:[i.jsx("h3",{className:"text-lg font-bold mb-3 border-b border-gray-700 pb-2",children:o("unassigned")}),i.jsx("div",{className:"space-y-2",children:a.map(_=>i.jsx(om,{player:_,onDragStart:m},_.id))})]}),i.jsx(kc,{teamId:1,teamName:`${o("team")} 1`,players:l,capacity:A,onDrop:D,onDragOver:_=>{f(_),x(1)},onDragLeave:()=>x(null),onPlayerDragStart:m,isOver:b===1}),i.jsx(kc,{teamId:2,teamName:`${o("team")} 2`,players:d,capacity:T,onDrop:D,onDragOver:_=>{f(_),x(2)},onDragLeave:()=>x(null),onPlayerDragStart:m,isOver:b===2})]}),i.jsxs("div",{className:"flex justify-end mt-8 space-x-4",children:[i.jsx("button",{type:"button",onClick:n,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:o("cancel")}),i.jsx("button",{type:"button",onClick:N,disabled:!u,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded disabled:bg-gray-500 disabled:cursor-not-allowed transition-colors",children:o("confirmTeams")})]})]})})},qg=({players:e,localPlayer:t,onReady:n,onCancel:r})=>{const{t:o}=Nt(),a=()=>{t.isReady||n()};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 shadow-xl w-full max-w-md",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4 text-center",children:o("readyToStart")}),i.jsx("p",{className:"text-gray-400 text-center mb-6",children:o("gameWillBegin")}),i.jsx("ul",{className:"space-y-3 mb-8",children:e.map(s=>i.jsxs("li",{className:"flex items-center justify-between bg-gray-700 p-3 rounded-lg",children:[i.jsxs("span",{className:"font-medium",children:[s.name," ",s.id===t.id&&o("youLabel")]}),s.isReady?i.jsxs("span",{className:"flex items-center text-green-400",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),o("ready")]}):i.jsxs("span",{className:"flex items-center text-yellow-400",children:[i.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-1 animate-pulse",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 102 0V6zM9 14a1 1 0 112 0 1 1 0 01-2 0z",clipRule:"evenodd"})}),o("waiting")]})]},s.id))}),i.jsxs("div",{className:"flex flex-col space-y-3",children:[i.jsx("button",{onClick:a,disabled:t.isReady,className:"w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded disabled:bg-gray-500 disabled:cursor-not-allowed transition-colors text-lg",children:t.isReady?o("waitingForOthers"):o("imReady")}),i.jsx("button",{onClick:r,className:"w-full bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded transition-colors",children:o("cancelStart")})]})]})})},am=({card:e,ownerPlayer:t,onClose:n,statusDescriptions:r,allPlayers:o,imageRefreshVersion:a})=>{var D,N,_,O,M;const{getCardTranslation:s,getCounterTranslation:l,resources:c}=Nt(),d=c.abilityKeywords,[h,k]=p.useState(e.imageUrl),g=e.baseId?s(e.baseId):void 0,b=g?{...e,...g}:e;p.useEffect(()=>{let I=e.imageUrl;if(a&&I){const V=I.includes("?")?"&":"?";I=`${I}${V}v=${a}`}k(I)},[e.imageUrl,a]);const x=()=>{let I=e.fallbackImage;if(a&&I){const V=I.includes("?")?"&":"?";I=`${I}${V}v=${a}`}h!==I&&k(I)},A=t==null?void 0:t.color,T=A?((D=Vt[A])==null?void 0:D.border)||((N=zl[e.deck])==null?void 0:N.color)||"border-gray-300":((_=zl[e.deck])==null?void 0:_.color)||"border-gray-300",u=p.useMemo(()=>(t==null?void 0:t.teamId)===void 0?null:`Team ${t.teamId}`,[t]),m=["readyDeploy","readySetup","readyCommit"],f=(e.statuses??[]).reduce((I,V)=>(m.includes(V.type)||(I[V.type]||(I[V.type]=[]),I[V.type].push(V.addedByPlayerId)),I),{});return i.jsx("div",{onClick:n,className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[300]",children:i.jsxs("div",{onClick:I=>I.stopPropagation(),className:`bg-gray-800 rounded-lg shadow-2xl w-full max-w-4xl h-[40rem] p-6 flex gap-6 border-4 ${T}`,children:[i.jsx("div",{className:"w-1/2 h-full flex-shrink-0",children:h?i.jsx("img",{src:h,onError:x,alt:b.name,className:"w-full h-full object-contain rounded-lg"}):i.jsx("div",{className:"w-full h-full bg-gray-700 rounded-lg flex items-center justify-center text-2xl font-bold text-center p-4",children:b.name})}),i.jsxs("div",{className:"w-1/2 h-full flex flex-col gap-4 overflow-y-auto pr-2 text-left",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-4xl font-bold",children:b.name}),i.jsx("p",{className:"text-lg text-gray-400 capitalize",children:((O=b.types)==null?void 0:O.join(", "))||`${b.deck} Card`})]}),i.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[i.jsxs("p",{children:[i.jsx("strong",{className:"text-indigo-400 text-lg",children:"Power:"})," ",i.jsx("span",{className:"text-xl font-bold",children:b.power})]}),i.jsxs("p",{className:"mt-2",children:[i.jsx("strong",{className:"text-indigo-400 text-lg",children:"Ability:"})," ",i.jsx("span",{className:"text-gray-200 text-base",children:Fd(b.ability,d)})]})]}),t&&i.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg text-sm",children:[i.jsxs("p",{children:[i.jsx("strong",{className:"text-indigo-400",children:"Owner:"})," ",t.name]}),u&&i.jsxs("p",{className:"mt-1",children:[i.jsx("strong",{className:"text-indigo-400",children:"Team:"})," ",u]})]}),e.statuses&&e.statuses.length>0&&i.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[i.jsx("h3",{className:"text-indigo-400 text-lg font-bold mb-2",children:"Statuses"}),i.jsx("ul",{className:"space-y-2 text-sm",children:Object.entries(f).map(([I,V])=>{const ce=V.reduce((me,ve)=>(me[ve]=(me[ve]||0)+1,me),{}),we=Object.entries(ce).map(([me,ve])=>{var J;return`${((J=o.find(z=>z.id===Number(me)))==null?void 0:J.name)||`Player ${me}`} (x${ve})`}).join(", "),ae=l(I),De=ae?ae.description:r[I]||"No description available.";return i.jsxs("li",{children:[i.jsx("strong",{className:"text-gray-200",children:I})," ",i.jsxs("span",{className:"text-gray-400 text-xs ml-1",children:["- ",we]}),i.jsx("p",{className:"text-gray-400 text-xs pl-2 mt-0.5",children:De})]},I)})})]}),b.flavorText&&i.jsxs("div",{className:"bg-gray-900 p-4 rounded-lg",children:[i.jsx("h3",{className:"text-indigo-400 font-bold mb-1",children:"Flavor Text"}),i.jsx("p",{className:"italic text-gray-400",children:(M=b.flavorText)==null?void 0:M.split(`
`).map((I,V)=>i.jsxs(dr.Fragment,{children:[V>0&&i.jsx("br",{}),I]},V))})]}),i.jsx("button",{onClick:n,className:"mt-auto bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded self-end",children:"Close"})]})]})})},Jg=({fromPlayer:e,cardCount:t,onAccept:n,onDecline:r})=>i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[105]",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 shadow-xl w-full max-w-md text-center",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Reveal Request"}),i.jsxs("p",{className:"text-gray-300 mb-6",children:[i.jsx("span",{className:"font-bold",children:e.name})," would like to see ",t>1?`${t} of your hidden cards`:"one of your hidden cards","."]}),i.jsxs("div",{className:"flex justify-center space-x-4",children:[i.jsx("button",{onClick:r,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded transition-colors",children:"Decline"}),i.jsx("button",{onClick:n,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded transition-colors",children:"Accept"})]})]})}),im=({x:e,y:t,items:n,onClose:r})=>{const o=p.useRef(null),[a,s]=p.useState({top:t,left:e});return p.useEffect(()=>{if(o.current){const{innerWidth:l,innerHeight:c}=window,{offsetWidth:d,offsetHeight:h}=o.current,k=e+d>l?l-d-10:e,g=t+h>c?c-h-10:t;s({top:g,left:k})}},[e,t,n]),Ud.createPortal(i.jsx("div",{ref:o,className:"fixed bg-gray-900 border border-gray-700 rounded-md shadow-lg z-[9999] py-1",style:{top:a.top,left:a.left,opacity:o.current?1:0},onClick:l=>l.stopPropagation(),children:n.map((l,c)=>"isDivider"in l?i.jsx("hr",{className:"border-gray-700 my-1"},`divider-${c}`):"onClick"in l?i.jsx("button",{onClick:()=>{l.disabled||(l.onClick(),r())},disabled:l.disabled,className:"block w-full text-left px-4 py-1 text-sm text-white hover:bg-indigo-600 disabled:text-gray-500 disabled:cursor-not-allowed disabled:bg-gray-800",style:{fontWeight:l.isBold?"bold":"normal"},children:l.label},c):i.jsxs("div",{className:"flex items-center justify-between px-4 py-1 text-sm text-white w-full space-x-2",children:[i.jsx("button",{onClick:d=>{d.stopPropagation(),l.onRemove()},disabled:l.removeDisabled,className:"w-7 h-6 flex items-center justify-center bg-gray-700 hover:bg-red-600 rounded disabled:bg-gray-800 disabled:text-gray-500 disabled:cursor-not-allowed font-mono text-lg",children:"-"}),i.jsx("span",{className:"flex-grow text-center",children:l.label}),i.jsx("button",{onClick:d=>{d.stopPropagation(),l.onAdd()},className:"w-7 h-6 flex items-center justify-center bg-gray-700 hover:bg-green-600 rounded font-mono text-lg",children:"+"})]},c))}),document.body)},Yg=({isOpen:e,card:t,playerColorMap:n,onConfirm:r,onCancel:o})=>{const{getCardTranslation:a,t:s,resources:l}=Nt(),c=l.abilityKeywords,d=t.baseId?a(t.baseId):void 0,h=d?{...t,...d}:t,k=h.ability||"",g=dr.useMemo(()=>k.split("").map(x=>x.trim()).filter(x=>x.length>0),[k]);return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[200] backdrop-blur-sm",children:i.jsxs("div",{className:"bg-gray-900 rounded-xl border-2 border-yellow-500 shadow-2xl p-6 w-full max-w-4xl flex gap-6",children:[i.jsxs("div",{className:"w-1/3 flex flex-col items-center justify-center border-r border-gray-700 pr-6",children:[i.jsx("div",{className:"w-72 h-72 relative transform hover:scale-105 transition-transform duration-300",children:i.jsx(Zt,{card:h,isFaceUp:!0,playerColorMap:n,disableTooltip:!0})}),i.jsx("h2",{className:"text-2xl font-bold text-yellow-500 mt-6 text-center leading-tight",children:h.name})]}),i.jsxs("div",{className:"w-2/3 flex flex-col",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-4 border-b border-gray-700 pb-2",children:"Select Module"}),i.jsxs("div",{className:"flex flex-col gap-3 flex-grow justify-center overflow-y-auto max-h-[60vh] pr-2",children:[g.map((b,x)=>i.jsxs("button",{onClick:()=>r(x),className:"group relative bg-gray-800 hover:bg-indigo-900 border-2 border-gray-600 hover:border-indigo-400 rounded-lg p-4 transition-all duration-200 text-left shadow-lg hover:shadow-indigo-500/20 flex items-start gap-4 shrink-0",children:[i.jsx("div",{className:"bg-gray-700 text-gray-400 w-6 h-6 flex-shrink-0 flex items-center justify-center rounded-full font-bold text-xs group-hover:bg-indigo-500 group-hover:text-white transition-colors mt-1",children:x+1}),i.jsx("div",{className:"text-gray-200 group-hover:text-white text-base font-medium leading-snug",children:Fd(b,c)})]},x)),g.length===0&&i.jsx("div",{className:"text-gray-500 text-center italic",children:"No selectable modules found on this card."})]}),i.jsx("div",{className:"mt-6 flex justify-end",children:i.jsx("button",{onClick:o,className:"px-6 py-2 rounded bg-gray-700 hover:bg-gray-600 text-white font-bold transition-colors text-sm",children:s("cancel")})})]})]})}):null},Zg=p.memo(({isOpen:e,onClose:t,onJoin:n,games:r})=>{const{t:o}=Nt(),[a,s]=p.useState(""),l=p.useCallback(()=>{a.trim()&&n(a.trim().toUpperCase())},[a,n]),c=p.useCallback(k=>{n(k)},[n]),d=p.useCallback(k=>{s(k.target.value)},[s]),h=p.useMemo(()=>r.map(k=>i.jsx("li",{children:i.jsxs("button",{onClick:()=>c(k.gameId),className:"w-full text-left p-4 bg-gray-700 hover:bg-indigo-600 hover:border-indigo-400 border border-gray-600 rounded-lg transition-all shadow-md group flex flex-col gap-2",children:[i.jsxs("div",{className:"flex justify-between items-center w-full",children:[i.jsx("span",{className:"text-xs font-bold text-gray-400 group-hover:text-indigo-200 uppercase tracking-wider",children:o("gameCode")}),i.jsxs("span",{className:"bg-gray-800 px-2 py-1 rounded-full text-xs font-bold border border-gray-600 group-hover:border-indigo-300",children:[k.playerCount," / 4"]})]}),i.jsx("span",{className:"block font-mono text-xl text-indigo-300 group-hover:text-white font-bold truncate",children:k.gameId})]})},k.gameId)),[r,c,o]);return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-[5px]",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-xl w-full max-w-6xl flex flex-col max-h-[calc(100vh-10px)]",children:[i.jsx("h2",{className:"text-2xl font-bold mb-4 flex-shrink-0",children:o("joinGame")}),i.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-2 flex-shrink-0",children:o("activeGames")}),i.jsx("div",{className:"flex-grow overflow-y-auto pr-2 border-b border-gray-700 pb-4 mb-4 custom-scrollbar min-h-[100px]",children:r.length>0?i.jsx("ul",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:h}):i.jsx("div",{className:"flex items-center justify-center h-full min-h-[150px]",children:i.jsxs("p",{className:"text-gray-400 text-center opacity-70",children:[o("noActiveGames")," ",i.jsx("br",{}),i.jsx("span",{className:"text-sm",children:o("createOne")})]})})}),i.jsxs("div",{className:"flex-shrink-0",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-300 mb-2",children:o("orJoinWithCode")}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx("input",{type:"text",value:a,onChange:d,placeholder:o("enterGameId"),className:"flex-grow bg-gray-700 border border-gray-600 text-white font-mono rounded-lg p-2 focus:ring-indigo-500 focus:border-indigo-500",onKeyDown:k=>k.key==="Enter"&&l()}),i.jsx("button",{onClick:l,disabled:!a.trim(),className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-6 rounded disabled:bg-gray-600 disabled:cursor-not-allowed transition-colors",children:o("join")})]}),i.jsx("div",{className:"flex justify-end mt-6",children:i.jsx("button",{type:"button",onClick:t,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-6 rounded transition-colors",children:o("cancel")})})]})]})}):null}),Qg=({isOpen:e,onClose:t,setViewingCard:n})=>{const{getCardTranslation:r,t:o}=Nt(),[,a]=p.useState(0);p.useEffect(()=>{const z=()=>{const ne=Ml();if(ne.size>0){a(ne.size);return}else{const W=setTimeout(z,100);return()=>clearTimeout(W)}};return z()},[]);const s=p.useMemo(()=>kg().filter(({card:z})=>{var K;return(K=z.allowedPanels)==null?void 0:K.includes("DECK_BUILDER")}),[Ml().size]),l=Gp(),[c,d]=p.useState("My Custom Deck"),[h,k]=p.useState(new Map),[g,b]=p.useState("All"),[x,A]=p.useState(""),[T,u]=p.useState(""),[m,f]=p.useState([]),[D,N]=p.useState(!1),_=p.useRef(null),O=p.useRef(null);p.useEffect(()=>{const z=K=>{O.current&&!O.current.contains(K.target)&&N(!1)};return document.addEventListener("mousedown",z),()=>document.removeEventListener("mousedown",z)},[]);const M=p.useMemo(()=>{const z=new Set;return s.forEach(({card:K})=>{var ne;return(ne=K.types)==null?void 0:ne.forEach(W=>z.add(W))}),Array.from(z).sort()},[s]),I=p.useMemo(()=>s.filter(({id:K,card:ne})=>{var v;const W=r(K),he=(W==null?void 0:W.name)||ne.name,Ne=(W==null?void 0:W.ability)||ne.ability||"";if(x){const L=x.toLowerCase();if(!he.toLowerCase().includes(L)&&!Ne.toLowerCase().includes(L))return!1}if(T!==""&&ne.power!==Number(T))return!1;if(m.length>0){const L=ne.types||[];if(!m.every(ee=>L.includes(ee)))return!1}if(g!=="All"){if(g==="Command")return pi.has(K)||((v=ne.types)==null?void 0:v.includes("Command"));if(g==="Neutral")return ne.faction==="Neutral";if(ne.faction!==g)return!1}return!0}),[s,g,x,T,m,r]),V=p.useMemo(()=>{let z=0;return h.forEach(K=>z+=K),z},[h]),ce=z=>{var v,L,$;if(V>=co){alert(`Deck cannot exceed ${co} cards.`);return}const K=Fi(z),ne=(v=K==null?void 0:K.types)==null?void 0:v.includes("Hero"),W=(L=K==null?void 0:K.types)==null?void 0:L.includes("Rarity"),he=pi.has(z)||(($=K==null?void 0:K.types)==null?void 0:$.includes("Command")),Ne=ne||W?1:he?2:3;k(ee=>{const oe=new Map(ee),Ie=oe.get(z)||0;return Ie>=Ne||oe.set(z,Ie+1),oe})},we=z=>{k(K=>{const ne=new Map(K),W=ne.get(z)||0;return W>1?ne.set(z,W-1):ne.delete(z),ne})},ae=()=>{confirm("Are you sure you want to clear the current deck?")&&(k(new Map),d("My Custom Deck"))},De=z=>{u(K=>{const W=(K===""?0:K)+z;return W<0?0:W})},me=z=>{f(K=>K.includes(z)?K.filter(ne=>ne!==z):K.length>=10?K:[...K,z])},ve=()=>{if(V===0){alert("Cannot save an empty deck.");return}const z={deckName:c.trim()||"Untitled Deck",cards:Array.from(h.entries()).map(([he,Ne])=>({cardId:he,quantity:Ne}))},K=new Blob([JSON.stringify(z,null,2)],{type:"application/json"}),ne=URL.createObjectURL(K),W=document.createElement("a");W.href=ne,W.download=`${z.deckName.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.json`,document.body.appendChild(W),W.click(),document.body.removeChild(W),URL.revokeObjectURL(ne)},Pe=()=>{var z;(z=_.current)==null||z.click()},J=z=>{var W;const K=(W=z.target.files)==null?void 0:W[0];if(!K)return;const ne=new FileReader;ne.onload=he=>{var Ne;try{const v=(Ne=he.target)==null?void 0:Ne.result,L=JSON.parse(v),$=tm(L);if(!$.isValid){alert($.error);return}const{deckFile:ee}=$;d(ee.deckName);const oe=new Map;ee.cards.forEach(Ie=>oe.set(Ie.cardId,Ie.quantity)),k(oe)}catch{alert("Failed to parse deck file.")}finally{z.target&&(z.target.value="")}},ne.readAsText(K)};return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-gray-900 w-full h-full md:w-[95vw] md:h-[90vh] md:rounded-xl flex flex-col overflow-hidden shadow-2xl border border-gray-700",children:[i.jsxs("div",{className:"bg-gray-800 p-4 border-b border-gray-700 flex justify-between items-center flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-white",children:o("deckBuilding")}),i.jsx("input",{type:"text",value:c,onChange:z=>d(z.target.value),className:"bg-gray-700 text-white px-3 py-1 rounded border border-gray-600 focus:outline-none focus:border-indigo-500 font-bold",placeholder:"Deck Name"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:ae,className:"px-4 py-2 bg-red-900 hover:bg-red-800 text-white rounded text-sm font-bold transition-colors",children:o("clear")}),i.jsx("button",{onClick:Pe,className:"px-4 py-2 bg-gray-700 hover:bg-gray-600 text-white rounded text-sm font-bold transition-colors",children:o("loadDeck")}),i.jsx("input",{type:"file",ref:_,onChange:J,accept:".json",className:"hidden"}),i.jsx("button",{onClick:ve,className:"px-4 py-2 bg-green-700 hover:bg-green-600 text-white rounded text-sm font-bold transition-colors",children:o("save")}),i.jsx("div",{className:"w-px h-8 bg-gray-600 mx-2"}),i.jsx("button",{onClick:t,className:"px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded text-sm font-bold transition-colors",children:o("close")})]})]}),i.jsxs("div",{className:"flex flex-grow overflow-hidden",children:[i.jsxs("div",{className:"flex-grow flex flex-col p-4 overflow-hidden border-r border-gray-700 bg-gray-900/50",children:[i.jsxs("div",{className:"mb-4 flex flex-wrap items-center gap-4 bg-gray-800 p-2 rounded-lg border border-gray-700 relative z-40",children:[i.jsxs("div",{className:"relative",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-2 flex items-center pointer-events-none",children:i.jsx("svg",{className:"h-4 w-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),i.jsx("input",{type:"text",value:x,onChange:z=>A(z.target.value),placeholder:"Search...",className:"pl-8 pr-6 py-1 bg-gray-700 text-white border border-gray-600 rounded text-sm focus:outline-none focus:border-indigo-500 w-32 md:w-48"}),x&&i.jsx("button",{onClick:()=>A(""),className:"absolute inset-y-0 right-0 pr-2 flex items-center text-gray-400 hover:text-white",title:"Clear Search",children:i.jsx("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-gray-400 text-sm font-bold",children:"Pow:"}),i.jsxs("div",{className:"flex items-center bg-gray-700 rounded border border-gray-600 overflow-hidden",children:[i.jsx("button",{onClick:()=>De(-1),className:"px-2 py-1 hover:bg-gray-600 text-white font-bold border-r border-gray-600 active:bg-gray-500",children:"-"}),i.jsx("div",{className:"w-8 text-center text-sm font-bold text-white select-none",children:T===""?"-":T}),i.jsx("button",{onClick:()=>De(1),className:"px-2 py-1 hover:bg-gray-600 text-white font-bold border-l border-gray-600 active:bg-gray-500",children:"+"})]}),T!==""&&i.jsx("button",{onClick:()=>u(""),className:"p-1 bg-gray-700 hover:bg-red-600 text-gray-400 hover:text-white rounded transition-colors",title:"Reset Power Filter",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("div",{className:"relative",ref:O,children:[i.jsxs("button",{onClick:()=>N(!D),className:`px-3 py-1 bg-gray-700 text-white border border-gray-600 rounded text-sm flex items-center gap-2 focus:outline-none hover:bg-gray-600 ${m.length>0?"border-indigo-500 text-indigo-300":""}`,children:[i.jsxs("span",{children:["Types ",m.length>0?`(${m.length})`:""]}),i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),D&&i.jsxs("div",{className:"absolute top-full left-0 mt-1 w-48 bg-gray-800 border border-gray-600 rounded shadow-xl z-50 max-h-60 overflow-y-auto p-1",children:[i.jsx("div",{className:"px-2 py-1 text-xs text-gray-400 border-b border-gray-700 mb-1",children:"Match ALL selected"}),M.map(z=>i.jsxs("label",{className:"flex items-center px-2 py-1.5 hover:bg-gray-700 rounded cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:m.includes(z),onChange:()=>me(z),className:"form-checkbox h-4 w-4 text-indigo-600 rounded border-gray-500 bg-gray-700 focus:ring-indigo-500"}),i.jsx("span",{className:"ml-2 text-sm text-gray-200",children:z})]},z))]})]}),m.length>0&&i.jsx("button",{onClick:()=>f([]),className:"p-1 bg-gray-700 hover:bg-red-600 text-gray-400 hover:text-white rounded transition-colors",title:"Clear Types",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsxs("select",{value:g,onChange:z=>b(z.target.value),className:`bg-gray-700 text-white border border-gray-600 rounded px-2 py-1 text-sm focus:outline-none focus:border-indigo-500 max-w-[140px] ${g!=="All"?"border-indigo-500 text-indigo-300":""}`,children:[i.jsx("option",{value:"All",children:"All Factions"}),l.map(z=>i.jsx("option",{value:z.id,children:z.name},z.id)),i.jsx("option",{value:"Neutral",children:"Neutral"}),i.jsx("option",{value:"Command",children:"Command Cards"})]}),g!=="All"&&i.jsx("button",{onClick:()=>b("All"),className:"p-1 bg-gray-700 hover:bg-red-600 text-gray-400 hover:text-white rounded transition-colors",title:"Reset Faction",children:i.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),i.jsx("span",{className:"ml-auto text-gray-500 text-xs hidden xl:inline",children:"Right-click to view card details"})]}),i.jsx("div",{className:"flex-grow overflow-y-auto pr-2",children:i.jsxs("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 xl:grid-cols-7 gap-2",children:[I.map(({id:z,card:K})=>{const ne={...K,id:z,baseId:z,deck:K.faction==="Neutral"?Be.Neutral:K.faction||Be.Custom,ownerId:0};return i.jsxs("div",{className:"relative group cursor-pointer",onClick:()=>ce(z),onContextMenu:W=>{W.preventDefault(),n({card:ne})},children:[i.jsx("div",{className:"w-full aspect-square transition-transform duration-100 hover:scale-105 hover:shadow-lg hover:z-[100]",children:i.jsx(Zt,{card:ne,isFaceUp:!0,playerColorMap:new Map,extraPowerSpacing:!0})}),i.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black/80 text-white text-[10px] text-center py-0.5 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none truncate px-1",children:o("clickToAdd")})]},z)}),I.length===0&&i.jsx("div",{className:"col-span-full text-center text-gray-500 py-10",children:"No cards match your filters."})]})})]}),i.jsxs("div",{className:"w-80 md:w-96 bg-gray-800 flex flex-col border-l border-gray-700 flex-shrink-0",children:[i.jsxs("div",{className:"p-4 bg-gray-800 border-b border-gray-600",children:[i.jsx("h3",{className:"text-xl font-bold text-white",children:o("currentDeck")}),i.jsxs("p",{className:`text-sm font-bold mt-1 ${V>co?"text-red-500":"text-indigo-400"}`,children:[V," / ",co," Cards"]})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-2 space-y-2",children:[h.size===0&&i.jsxs("div",{className:"text-center text-gray-500 mt-10",children:[i.jsx("p",{children:o("emptyDeck")}),i.jsx("p",{className:"text-xs mt-2",children:o("clickToAdd")})]}),Array.from(h.entries()).map(([z,K])=>{var Ie,_e,Y;const ne=Fi(z);if(!ne)return null;const W={...ne,id:z,baseId:z,deck:ne.faction==="Neutral"?Be.Neutral:ne.faction||Be.Custom,ownerId:0},he=r(z),Ne=he?he.name:ne.name,v=(Ie=ne.types)==null?void 0:Ie.includes("Hero"),L=(_e=ne.types)==null?void 0:_e.includes("Rarity"),$=pi.has(z)||((Y=ne.types)==null?void 0:Y.includes("Command")),ee=v||L?1:$?2:3,oe=v||L?"Max 1 (Rarity/Hero)":$?"Max 2 (Command)":"Max 3";return i.jsxs("div",{className:"flex items-center bg-gray-700 rounded p-2 group hover:bg-gray-600 transition-colors select-none",children:[i.jsx("div",{className:"w-12 h-12 flex-shrink-0 mr-3 cursor-pointer",onContextMenu:Ae=>{Ae.preventDefault(),n({card:W})},children:i.jsx(Zt,{card:W,isFaceUp:!0,playerColorMap:new Map,hidePower:!0})}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("div",{className:"font-bold text-sm text-white truncate",children:Ne}),i.jsxs("div",{className:"text-xs text-gray-400 truncate",children:[ne.faction," ",v||L?"(Hero/Rarity)":""]})]}),i.jsxs("div",{className:"flex items-center gap-2 ml-2",children:[i.jsx("button",{onClick:()=>we(z),className:"w-6 h-6 flex items-center justify-center bg-gray-800 hover:bg-red-900 text-gray-300 rounded text-sm font-bold",title:"Remove one",children:"-"}),i.jsx("span",{className:"font-bold text-white w-4 text-center",children:K}),i.jsx("button",{onClick:()=>ce(z),className:"w-6 h-6 flex items-center justify-center bg-gray-800 hover:bg-green-900 text-gray-300 rounded text-sm font-bold disabled:opacity-30 disabled:cursor-not-allowed",title:oe,disabled:K>=ee,children:"+"})]})]},z)})]})]})]})]})}):null},Xg=({isOpen:e,onClose:t,onSave:n})=>{const{language:r,setLanguage:o,t:a}=Nt(),[s,l]=p.useState(window.location.href);if(p.useEffect(()=>{if(e){const d=localStorage.getItem("custom_ws_url")||"";l(d)}},[e]),!e)return null;const c=()=>{localStorage.setItem("custom_ws_url",s),window.dispatchEvent(new Event("storage")),n(s)};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-8 shadow-xl w-full max-w-xl",children:[i.jsx("h2",{className:"text-2xl font-bold mb-6",children:a("settings")}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"language-select",className:"block text-sm font-medium text-gray-300 mb-1",children:a("language")}),i.jsx("select",{id:"language-select",value:r,onChange:d=>o(d.target.value),className:"w-full bg-gray-700 border border-gray-600 text-white font-sans rounded-lg p-2 focus:ring-indigo-500 focus:border-indigo-500",children:Rg.map(d=>i.jsx("option",{value:d,children:Ag[d]},d))})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"server-url",className:"block text-sm font-medium text-gray-300 mb-1",children:a("serverAddress")}),i.jsx("input",{id:"server-url",type:"text",value:s,onChange:d=>l(d.target.value),placeholder:"e.g., ws://localhost:8080 or wss://my-server.com",className:"w-full bg-gray-700 border border-gray-600 text-white font-mono rounded-lg p-2 focus:ring-indigo-500 focus:border-indigo-500",onKeyDown:d=>d.key==="Enter"&&c()})]})]}),i.jsxs("div",{className:"flex justify-end mt-8 space-x-3",children:[i.jsx("button",{type:"button",onClick:t,className:"bg-gray-600 hover:bg-gray-700 text-white font-bold py-2 px-4 rounded",children:a("cancel")}),i.jsx("button",{onClick:c,className:"bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition-colors",children:a("saveApply")})]})]})})},ev={title:'Game Rules: "New Avalon: Skirmish"',conceptTitle:"I. General Concept",conceptText:`**Genre & Role:** New Avalon: Skirmish is a fast-paced tactical duel card game played on a restricted grid battlefield. Players act as faction leaders, deploying Units and Commands to seize control of key lines.

**Explanation:** The game focuses on positional control and the timing of ability activation rather than just direct attacks. Victory is achieved by accumulating Victory Points (VP) based on the power of your units in selected lines.`,winConditionTitle:"II. Victory Conditions",winConditionText:`**Match Victory:** A match is played until a player wins 2 rounds. The first player to reach 2 round wins immediately wins the match.
**Match Draw:** If multiple players reach 2 round wins simultaneously after any round, they are all declared match winners.

**Round Victory (Thresholds & Limits):** A round ends as soon as one or more players reach the Victory Point (VP) threshold, or after the 5th turn is completed.
**Turn Limit:** Each round is limited to 5 full turns per player. If the VP threshold is not met, a final scoring occurs at the end of Turn 5 to determine the winner.

**Thresholds:**
- Round 1: 20 Victory Points (VP).
- Round 2: 30 Victory Points (VP).
- Round 3+: Threshold increases by +10 VP from the previous round (e.g., Round 3 is 40 VP).

**Determining Round Winner:** The winner is the player who hits the threshold first, or the player with the highest VP after the turn limit.
**Round Draw:** If two or more players have the same highest score at the end of a round, they all are declared winners of that round.`,fieldTitle:"III. Game Board & Components",fieldText:`**Battlefield (Grid):** The game takes place on a square grid, the size of which depends on the total number of participating players.
**Sizes:**
- 2 Players: 5x5 grid.
- 3 Players: 6x6 grid.
- 4 Players: 7x7 grid.

**Positioning Definitions:**
- **Line:** Refers to an entire horizontal Row or vertical Column. Used for the Scoring mechanic.
- **Adjacency:** Cells are considered adjacent only horizontally and vertically (orthogonally). Diagonal adjacency does not count unless specified otherwise on a card.

**Cards:** Two main types of cards are played from Hand:
- **Units:** The main combat entities, possessing Power and Abilities. They remain on the battlefield until destroyed.
- **Commands:** Instant-effect cards. They are played, execute their effect (often offering a "Choose 1 of 2 options" choice), and are then sent to the Discard pile.

**Game Zones:**
- **Hand:** Cards hidden from opponents.
- **Discard:** The zone where destroyed Units and played Commands go.
- **Showcase/Announced:** A temporary zone where a Command card is placed before it resolves.`,setupTitle:"IV. Game Start (Setup)",setupText:`**Deck Construction:** Before the match begins, each player selects a faction or builds a deck according to construction rules (minimum 30 cards).
**Explanation:** Decks are shuffled.

**Starting Hand:** Each player draws 6 cards from their deck to form their starting hand.
**Hidden Information:** Cards in hand are hidden from opponents.

**Mulligan:** Once at the start of the game, after drawing the starting hand, a player may shuffle any number of cards from their hand back into the deck and draw the same number of new cards.

**First Player Determination:** Determine the first active player by any convenient method (e.g., coin toss).
**Explanation:** Play proceeds in turn order, starting with the first player. The first player begins their first turn directly in the Setup Phase.`,abilitiesTitle:"V. Card Abilities",abilitiesText:`**Ability Types:**
- **Deploy:** Triggers automatically and immediately when the card is played from hand onto the battlefield face-up.
- **Setup:** Triggers automatically at the start of the Setup Phase of each of your turns (before drawing a card), if the card is already face-up on the battlefield.
- **Commit:** Triggers automatically at the start of the Commit Phase of each of your turns, if the card is already face-up on the battlefield.
- **Pas (Passive):** The effect is constantly active as long as the card is on the battlefield and face-up.

**Conditions ():**
Many abilities have a requirement denoted by an arrow (e.g., **Support  Deploy:** ...).
- This means "CONDITION  EFFECT".
- If the condition to the left of the arrow (e.g., having Support status) is not met at the moment of activation, the ability **does not trigger** at all.

**Important Rules:**
- **Stun:** Stunned cards (with a Stun token) **do not activate** their abilities (neither Deploy, nor Phased, nor Passive).
- **Face-down:** Cards played face-down have no abilities.
- **Mandatory:** If an ability triggers (conditions met), you **must** apply its effect if there are legal targets. If there are no legal targets, the ability fizzles.`,statusesTitle:"VI. Dynamic Statuses (Positioning)",statusesText:`Dynamic statuses are calculated automatically and constantly updated with any change on the board. Units with the Stun status cannot provide or participate in the calculation of these statuses.

**Support:** A unit has the Support status if there is an allied unit in at least one adjacent cell (horizontal or vertical).
**Stun/Support:** A unit with a Stun token is ignored when calculating Support for adjacent allies.
**Significance:** Having Support is a condition for activating many powerful abilities, denoted by the syntax **Support  [Effect]**.

**Threat:** A unit receives the Threat status if it is in a dangerous position created by enemy units.
**Conditions:** Threat status is assigned in one of two cases:
1. **Pinned:** The unit is sandwiched between cards of a single opponent on any two sides (two adjacent or two opposite sides).
2. **Cornered:** The unit is on the edge of the battlefield and has at least one opponent card adjacent to it.
**Stun/Threat:** A unit with a Stun token is ignored when calculating Threat for adjacent enemies.
**Significance:** Units under Threat are vulnerable targets for powerful control and destruction abilities.`,countersTitle:"VII. Counters",countersText:`Counters are persistent markers placed by card abilities. They remain on a unit until removed or the unit is destroyed.

**Stun (O):**
- **Effect:** A Stunned unit generates 0 VP during the Scoring Phase, cannot activate its abilities, and cannot be moved by its owner (but can be moved by opponents).
- **Removal:** At the end of the Commit Phase, 1 Stun token is automatically removed from every unit owned by the active player.

**Shield (S):**
- **Effect:** If an ability attempts to Destroy this unit, the destruction effect is prevented, and 1 Shield token is removed instead. The unit remains on the field.

**Revealed & Face-down:**
- **Revealed:** Allows the player who owns the Revealed token to see the hidden information (face) of the card.
- **Face-down Explanation:** A card played face-down has 0 Power and no Abilities. If such a card receives a Revealed token, its info becomes visible to the opponent, but it is still mechanically considered Face-down (0 Power, no abilities).

**Special Tokens (Aim, Exploit):**
- **Aim (A) & Exploit (E):** These tokens act as markers for faction interactions (e.g., Snipers or Hackers). By themselves, they have no inherent game effect.

**Last Played:**
- **Effect:** A temporary status automatically assigned to the last card played onto the battlefield by the active player this turn. This status determines the line the player must choose for Scoring.`,turnTitle:"VIII. Turn Structure & Timing",turnText:`The turn passes from player to player. Card abilities only trigger during their owner's turn. The active player's turn consists of four sequential phases:

**1. Setup Phase:**
- **Draw Card:** The active player draws 1 card from their deck.
- **Abilities:** Abilities of all cards on the board with the keyword **Setup:** trigger.
**Explanation:** This phase is for replenishing the hand and initial unit positioning.

**2. Main Phase (Action / Deploy):**
- **Main Action:** The active player may perform one of the following:
  - Play a Unit card (**Deploy:**) from hand to any empty cell. Its **Deploy:** ability triggers immediately.
  - Play a Command card from hand.
  - Pass.
**Command Explanation:** Command cards can be played in any quantity during this phase  before, after, or between unit deployments.

**3. Commit Phase:**
- **Abilities:** Abilities of all cards on the board with the keyword **Commit:** trigger.
- **Remove Stun:** At the end of this phase, 1 Stun token is automatically removed from every unit owned by the active player.
**Explanation:** This phase is used for applying control effects and gaining resources before scoring.

**4. Scoring Phase:**
- **Line Selection:** The active player must choose one Line (Row or Column) that passes through their card with the **Last Played** status.
- **Counting:** The Power of all units owned by the active player in the chosen line is summed up, and the total is added to the player's score.`,mechanicsTitle:"IX. Conflict Resolution & Key Mechanics",mechanicsText:`**Stun & Scoring:**
- **Effect:** A unit with Stun status or one that is Face-down contributes 0 points during the Scoring Phase, regardless of its base Power, permanent modifiers, or passive abilities that generate points (e.g., Spotter).

**Last Played Transfer:**
- **Destruction:** If the card with Last Played status leaves the battlefield (destroyed, returned to hand/deck) before the Scoring Phase, the status is transferred to the *previous* card played by that player (the one that was Last Played in the previous turn/action).
- **Movement:** If the card with Last Played moves to another cell, the player chooses lines based on its new position during Scoring.
- **Absence:** If a player has no cards on the board with Last Played status, they cannot choose a line and gain no points this turn.

**Unit Movement (Push, Swap):**
- **Push:** A unit forces another card to move to an adjacent cell. The push is blocked (does not happen) if the destination is an occupied cell or the edge of the board. Other effects of the ability still apply to the target.
- **Swap:** Allows two cards to trade places, even if both cells are occupied.

**Resurrect:**
- **Burnout Mechanic:** A card returned to the battlefield from the Discard pile (resurrected) immediately gains the **Resurrected** status upon Deploy. At the start of the next phase (phase change), this status is removed, and the card receives two Stun tokens.`,creditsTitle:"X. Credits",creditsText:`**Author:** Nikita Anahoret

**Powered By:**
- Google AI Studio
- Gemini
- ChatGPT

**Special Thanks:**
- Vasilisa Versus
- Kirill Tomashchuk
- Andrey Markosov
- Mitya Shepelin

For questions and suggestions, please contact via Telegram or Discord.
Support game development and authors via DonationAlerts and Patreon.`},tv="https://res.cloudinary.com/dxxh6meej/image/upload/v1764622845/Reclaimed_Gawain_sg6257.png",nv="/images/cards/NEU_RECLAIMED_GAWAIN.png",Mn={gawain:{id:"demo_gawain",name:'Reclaimed "Gawain"',deck:Be.Neutral,power:5,imageUrl:tv,fallbackImage:nv,ability:`Deploy: Shield 1. Push an adjacent card 1 cell. May take its place.
Setup: Destroy an adjacent card with threat or stun.`,types:["Unit","Device","Rarity"],faction:"Neutral",ownerId:1},riot:{id:"demo_riot",name:"Riot Agent",deck:Be.SynchroTech,power:3,imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253337/SYN_RIOT_AGENT_jurf4t.png",fallbackImage:"/images/cards/SYN_RIOT_AGENT.png",ability:"Deploy: Push.",types:["Unit","SynchroTech"],faction:"SynchroTech",ownerId:1},princeps:{id:"demo_princeps",name:"Princeps",deck:Be.Optimates,power:3,imageUrl:"https://res.cloudinary.com/dxxh6meej/image/upload/v1763253332/OPT_PRINCEPS_w3o5lq.png",fallbackImage:"/images/cards/OPT_PRINCEPS.png",ability:"",types:["Unit","Optimates"],faction:"Optimates",ownerId:2}},Gd=new Map([[1,"blue"],[2,"red"]]),rv=e=>e.split(/(\*\*.*?\*\*)/g).map((t,n)=>t.startsWith("**")&&t.endsWith("**")?i.jsx("strong",{className:"text-indigo-300",children:t.slice(2,-2)},n):t),No=({children:e})=>i.jsxs("div",{className:"w-full h-full bg-board-bg/50 rounded-xl shadow-inner border-2 border-gray-600/50 flex items-center justify-center overflow-hidden relative p-4",children:[i.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(ellipse_at_center,_var(--tw-gradient-stops))] from-indigo-900/20 via-transparent to-transparent pointer-events-none"}),e]}),ov=()=>i.jsx(No,{children:i.jsxs("div",{className:"flex gap-16 items-center justify-center relative pl-4 scale-90 md:scale-100",children:[i.jsxs("div",{className:"relative w-48 h-48 flex-shrink-0",children:[i.jsx(Zt,{card:Mn.gawain,isFaceUp:!0,playerColorMap:Gd,localPlayerId:1,disableTooltip:!0}),i.jsx("div",{className:"absolute -bottom-2 -right-2 w-full h-full pointer-events-none",children:i.jsxs("div",{className:"absolute bottom-[-45px] right-[5px] flex flex-col items-center",children:[i.jsx("div",{className:"w-px h-8 bg-white mb-1"}),i.jsx("div",{className:"bg-red-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white whitespace-nowrap",children:"Power"})]})})]}),i.jsx("div",{className:"relative w-80 flex-shrink-0",children:i.jsxs("div",{className:"bg-gray-900 border border-gray-700 rounded-md shadow-2xl p-3 text-white relative",children:[i.jsx(as,{card:Mn.gawain}),i.jsxs("div",{className:"absolute top-4 -left-[90px] flex items-center",children:[i.jsx("div",{className:"bg-indigo-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white",children:"Name"}),i.jsx("div",{className:"w-[60px] h-px bg-white ml-2"}),i.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full -ml-1"})]}),i.jsxs("div",{className:"absolute top-10 -left-[90px] flex items-center",children:[i.jsx("div",{className:"bg-purple-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white",children:"Types"}),i.jsx("div",{className:"w-[60px] h-px bg-white ml-2"}),i.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full -ml-1"})]}),i.jsxs("div",{className:"absolute bottom-12 -left-[90px] flex items-center",children:[i.jsx("div",{className:"bg-green-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full shadow-lg border border-white",children:"Abilities"}),i.jsx("div",{className:"w-[60px] h-px bg-white ml-2"}),i.jsx("div",{className:"w-1.5 h-1.5 bg-white rounded-full -ml-1"})]})]})})]})}),$o=({text:e,subtext:t,color:n,top:r,left:o,subtextAbove:a=!1})=>{const s=n==="green"?"border-green-500/50":"border-red-500/50",l=n==="green"?"text-green-400":"text-red-400";return i.jsxs("div",{className:`absolute ${r} ${o} text-center w-28 pointer-events-none z-20 flex flex-col items-center`,children:[t&&a&&i.jsx("div",{className:"text-gray-400 text-[9px] font-semibold mb-0.5 leading-tight whitespace-nowrap",children:t}),i.jsx("div",{className:`${l} font-bold text-[10px] uppercase tracking-wider bg-gray-900/90 px-2 py-1 rounded shadow-sm border ${s}`,children:e}),t&&!a&&i.jsx("div",{className:"text-gray-400 text-[9px] font-semibold mt-0.5 leading-tight",children:t})]})},av=()=>{const e=Array(16).fill(null),t={...Mn.riot,id:"s1",statuses:[{type:"Support",addedByPlayerId:1}]},n={...Mn.riot,id:"s2",statuses:[{type:"Support",addedByPlayerId:1}]},r={...Mn.princeps,id:"e1",statuses:[{type:"Threat",addedByPlayerId:1}]},o={...Mn.riot,id:"v1",statuses:[{type:"Threat",addedByPlayerId:2}]},a={...Mn.princeps,id:"e2",statuses:[{type:"Threat",addedByPlayerId:1}]};return i.jsx(No,{children:i.jsxs("div",{className:"relative scale-[0.8] md:scale-100 origin-center",children:[i.jsx("div",{className:"grid grid-cols-4 grid-rows-4 gap-1 w-[460px] h-[452px]",children:e.map((s,l)=>{const c=Math.floor(l/4),d=l%4;let h=null;return c===1&&d===0&&(h=t),c===1&&d===1&&(h=n),c===2&&d===1&&(h=r),c===2&&d===2&&(h=o),c===2&&d===3&&(h=a),i.jsx("div",{className:"relative w-full h-full bg-board-cell/30 rounded border border-white/5 flex items-center justify-center",children:h&&i.jsx("div",{className:"w-28 h-28 p-0",children:i.jsx(Zt,{card:h,isFaceUp:!0,playerColorMap:Gd,localPlayerId:1,disableTooltip:!0,smallStatusIcons:!0})})},l)})}),i.jsx($o,{text:"Support",subtext:"Adjacent Ally",color:"green",top:"top-[68px]",left:"left-[0px]",subtextAbove:!0}),i.jsx($o,{text:"Support",subtext:"Adjacent Ally",color:"green",top:"top-[68px]",left:"left-[116px]",subtextAbove:!0}),i.jsx($o,{text:"Threat",subtext:"Pinned",color:"red",top:"top-[345px]",left:"left-[116px]"}),i.jsx($o,{text:"Threat",subtext:"Pinned",color:"red",top:"top-[345px]",left:"left-[232px]"}),i.jsx($o,{text:"Threat",subtext:i.jsxs(i.Fragment,{children:["Cornered",i.jsx("br",{}),"(Enemy + Edge)"]}),color:"red",top:"top-[345px]",left:"left-[348px]"})]})})},iv=()=>i.jsx(No,{children:i.jsxs("div",{className:"grid grid-cols-4 gap-1 w-64 aspect-square relative scale-[1.3] origin-center",children:[Array.from({length:16}).map((e,t)=>i.jsx("div",{className:"bg-board-cell/40 rounded border border-white/5"},t)),i.jsx("div",{className:"absolute top-[25%] left-0 right-0 h-[25%] bg-yellow-500/30 border-y-2 border-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.4)] pointer-events-none flex items-center justify-end px-2 z-10",children:i.jsx("span",{className:"text-[8px] font-black text-yellow-200 uppercase tracking-wider drop-shadow-md",children:"Row"})}),i.jsx("div",{className:"absolute top-0 bottom-0 left-[50%] w-[25%] bg-indigo-500/30 border-x-2 border-indigo-500 shadow-[0_0_10px_rgba(99,102,241,0.4)] pointer-events-none flex items-end justify-center py-2 z-10",children:i.jsx("span",{className:"text-[8px] font-black text-indigo-200 uppercase tracking-wider whitespace-nowrap drop-shadow-md mb-1",children:"Column"})})]})}),sv=({demoImageRefreshVersion:e})=>{const t=[Mn.gawain,Mn.riot,Mn.gawain];return i.jsx(No,{children:i.jsxs("div",{className:"flex flex-col items-center gap-6 w-full",children:[i.jsxs("div",{className:"bg-gray-800 rounded-lg p-3 shadow-xl border border-gray-700 w-auto",children:[i.jsx("div",{className:"text-[10px] text-gray-400 mb-2 font-bold uppercase tracking-wider pl-1",children:"Hand (6 Cards)"}),i.jsx("div",{className:"flex gap-2 justify-center bg-gray-900/50 rounded p-2",children:t.map((n,r)=>i.jsx("div",{className:"w-28 h-28 flex-shrink-0 relative shadow-lg",children:i.jsx(Zt,{card:{...n,id:`hand_demo_${r}`},isFaceUp:!0,playerColorMap:Gd,localPlayerId:1,disableTooltip:!0,imageRefreshVersion:e})},r))})]}),i.jsxs("div",{className:"flex items-center gap-2 opacity-70",children:[i.jsx("div",{className:"w-8 h-8 rounded-full border-2 border-dashed border-white/30 flex items-center justify-center animate-pulse",children:i.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3",className:"text-indigo-400",children:i.jsx("path",{d:"M12 5v14M19 12l-7 7-7-7"})})}),i.jsx("span",{className:"text-xs text-gray-400",children:"Drag to Board"})]})]})})},lv=()=>{const e=["Stun","Shield","Revealed","Aim","Exploit","Support","Threat"],t="https://res.cloudinary.com/dxxh6meej/image/upload/v1763653192/background_counter_socvss.png";return i.jsx(No,{children:i.jsx("div",{className:"grid grid-cols-4 gap-4 p-4 w-full",children:e.map(n=>{const r=Eo[n];return i.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 bg-gray-800/50 rounded border border-white/5 hover:bg-gray-800 transition-colors",children:[i.jsx("div",{className:"w-10 h-10 rounded-full border-2 border-white/30 flex items-center justify-center shadow-lg relative",style:{backgroundImage:`url(${t})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:r?i.jsx("img",{src:r,alt:n,className:"w-6 h-6 object-contain drop-shadow-md"}):i.jsx("span",{className:"font-bold text-white text-base",children:n[0]})}),i.jsx("span",{className:"text-[10px] font-bold text-gray-300 uppercase tracking-wider text-center leading-tight",children:n})]},n)})})})},dv=({isOpen:e,onClose:t})=>{const{resources:n,t:r}=Nt(),o=n.rules&&n.rules.title?n.rules:ev,a=p.useMemo(()=>Date.now(),[]),s=p.useMemo(()=>[{id:"concept",title:o.conceptTitle,text:o.conceptText,visual:i.jsx(ov,{})},{id:"winCondition",title:o.winConditionTitle,text:o.winConditionText,visual:i.jsx(No,{children:i.jsxs("div",{className:"text-center text-yellow-400 font-black text-8xl font-mono bg-gray-900 p-10 rounded-3xl border-8 border-yellow-500 shadow-[0_0_50px_#eab308] scale-[1.2]",children:["30 ",i.jsx("div",{className:"text-lg font-bold text-gray-400 font-sans mt-2 uppercase tracking-widest",children:"Points"})]})})},{id:"field",title:o.fieldTitle,text:o.fieldText,visual:i.jsx(iv,{})},{id:"setup",title:o.setupTitle,text:o.setupText,visual:i.jsx(sv,{demoImageRefreshVersion:a})},{id:"abilities",title:o.abilitiesTitle,text:o.abilitiesText,visual:null},{id:"statuses",title:o.statusesTitle,text:o.statusesText,visual:i.jsx(av,{})},{id:"counters",title:o.countersTitle,text:o.countersText,visual:i.jsx(lv,{})},{id:"turn",title:o.turnTitle,text:o.turnText,visual:null},{id:"mechanics",title:o.mechanicsTitle,text:o.mechanicsText,visual:null},{id:"credits",title:o.creditsTitle,text:o.creditsText,visual:null}],[o,a]),[l,c]=p.useState("concept"),d=p.useMemo(()=>s.find(h=>h.id===l)||s[0],[l,s]);return e?i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[100]",onClick:t,children:i.jsxs("div",{className:"bg-gray-900 w-[95vw] h-[90vh] rounded-xl shadow-2xl flex overflow-hidden border border-gray-700",onClick:h=>h.stopPropagation(),children:[i.jsxs("div",{className:"w-64 bg-gray-800 border-r border-gray-700 flex flex-col flex-shrink-0",children:[i.jsx("div",{className:"p-4 border-b border-gray-700 bg-gray-850",children:i.jsx("h2",{className:"text-xl font-bold text-indigo-400 tracking-wide",children:o.title})}),i.jsx("div",{className:"flex-grow overflow-y-auto p-2 space-y-1",children:s.map(h=>i.jsxs("button",{onClick:()=>c(h.id),className:`w-full text-left px-4 py-3 rounded-md transition-all duration-200 text-sm font-medium flex items-center justify-between ${l===h.id?"bg-indigo-600 text-white shadow-lg translate-x-1":"text-gray-400 hover:bg-gray-700 hover:text-gray-200"}`,children:[i.jsx("span",{className:"truncate",children:h.title}),l===h.id&&i.jsx("span",{className:"text-indigo-300",children:""})]},h.id))}),i.jsx("div",{className:"p-4 border-t border-gray-700",children:i.jsx("button",{onClick:t,className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-2 rounded transition-colors uppercase text-sm tracking-wider",children:r("close")})})]}),i.jsxs("div",{className:"flex-grow flex flex-col md:flex-row overflow-hidden bg-gray-900",children:[i.jsx("div",{className:"flex-1 p-8 overflow-y-auto custom-scrollbar",children:i.jsxs("div",{className:"max-w-2xl mx-auto",children:[i.jsx("h1",{className:"text-3xl font-black text-white mb-8 pb-4 border-b-2 border-indigo-500/50",children:d.title}),i.jsx("div",{className:"prose prose-invert prose-lg text-gray-300 leading-relaxed whitespace-pre-wrap",children:rv(d.text)})]})}),i.jsxs("div",{className:"hidden md:flex w-[45%] bg-gray-850 border-l border-gray-700 flex-col items-center justify-start p-6 relative overflow-hidden",children:[i.jsx("h3",{className:"text-center text-gray-500 text-xs uppercase tracking-[0.3em] font-bold z-20 opacity-70 mb-2 absolute top-6",children:"Visual Example"}),i.jsx("div",{className:"relative z-10 w-full h-[65%] mt-20 flex items-center justify-center",children:d.visual?d.visual:i.jsxs("div",{className:"text-gray-600 italic flex flex-col items-center opacity-40",children:[i.jsx("svg",{className:"w-16 h-16 mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"No visual available"]})})]})]})]})}):null},uv="0.2.3",cv=p.memo(({handleCreateGame:e,setSettingsModalOpen:t,handleOpenJoinModal:n,setDeckBuilderOpen:r,setRulesModalOpen:o,isJoinModalOpen:a,setJoinModalOpen:s,handleJoinGame:l,gamesList:c,isDeckBuilderOpen:d,setViewingCard:h,isSettingsModalOpen:k,handleSaveSettings:g,isRulesModalOpen:b,viewingCard:x,gameState:A,imageRefreshVersion:T,t:u})=>i.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-900 text-white relative overflow-hidden",children:[i.jsx("div",{className:"absolute inset-0 z-0 opacity-30",style:{backgroundImage:"url(https://images.unsplash.com/photo-1614728853975-69c960c725af?q=80&w=1920&auto=format&fit=crop)",backgroundSize:"cover",backgroundPosition:"center"}}),i.jsxs("div",{className:"z-10 text-center p-8 bg-black bg-opacity-60 rounded-xl shadow-2xl border border-gray-700 max-w-md w-full",children:[i.jsx("h1",{className:"text-5xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-blue-400 to-purple-600 drop-shadow-lg",children:"New Avalon"}),i.jsx("h2",{className:"text-2xl font-light mb-8 text-gray-300 tracking-widest",children:"SKIRMISH"}),i.jsxs("div",{className:"space-y-4 w-full",children:[i.jsxs("button",{onClick:e,className:"w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),u("startGame")]}),i.jsxs("button",{onClick:n,className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"})}),u("joinGame")]}),i.jsxs("button",{disabled:!0,className:"w-full bg-gray-800 text-gray-500 font-bold py-3 px-6 rounded-lg shadow-inner flex items-center justify-center gap-2 cursor-not-allowed border border-gray-700",title:u("comingSoon"),children:[i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),u("storyMode")]}),i.jsxs("button",{disabled:!0,className:"w-full bg-gray-800 text-gray-500 font-bold py-3 px-6 rounded-lg shadow-inner flex items-center justify-center gap-2 cursor-not-allowed border border-gray-700",title:u("comingSoon"),children:[i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"})}),u("puzzles")]}),i.jsxs("button",{onClick:()=>r(!0),className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"})}),u("deckBuilding")]}),i.jsxs("button",{onClick:()=>o(!0),className:"w-full bg-gray-700 hover:bg-gray-600 text-white font-bold py-3 px-6 rounded-lg shadow-lg transition-all transform hover:scale-105 flex items-center justify-center gap-2",children:[i.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),u("rules")]}),i.jsxs("button",{onClick:()=>t(!0),className:"w-full bg-gray-800 hover:bg-gray-700 text-gray-300 font-bold py-2 px-6 rounded-lg shadow transition-all flex items-center justify-center gap-2 border border-gray-600",children:[i.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"}),i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}),u("settings")]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-700 flex justify-center gap-6",children:[i.jsx("a",{href:"https://t.me/Anahoret_NewAvalon",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"Telegram",children:i.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190409/Telegram_logo.svg_rnhkud.webp",alt:"Telegram",className:"w-8 h-8"})}),i.jsx("a",{href:"https://discord.gg/U5zKADsZZY",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"Discord",children:i.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190408/discord-icon_nhgjyx.svg",alt:"Discord",className:"w-8 h-8"})}),i.jsx("a",{href:"https://www.donationalerts.com/r/anahoret",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"DonationAlerts",children:i.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190414/donationalerts_hpjtbe.png",alt:"DonationAlerts",className:"w-8 h-8 rounded"})}),i.jsx("a",{href:"https://www.patreon.com/c/AnchoriteComics",target:"_blank",rel:"noopener noreferrer",className:"transition-transform hover:scale-110",title:"Patreon",children:i.jsx("img",{src:"https://res.cloudinary.com/dxxh6meej/image/upload/v1764190408/Patreon_logo.svg_ala7gn.png",alt:"Patreon",className:"w-8 h-8"})})]})]}),i.jsxs("div",{className:"absolute bottom-4 text-gray-500 text-xs",children:["v",uv]}),i.jsx(Zg,{isOpen:a,onClose:()=>s(!1),onJoin:l,games:c}),i.jsx(Qg,{isOpen:d,onClose:()=>r(!1),setViewingCard:h}),i.jsx(Xg,{isOpen:k,onClose:()=>t(!1),onSave:g}),i.jsx(dv,{isOpen:b,onClose:()=>o(!1)}),x&&i.jsx(am,{card:x.card,ownerPlayer:x.player,onClose:()=>h(null),statusDescriptions:Bi,allPlayers:A.players,imageRefreshVersion:T})]})),fv=5,pv="https://res.cloudinary.com/dxxh6meej/image/upload/v1764252181/medal_rgbw8d.png",mv=({gameState:e,onConfirm:t,onExit:n})=>{const{t:r}=Nt();if(!e.isRoundEndModalOpen)return null;const o=e.roundWinners[e.currentRound]||[],s=!!e.gameWinner,l=e.currentRound+1,c=l*10+10,d=[...e.players].sort((b,x)=>b.id-x.id),h=e.startingPlayerId||1,k=d.findIndex(b=>b.id===h);let g=[];return k!==-1?g=[...d.slice(k),...d.slice(0,k)]:g=d,i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-[200] backdrop-blur-sm",children:i.jsxs("div",{className:"bg-gray-900 rounded-lg border-2 border-gray-700 shadow-2xl p-6 w-full max-w-md text-left relative",children:[i.jsx("div",{className:"mb-4 text-center",children:i.jsx("h2",{className:"text-sm font-bold text-gray-400 uppercase tracking-widest leading-none",children:s?r("gameOver"):`${r("round")} ${e.currentRound} ${r("roundComplete")}`})}),i.jsx("div",{className:"space-y-2 mb-4",children:g.map(b=>{const x=o.includes(b.id),A=Object.values(e.roundWinners).flat().filter(u=>u===b.id).length,T=Vt[b.color];return i.jsxs("div",{className:`flex items-center justify-between p-3 rounded bg-gray-800 border ${x?"border-yellow-500/50":"border-gray-700"}`,children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${(T==null?void 0:T.bg)||"bg-gray-500"}`}),i.jsx("span",{className:`font-bold text-lg ${x?"text-white":"text-gray-400"}`,children:b.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-xl font-bold text-white font-mono mr-2",children:b.score}),A>0&&Array.from({length:A}).map((u,m)=>i.jsx("img",{src:pv,alt:"Winner",className:"w-6 h-6 object-contain drop-shadow-md",title:r("roundWinner")},m))]})]},b.id)})}),i.jsx("hr",{className:"border-gray-600 my-2"}),i.jsxs("div",{className:"text-xs text-gray-400 flex justify-between px-1",children:[i.jsxs("span",{children:[r("endedOnTurn")," ",e.turnNumber]}),i.jsx("span",{children:"Alpha v0.1.3"})]}),i.jsx("hr",{className:"border-gray-600 my-2"}),i.jsx("div",{className:"text-sm text-gray-300 leading-snug space-y-2 mt-3",children:s?i.jsxs("div",{className:"text-center py-2",children:[i.jsx("div",{className:"text-yellow-400 font-bold text-lg mb-1",children:r("matchComplete")}),i.jsx("p",{className:"text-gray-400 text-xs",children:r("thankYouPlaying")})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-400",children:r("nextRound")}),i.jsxs("span",{className:"font-bold text-white",children:[r("round")," ",l]})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-gray-400",children:r("victoryCondition")}),i.jsxs("span",{className:"font-bold text-yellow-400",children:[c," ",r("score")]})]}),i.jsxs("div",{className:"text-xs text-gray-500 italic mt-2 text-center",children:[r("win2RoundsMatch"),i.jsx("br",{}),r(l===fv?"finalRoundMaxTurns":"max5RoundsInfo")]})]})}),i.jsx("div",{className:"mt-6 flex justify-end gap-3",children:s?i.jsxs(i.Fragment,{children:[i.jsx("button",{onClick:n,className:"flex-1 bg-red-900 hover:bg-red-800 text-white font-bold py-2 px-4 rounded border border-red-700 text-sm transition-colors",children:r("returnToMenu")}),i.jsx("button",{onClick:t,className:"flex-1 bg-green-800 hover:bg-green-700 text-white font-bold py-2 px-4 rounded border border-green-600 text-sm transition-colors",children:r("continueGame")})]}):i.jsxs("button",{onClick:t,className:"bg-green-800 hover:bg-green-700 text-white font-bold py-2 px-6 rounded border border-green-600 text-sm transition-colors w-full",children:[r("startRound")," ",l]})})]})})},Fs=e=>e.filter(n=>n.type!=="Support"&&n.type!=="Threat"&&n.type!=="LastPlayed").reduce((n,r)=>(n[r.type]=(n[r.type]||0)+1,n),{}),hv=({isOpen:e,data:t,onConfirm:n,onCancel:r})=>{const[o,a]=p.useState(()=>Fs(t.card.statuses||[])),[s,l]=p.useState(()=>Fs(t.card.statuses||[]));if(p.useEffect(()=>{if(e&&t.card){const b=Fs(t.card.statuses||[]);a(b),l(b)}},[e,t.card]),!e)return null;const c=Object.keys(s),d=b=>{const x=o[b]||0;x>0&&a({...o,[b]:x-1})},h=b=>{const x=o[b]||0,A=s[b];x<A&&a({...o,[b]:x+1})},k=c.reduce((b,x)=>b+(s[x]-o[x]),0),g=()=>{const b={};c.forEach(x=>{const A=s[x]-o[x];A>0&&(b[x]=A)}),n(b,t)};return i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-[250]",children:i.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 shadow-xl w-96 border border-gray-600",children:[i.jsx("h3",{className:"text-xl font-bold text-white mb-4 text-center",children:"Remove Counters"}),i.jsxs("p",{className:"text-gray-400 text-sm mb-6 text-center",children:["Adjust counters on ",i.jsx("strong",{children:t.card.name}),".",i.jsx("br",{}),i.jsx("span",{className:"text-xs text-gray-500",children:"Press (-) to remove, (+) to keep."})]}),i.jsxs("div",{className:"space-y-3 mb-6 bg-gray-900 p-3 rounded-lg max-h-[300px] overflow-y-auto",children:[c.length===0&&i.jsx("p",{className:"text-center text-gray-500 italic py-4",children:"No removable counters found."}),c.map(b=>{const x=o[b],A=s[b],T=Eo[b];return i.jsxs("div",{className:"flex items-center justify-between bg-gray-800 border border-gray-700 p-3 rounded",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-8 h-8 flex items-center justify-center bg-gray-700 rounded-sm",children:T?i.jsx("img",{src:T,className:"w-6 h-6 object-contain",alt:`${b} icon`}):i.jsx("span",{className:"font-bold text-white",children:b[0]})}),i.jsx("div",{children:i.jsx("div",{className:"text-gray-200 font-medium leading-none",children:b})})]}),i.jsxs("div",{className:"flex items-center bg-gray-700 rounded border border-gray-600",children:[i.jsx("button",{onClick:()=>d(b),disabled:x===0,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-gray-600 disabled:opacity-30 disabled:hover:bg-transparent transition-colors",children:"-"}),i.jsx("div",{className:"w-8 text-center font-bold text-white select-none",children:x}),i.jsx("button",{onClick:()=>h(b),disabled:x>=A,className:"w-8 h-8 flex items-center justify-center text-gray-400 hover:text-white hover:bg-gray-600 disabled:opacity-30 disabled:hover:bg-transparent transition-colors",children:"+"})]})]},b)})]}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-700",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-400 text-sm",children:"Total Removed:"}),i.jsx("span",{className:"text-indigo-400 font-bold text-xl ml-2",children:k})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:r,className:"px-4 py-2 rounded bg-gray-700 hover:bg-gray-600 text-sm font-medium transition-colors",children:"Cancel"}),i.jsx("button",{onClick:g,className:"px-4 py-2 rounded bg-green-600 hover:bg-green-500 font-bold text-sm text-white shadow-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:k===0,children:"Confirm"})]})]})]})})},yv=p.memo(({isOpen:e,player:t,onClose:n,onReorder:r,onMoveToBottom:o,onMoveToHand:a,onMoveToDiscard:s,onPlayCard:l,onViewCard:c,setDraggedItem:d,playerColorMap:h,localPlayerId:k,imageRefreshVersion:g,initialCount:b=3,isLocked:x=!1})=>{const{t:A}=Nt(),[T,u]=p.useState(b),[m,f]=p.useState(null),[D,N]=p.useState(null),[_,O]=p.useState(null),[M,I]=p.useState(null),[V,ce]=p.useState([]),[we,ae]=p.useState(!1),De=p.useRef(null),me=p.useRef(null);p.useEffect(()=>{e&&(u(b),N(null),O(null),I(null),ae(!1),me.current=null)},[e,b]),p.useEffect(()=>{const $=t.deck.slice(0,Math.min(T,t.deck.length));ce($)},[t.deck,T]);const ve=p.useMemo(()=>{if(_!==null&&M!==null&&_!==M){const $=[...V],[ee]=$.splice(_,1);return $.splice(M,0,ee),$}return V},[V,_,M]),Pe=p.useCallback(($,ee)=>{$.preventDefault(),$.stopPropagation(),f({x:$.clientX,y:$.clientY,cardIndex:ee})},[]),J=p.useCallback(()=>{f(null)},[]),z=p.useCallback(()=>{!x&&T<t.deck.length&&u($=>$+1)},[x,T,t.deck.length]),K=p.useCallback(()=>{!x&&T>1&&u($=>$-1)},[x,T]),ne=p.useCallback(($,ee)=>{O(ee),N($.id),me.current=$,ae(!1)},[]),W=p.useCallback(($,ee)=>{$.preventDefault(),$.dataTransfer.dropEffect="move",M!==ee&&I(ee)},[M]),he=p.useCallback($=>{if(!me.current||!De.current)return;const ee=De.current.getBoundingClientRect(),oe=$.clientX,Ie=$.clientY;if(oe<ee.left||oe>ee.right||Ie<ee.top||Ie>ee.bottom){const _e=me.current,Y=_??0;d&&d({card:_e,source:"deck",playerId:t.id,cardIndex:Y}),ae(!0),n()}},[_,t.id,d,n]),Ne=p.useCallback(()=>{we||(N(null),O(null),I(null)),me.current=null},[we]),v=p.useCallback(($,ee)=>{if($.preventDefault(),$.stopPropagation(),I(null),we)return;if(_===null||_===ee){O(null),N(null);return}const oe=[...V],[Ie]=oe.splice(_,1);oe.splice(ee,0,Ie),ce(oe),r(t.id,oe),O(null),N(null)},[_,V,r,t.id,we]),L=p.useMemo(()=>m?[{label:A("view"),isBold:!0,onClick:()=>c(ve[m.cardIndex])},{label:A("play"),disabled:x,onClick:()=>{l(m.cardIndex)}},{label:A("moveToBottom"),onClick:()=>{o(m.cardIndex),u($=>Math.max(0,$-1))}},{isDivider:!0},{label:A("toHand"),disabled:x,onClick:()=>{a(m.cardIndex),u($=>Math.max(0,$-1))}},{label:A("toDiscard"),disabled:x,onClick:()=>{s(m.cardIndex),u($=>Math.max(0,$-1))}}]:[],[ve,x,c,l,o,a,s,m,A]);return e?i.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-80 flex items-center justify-center z-[250] backdrop-blur-sm",onClick:n,children:[i.jsxs("div",{ref:De,onDragLeave:he,className:"bg-gray-800 rounded-lg p-6 shadow-xl w-auto max-w-5xl border border-gray-600 relative flex flex-col items-center",onClick:$=>$.stopPropagation(),children:[i.jsx("h2",{className:"text-2xl font-bold text-white mb-2 text-center",children:A("topDeckView")}),i.jsxs("div",{className:"flex items-center gap-4 mb-4 bg-gray-900 p-2 rounded-full border border-gray-700",children:[i.jsx("button",{onClick:K,disabled:x||T<=1,className:"w-8 h-8 flex items-center justify-center bg-gray-700 hover:bg-red-600 rounded-full text-white font-bold disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"-"}),i.jsx("span",{className:"text-xl font-mono font-bold text-indigo-400 w-8 text-center",children:T}),i.jsx("button",{onClick:z,disabled:x||T>=t.deck.length,className:"w-8 h-8 flex items-center justify-center bg-gray-700 hover:bg-green-600 rounded-full text-white font-bold disabled:opacity-30 disabled:cursor-not-allowed transition-colors",children:"+"})]}),i.jsxs("p",{className:"text-gray-400 text-xs mb-6 text-center",children:[A("dragToReorder")," ",A("rightClickForActions")]}),i.jsx("div",{className:"flex justify-center flex-wrap gap-4 mb-8 min-h-[140px] px-4",children:ve.length===0?i.jsx("p",{className:"text-gray-500 italic",children:A("deckEmpty")}):ve.map(($,ee)=>{const oe=V.findIndex(Y=>Y.id===$.id),Ie=M===ee&&_!==ee,_e=D===$.id;return i.jsxs("div",{draggable:!0,onDragStart:()=>ne($,oe),onDragOver:Y=>W(Y,ee),onDragEnd:Ne,onDrop:Y=>v(Y,ee),onContextMenu:Y=>Pe(Y,oe),className:`w-32 h-32 relative transition-all rounded-lg
                    ${_e?"opacity-50 scale-95":"hover:scale-105 cursor-grab active:cursor-grabbing"}
                    ${Ie?"scale-105 z-10":""}
                  `,children:[i.jsxs("div",{className:"absolute -top-3 -left-2 z-20 bg-gray-900 text-gray-400 text-xs font-bold px-2 py-0.5 rounded-full border border-gray-600 shadow-md",children:["#",ee+1]}),i.jsx(Zt,{card:$,isFaceUp:!0,playerColorMap:h,localPlayerId:k,imageRefreshVersion:g})]},$.id||ee)})}),i.jsx("p",{className:"text-gray-400 text-xs mb-4 text-center",children:A("dragOutsideToMove")}),i.jsx("div",{className:"flex justify-center",children:i.jsx("button",{onClick:n,className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-8 rounded shadow-lg transition-colors",children:A("done")})})]}),m&&i.jsx("div",{className:"fixed inset-0 z-[255]",onClick:J}),m&&i.jsx(im,{x:m.x,y:m.y,onClose:J,items:L})]}):null}),bc=7,gv="mrPearlDoF",vv="reverendOfTheChoir",Cc=()=>Array(bc).fill(null).map(()=>Array(bc).fill(null).map(()=>({card:null}))),_t=e=>{var c,d;const{board:t,activeGridSize:n,players:r}=e,o=JSON.parse(JSON.stringify(t)),a=o.length,s=Math.floor((a-n)/2),l=new Map;r.forEach(h=>l.set(h.id,h.teamId));for(let h=0;h<a;h++)for(let k=0;k<a;k++){const g=o[h][k].card;g&&(g.statuses&&(g.statuses=g.statuses.filter(b=>b.type!=="Support"&&b.type!=="Threat")),delete g.bonusPower)}for(let h=0;h<a;h++)for(let k=0;k<a;k++){const g=o[h][k].card;if((g==null?void 0:g.ownerId)===void 0||g.isFaceDown)continue;const b=g.ownerId,x=l.get(b),A=[{r:h-1,c:k},{r:h+1,c:k},{r:h,c:k-1},{r:h,c:k+1}],T={};let u=!1;for(const f of A){const{r:D,c:N}=f;if(D>=0&&D<a&&N>=0&&N<a){const _=o[D][N].card,O=(c=_==null?void 0:_.statuses)==null?void 0:c.some(M=>M.type==="Stun");if((_==null?void 0:_.ownerId)!==void 0&&!_.isFaceDown&&!O){const M=_.ownerId,I=l.get(M);b===M||x!==void 0&&x===I?u=!0:(T[M]||(T[M]=[]),T[M].push({r:D,c:N}))}}}u&&(g.statuses||(g.statuses=[]),g.statuses.some(f=>f.type==="Support")||g.statuses.push({type:"Support",addedByPlayerId:b}));let m=null;for(const f in T){const D=T[f];if(D&&D.length>=2){m=parseInt(f,10);break}}if(m===null&&h>=s&&h<s+n&&k>=s&&k<s+n){const D=h===s||h===s+n-1||k===s||k===s+n-1,N=Object.keys(T).length>0;if(D&&N){const _=Object.keys(T)[0];_&&(m=parseInt(_,10))}}m!==null&&(g.statuses||(g.statuses=[]),g.statuses.some(f=>f.type==="Threat")||g.statuses.push({type:"Threat",addedByPlayerId:m}))}for(let h=0;h<a;h++)for(let k=0;k<a;k++){const g=o[h][k].card,b=(d=g==null?void 0:g.statuses)==null?void 0:d.some(T=>T.type==="Stun");if(!(g!=null&&g.baseId)||g.isFaceDown||g.ownerId===void 0||b)continue;const x=g.baseId,A=g.ownerId;if(x===vv){for(let T=0;T<a;T++){const u=o[h][T].card;u&&u.ownerId===A&&!u.isFaceDown&&u.id!==g.id&&(u.statuses||(u.statuses=[]),u.statuses.some(m=>m.type==="Support")||u.statuses.push({type:"Support",addedByPlayerId:A}))}for(let T=0;T<a;T++){const u=o[T][k].card;u&&u.ownerId===A&&!u.isFaceDown&&u.id!==g.id&&(u.statuses||(u.statuses=[]),u.statuses.some(m=>m.type==="Support")||u.statuses.push({type:"Support",addedByPlayerId:A}))}}if(x===gv){for(let T=0;T<a;T++){const u=o[h][T].card;u&&u.ownerId===A&&!u.isFaceDown&&u.id!==g.id&&(u.bonusPower=(u.bonusPower||0)+1)}for(let T=0;T<a;T++){const u=o[T][k].card;u&&u.ownerId===A&&!u.isFaceDown&&u.id!==g.id&&(u.bonusPower=(u.bonusPower||0)+1)}}}return o},Bs={info:(...e)=>{},warn:(...e)=>{console.warn(...e)},error:(...e)=>{console.error(...e)},debug:(...e)=>{}},xv=()=>{const e=localStorage.getItem("custom_ws_url")||window.location.href;if(e&&e.trim()!==""){let t=e.trim();return t.startsWith("https://")?t=t.replace("https://","wss://"):t.startsWith("http://")&&(t=t.replace("http://","ws://")),t}return null},wv=()=>Math.random().toString(36).substring(2,18).toUpperCase(),Tc=(e,t)=>{var r;e.forEach(o=>o.forEach(a=>{var s;(s=a.card)!=null&&s.statuses&&(a.card.statuses=a.card.statuses.filter(l=>!(l.type==="LastPlayed"&&l.addedByPlayerId===t.id)))})),t.boardHistory||(t.boardHistory=[]);let n=!1;for(;t.boardHistory.length>0&&!n;){const o=t.boardHistory[t.boardHistory.length-1];for(let a=0;a<e.length;a++){for(let s=0;s<e[a].length;s++)if(((r=e[a][s].card)==null?void 0:r.id)===o){const l=e[a][s].card;if(!l)continue;l.statuses||(l.statuses=[]),l.statuses.push({type:"LastPlayed",addedByPlayerId:t.id}),n=!0;break}if(n)break}n||t.boardHistory.pop()}},kv=()=>{const e=p.useCallback((y,w,E)=>{const R=Ui[y];if(!R)return console.error(`Deck data for ${y} not loaded! Returning empty deck.`),[];const j=[...R].map(S=>({...S,ownerId:w,ownerName:E}));return Xa(j)},[]),t=p.useCallback((y,w=!1)=>{const E=Object.keys(Ui)[0],R={id:y,name:w?`Dummy ${y-1}`:`Player ${y}`,score:0,hand:[],deck:[],discard:[],announcedCard:null,selectedDeck:E,color:Cg[y-1]||"blue",isDummy:w,isReady:!1,boardHistory:[],autoDrawEnabled:!0};return R.deck=e(E,y,R.name),R},[e]),n=p.useCallback(()=>({players:[],board:Cc(),activeGridSize:7,gameId:null,dummyPlayerCount:0,isGameStarted:!1,gameMode:vr.FreeForAll,isPrivate:!0,isReadyCheckActive:!1,revealRequests:[],activePlayerId:null,startingPlayerId:null,currentPhase:0,isScoringStep:!1,preserveDeployAbilities:!1,autoAbilitiesEnabled:!0,autoDrawEnabled:!0,currentRound:1,turnNumber:1,roundEndTriggered:!1,roundWinners:{},gameWinner:null,isRoundEndModalOpen:!1}),[]),[r,o]=p.useState(n),[a,s]=p.useState(null),[l,c]=p.useState(null),[d,h]=p.useState("Connecting"),[k,g]=p.useState([]),[b,x]=p.useState(null),[A,T]=p.useState(null),[u,m]=p.useState(null),f=p.useRef(null),D=p.useRef(null),N=p.useRef(null),_=p.useRef(!1),O=p.useRef(r);p.useEffect(()=>{O.current=r},[r]);const M=p.useRef(a);p.useEffect(()=>{M.current=a},[a]);const I=p.useCallback(y=>{o(w=>{const E=typeof y=="function"?y(w):y;return f.current&&f.current.readyState===WebSocket.OPEN&&f.current.send(JSON.stringify({type:"UPDATE_STATE",gameState:E})),E})},[]),V=p.useCallback(()=>{if(_.current||f.current&&(f.current.readyState===WebSocket.OPEN||f.current.readyState===WebSocket.CONNECTING))return;const y=xv();if(!y){Bs.warn("No WebSocket URL configured in settings. Waiting for user input."),h("Disconnected"),D.current&&clearTimeout(D.current);return}try{f.current=new WebSocket(y)}catch(w){console.error("Failed to create WebSocket:",w),h("Disconnected"),D.current&&clearTimeout(D.current),D.current=window.setTimeout(V,3e3);return}h("Connecting"),f.current.onopen=()=>{var E;h("Connected");const w=O.current;if(w&&w.gameId&&((E=f.current)==null?void 0:E.readyState)===WebSocket.OPEN){let R;try{const j=localStorage.getItem("reconnection_data");if(j){const S=JSON.parse(j);(S==null?void 0:S.gameId)===w.gameId&&(S!=null&&S.playerToken)&&(R=S.playerToken)}}catch(j){console.warn("Failed to parse reconnection data, clearing cache:",j instanceof Error?j.message:String(j)),localStorage.removeItem("reconnection_data")}f.current.send(JSON.stringify({type:"JOIN_GAME",gameId:w.gameId,playerToken:R}))}},f.current.onmessage=w=>{try{const E=JSON.parse(w.data);if(E.type==="GAMES_LIST")g(E.games);else if(E.type==="JOIN_SUCCESS"){s(E.playerId);const R=N.current||O.current.gameId;R&&E.playerId!==null&&E.playerToken?localStorage.setItem("reconnection_data",JSON.stringify({gameId:R,playerId:E.playerId,playerToken:E.playerToken,timestamp:Date.now()})):E.playerId===null&&localStorage.removeItem("reconnection_data"),N.current=null,E.playerId===1&&setTimeout(()=>{var j;((j=f.current)==null?void 0:j.readyState)===WebSocket.OPEN&&f.current.send(JSON.stringify({type:"UPDATE_DECK_DATA",deckData:Zr}))},500)}else E.type==="CONNECTION_ESTABLISHED"?Bs.info("Connection acknowledged by server"):E.type==="DECK_DATA_UPDATED"?Bs.info("Deck data synced with server"):E.type==="ERROR"?E.message.includes("not found")||E.message.includes("Dummy")?(o(n()),s(null),localStorage.removeItem("reconnection_data")):console.warn("Server Error:",E.message):E.type==="HIGHLIGHT_TRIGGERED"?x(E.highlightData):E.type==="NO_TARGET_TRIGGERED"?m({coords:E.coords,timestamp:E.timestamp}):E.type==="FLOATING_TEXT_TRIGGERED"?T([E.floatingTextData]):E.type==="FLOATING_TEXT_BATCH_TRIGGERED"?T(E.batch):!E.type&&E.players&&E.board?o(E):console.warn("Unknown message type:",E.type,E)}catch(E){console.error("Failed to parse message from server:",w.data,E)}},f.current.onclose=()=>{h("Disconnected"),_.current||(D.current&&clearTimeout(D.current),D.current=window.setTimeout(V,3e3))},f.current.onerror=w=>console.error("WebSocket error event:",w)},[o,n]),ce=p.useCallback(()=>{f.current&&(f.current.readyState===WebSocket.OPEN||f.current.readyState===WebSocket.CONNECTING)?f.current.close():V()},[V]),we=p.useCallback(y=>{var w;if(_.current=!1,((w=f.current)==null?void 0:w.readyState)===WebSocket.OPEN){N.current=y;let E=null;try{const j=localStorage.getItem("reconnection_data");j&&(E=JSON.parse(j))}catch{localStorage.removeItem("reconnection_data")}const R={type:"JOIN_GAME",gameId:y};(E==null?void 0:E.gameId)===y&&E.playerToken&&(R.playerToken=E.playerToken),f.current.send(JSON.stringify(R))}else V(),N.current=y},[V]);p.useEffect(()=>(_.current=!1,localStorage.removeItem("reconnection_data"),V(),()=>{D.current&&clearTimeout(D.current),f.current&&(f.current.onclose=null,f.current.close())}),[V]);const ae=p.useCallback(()=>{_.current=!1,localStorage.removeItem("reconnection_data");const y=wv(),w={...n(),gameId:y,players:[t(1)]};I(w),setTimeout(()=>{var E;((E=f.current)==null?void 0:E.readyState)===WebSocket.OPEN&&(f.current.send(JSON.stringify({type:"SUBSCRIBE",gameId:y})),f.current.send(JSON.stringify({type:"UPDATE_DECK_DATA",deckData:Zr})))},100)},[I,n,t]),De=p.useCallback(()=>{var y;((y=f.current)==null?void 0:y.readyState)===WebSocket.OPEN&&f.current.send(JSON.stringify({type:"GET_GAMES_LIST"}))},[]),me=p.useCallback(()=>{var E;_.current=!0;const y=O.current.gameId,w=M.current;o(n()),s(null),localStorage.removeItem("reconnection_data"),f.current&&(f.current.onclose=null),((E=f.current)==null?void 0:E.readyState)===WebSocket.OPEN&&y&&w!==null&&f.current.send(JSON.stringify({type:"EXIT_GAME",gameId:y,playerId:w})),f.current&&f.current.close(),setTimeout(()=>{_.current=!1,V()},100)},[n,V]),ve=p.useCallback(()=>{var y;((y=f.current)==null?void 0:y.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"START_READY_CHECK",gameId:O.current.gameId}))},[]),Pe=p.useCallback(()=>{var y;((y=f.current)==null?void 0:y.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"CANCEL_READY_CHECK",gameId:O.current.gameId}))},[]),J=p.useCallback(()=>{var y;((y=f.current)==null?void 0:y.readyState)===WebSocket.OPEN&&O.current.gameId&&M.current!==null&&f.current.send(JSON.stringify({type:"PLAYER_READY",gameId:O.current.gameId,playerId:M.current}))},[]),z=p.useCallback(y=>{var w;((w=f.current)==null?void 0:w.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"ASSIGN_TEAMS",gameId:O.current.gameId,assignments:y}))},[]),K=p.useCallback(y=>{var w;((w=f.current)==null?void 0:w.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"SET_GAME_MODE",gameId:O.current.gameId,mode:y}))},[]),ne=p.useCallback(y=>{var w;((w=f.current)==null?void 0:w.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"SET_GAME_PRIVACY",gameId:O.current.gameId,isPrivate:y}))},[]),W=p.useCallback(()=>{var y;if(((y=f.current)==null?void 0:y.readyState)===WebSocket.OPEN&&O.current.gameId&&M.current===1){f.current.send(JSON.stringify({type:"UPDATE_DECK_DATA",deckData:Zr}));const w=O.current,E=JSON.parse(JSON.stringify(w));E.players.forEach(R=>{if(["hand","deck","discard"].forEach(j=>{R[j]&&(R[j]=R[j].map(S=>{const B=Ls(S.name);return B?{...S,...B}:S}))}),R.announcedCard){const j=Ls(R.announcedCard.name);j&&(R.announcedCard={...R.announcedCard,...j})}}),E.board.forEach(R=>{R.forEach(j=>{if(j.card){const S=Ls(j.card.name);S&&(j.card={...j.card,...S})}})}),f.current.send(JSON.stringify({type:"FORCE_SYNC",gameState:E})),o(E)}},[]),he=p.useCallback(()=>{I(y=>{if(M.current!==1)return y;const w=y.players.map(E=>{const R=e(E.selectedDeck,E.id,E.name);return{...E,hand:[],deck:R,discard:[],announcedCard:null,score:0,isReady:!1,boardHistory:[]}});return{...y,players:w,board:Cc(),isGameStarted:!1,isReadyCheckActive:!1,revealRequests:[],activePlayerId:null,startingPlayerId:null,currentPhase:0,isScoringStep:!1,currentRound:1,turnNumber:1,roundEndTriggered:!1,roundWinners:{},gameWinner:null,isRoundEndModalOpen:!1}})},[I,e]),Ne=p.useCallback(y=>{I(w=>{if(w.isGameStarted)return w;const E={...w,activeGridSize:y};return E.board=_t(E),E})},[I]),v=p.useCallback(y=>{I(w=>{if(w.isGameStarted)return w;const E=w.players.filter(j=>!j.isDummy);if(E.length+y>Vp)return w;const R=[...E];for(let j=0;j<y;j++){const S=R.length+1,B=t(S,!0);B.name=`Dummy ${j+1}`,R.push(B)}return{...w,players:R,dummyPlayerCount:y}})},[I,t]),L=p.useCallback((y,w,E)=>{I(R=>{var B,P;if(!R.isGameStarted)return R;const j=JSON.parse(JSON.stringify(R)),S=j.board[y.row][y.col].card;if(S){if(w==="Stun"&&(S.baseId==="luciusTheImmortal"||S.name.includes("Lucius")&&((B=S.types)!=null&&B.includes("Hero")))||["Support","Threat","Revealed"].includes(w)&&((P=S.statuses)==null?void 0:P.some(be=>be.type===w&&be.addedByPlayerId===E)))return R;S.statuses||(S.statuses=[]),S.statuses.push({type:w,addedByPlayerId:E})}return j})},[I]),$=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.board[y.row][y.col].card;if(j!=null&&j.statuses){const S=j.statuses.map(B=>B.type).lastIndexOf(w);S>-1&&j.statuses.splice(S,1)}return R.board=_t(R),R})},[I]),ee=p.useCallback((y,w,E)=>{I(R=>{if(!R.isGameStarted)return R;const j=JSON.parse(JSON.stringify(R)),S=j.board[y.row][y.col].card;if(S!=null&&S.statuses){const B=S.statuses.findIndex(P=>P.type===w&&P.addedByPlayerId===E);B>-1&&S.statuses.splice(B,1)}return j.board=_t(j),j})},[I]),oe=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.board[y.row][y.col].card;return j&&(j.powerModifier===void 0&&(j.powerModifier=0),j.powerModifier+=w),R})},[I]),Ie=p.useCallback((y,w,E)=>{I(R=>{var B;if(!R.isGameStarted)return R;const j=JSON.parse(JSON.stringify(R)),S=j.players.find(P=>P.id===y);if(S!=null&&S.announcedCard){if(["Support","Threat","Revealed"].includes(w)&&((B=S.announcedCard.statuses)==null?void 0:B.some(ye=>ye.type===w&&ye.addedByPlayerId===E)))return R;S.announcedCard.statuses||(S.announcedCard.statuses=[]),S.announcedCard.statuses.push({type:w,addedByPlayerId:E})}return j})},[I]),_e=p.useCallback((y,w)=>{I(E=>{var S;if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.players.find(B=>B.id===y);if((S=j==null?void 0:j.announcedCard)!=null&&S.statuses){const B=j.announcedCard.statuses.map(P=>P.type).lastIndexOf(w);B>-1&&j.announcedCard.statuses.splice(B,1)}return R})},[I]),Y=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.players.find(S=>S.id===y);return j!=null&&j.announcedCard&&(j.announcedCard.powerModifier===void 0&&(j.announcedCard.powerModifier=0),j.announcedCard.powerModifier+=w),R})},[I]),Ae=p.useCallback((y,w,E,R)=>{I(j=>{var P;if(!j.isGameStarted)return j;const S=JSON.parse(JSON.stringify(j)),B=S.players.find(ye=>ye.id===y);if(B!=null&&B.hand[w]){const ye=B.hand[w];if(["Support","Threat","Revealed"].includes(E)&&((P=ye.statuses)==null?void 0:P.some(et=>et.type===E&&et.addedByPlayerId===R)))return j;ye.statuses||(ye.statuses=[]),ye.statuses.push({type:E,addedByPlayerId:R})}return S})},[I]),xe=p.useCallback((y,w,E)=>{I(R=>{if(!R.isGameStarted)return R;const j=JSON.parse(JSON.stringify(R)),S=j.players.find(P=>P.id===y),B=S==null?void 0:S.hand[w];if(B!=null&&B.statuses){const P=B.statuses.map(ye=>ye.type).lastIndexOf(E);P>-1&&B.statuses.splice(P,1),E==="Revealed"&&(B.statuses.some(be=>be.type==="Revealed")||delete B.revealedTo)}return j})},[I]),re=p.useCallback(y=>{I(w=>{if(!w.isGameStarted)return w;const E=JSON.parse(JSON.stringify(w)),R=E.board[y.row][y.col].card;return R&&(R.isFaceDown=!1),E.board=_t(E),E})},[I]),Re=p.useCallback(y=>{I(w=>{if(!w.isGameStarted)return w;const E=JSON.parse(JSON.stringify(w)),R=E.board[y.row][y.col].card;return R&&(R.isFaceDown=!0),E.board=_t(E),E})},[I]),Se=p.useCallback((y,w,E)=>{I(R=>{const j=R.players.find(P=>P.id===y);if(!(j!=null&&j.hand[w]))return R;const S=JSON.parse(JSON.stringify(R)),B=S.players.find(P=>P.id===y).hand[w];if(E==="all")B.revealedTo="all",B.statuses||(B.statuses=[]),B.statuses.some(P=>P.type==="Revealed"&&P.addedByPlayerId===y)||B.statuses.push({type:"Revealed",addedByPlayerId:y});else{(!B.revealedTo||B.revealedTo==="all"||!Array.isArray(B.revealedTo))&&(B.revealedTo=[]);const P=E.filter(ye=>!B.revealedTo.includes(ye));B.revealedTo.push(...P)}return S})},[I]),de=p.useCallback((y,w)=>{I(E=>{if(!E.board[y.row][y.col].card)return E;const j=JSON.parse(JSON.stringify(E)),S=j.board[y.row][y.col].card,B=S.ownerId;if(w==="all")S.revealedTo="all",B!==void 0&&(S.statuses||(S.statuses=[]),S.statuses.some(P=>P.type==="Revealed"&&P.addedByPlayerId===B)||S.statuses.push({type:"Revealed",addedByPlayerId:B}));else{(!S.revealedTo||S.revealedTo==="all"||!Array.isArray(S.revealedTo))&&(S.revealedTo=[]);const P=w.filter(ye=>!S.revealedTo.includes(ye));S.revealedTo.push(...P)}return j})},[I]),q=p.useCallback((y,w)=>{I(E=>{var B;const R=y.boardCoords?(B=E.board[y.boardCoords.row][y.boardCoords.col].card)==null?void 0:B.ownerId:y.ownerId;if(!R)return E;const j=JSON.parse(JSON.stringify(E)),S=j.revealRequests.find(P=>P.fromPlayerId===w&&P.toPlayerId===R);return S?S.cardIdentifiers.some(ye=>JSON.stringify(ye)===JSON.stringify(y))||S.cardIdentifiers.push(y):j.revealRequests.push({fromPlayerId:w,toPlayerId:R,cardIdentifiers:[y]}),j})},[I]),H=p.useCallback((y,w)=>{I(E=>{const R=E.revealRequests.findIndex(B=>B.toPlayerId===M.current&&B.fromPlayerId===y);if(R===-1)return E;const j=JSON.parse(JSON.stringify(E)),S=j.revealRequests[R];if(w){const{cardIdentifiers:B}=S;for(const P of B){let ye=null;if(P.source==="board"&&P.boardCoords)ye=j.board[P.boardCoords.row][P.boardCoords.col].card;else if(P.source==="hand"&&P.ownerId&&P.cardIndex!==void 0){const be=j.players.find(et=>et.id===P.ownerId);be&&(ye=be.hand[P.cardIndex])}ye&&(ye.statuses||(ye.statuses=[]),ye.statuses.some(be=>be.type==="Revealed"&&be.addedByPlayerId===y)||ye.statuses.push({type:"Revealed",addedByPlayerId:y}))}}return j.revealRequests.splice(R,1),j})},[I]),Z=p.useCallback(y=>{I(w=>{const E=JSON.parse(JSON.stringify(w));let R=null;if(y.source==="board"&&y.boardCoords)R=E.board[y.boardCoords.row][y.boardCoords.col].card;else if(y.source==="hand"&&y.playerId&&y.cardIndex!==void 0){const j=E.players.find(S=>S.id===y.playerId);j&&(R=j.hand[y.cardIndex])}return R&&(R.statuses&&(R.statuses=R.statuses.filter(j=>j.type!=="Revealed")),delete R.revealedTo),E})},[I]),G=p.useCallback((y,w)=>{I(E=>E.isGameStarted?E:{...E,players:E.players.map(R=>R.id===y?{...R,name:w}:R)})},[I]),le=p.useCallback((y,w)=>{I(E=>E.isGameStarted||E.players.some(j=>j.id!==y&&!j.isDummy&&j.color===w)?E:{...E,players:E.players.map(j=>j.id===y?{...j,color:w}:j)})},[I]),je=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.players.find(S=>S.id===y);return j&&(j.score+=w),R})},[I]),Ee=p.useCallback((y,w)=>{I(E=>E.isGameStarted?E:{...E,players:E.players.map(R=>R.id===y?{...R,deck:e(w,y,R.name),selectedDeck:w,hand:[],discard:[],announcedCard:null,boardHistory:[]}:R)})},[I,e]),ie=p.useCallback((y,w)=>{I(E=>{if(E.isGameStarted)return E;const R=E.players.find(B=>B.id===y);if(!R)return E;const j=[],S=new Map;for(const{cardId:B,quantity:P}of w.cards){const ye=Fi(B);if(!ye)continue;const be=pi.has(B),et=be?Be.Command:Be.Custom,vt=be?"CMD":"CUS";for(let xt=0;xt<P;xt++){const Qe=(S.get(B)||0)+1;S.set(B,Qe),j.push({...ye,id:`${vt}_${B.toUpperCase()}_${Qe}`,baseId:B,deck:et,ownerId:y,ownerName:R.name})}}return{...E,players:E.players.map(B=>B.id===y?{...B,deck:Xa(j),selectedDeck:Be.Custom,hand:[],discard:[],announcedCard:null,boardHistory:[]}:B)}})},[I]),ke=p.useCallback(y=>{I(w=>{if(!w.isGameStarted)return w;const E=w.players.find(B=>B.id===y);if(!E||E.deck.length===0)return w;const R=JSON.parse(JSON.stringify(w)),j=R.players.find(B=>B.id===y),S=j.deck.shift();return S&&j.hand.push(S),R})},[I]),Oe=p.useCallback(y=>{I(w=>{if(!w.isGameStarted||!w.players.find(S=>S.id===y))return w;const R=JSON.parse(JSON.stringify(w)),j=R.players.find(S=>S.id===y);return j.deck=Xa(j.deck),R})},[I]),We=p.useCallback(y=>{f.current&&f.current.readyState===WebSocket.OPEN&&f.current.send(JSON.stringify({type:"TOGGLE_ACTIVE_PLAYER",gameId:O.current.gameId,playerId:y}))},[]),qe=p.useCallback((y,w)=>{f.current&&f.current.readyState===WebSocket.OPEN&&f.current.send(JSON.stringify({type:"TOGGLE_AUTO_DRAW",gameId:O.current.gameId,playerId:y,enabled:w}))},[]),$e=p.useCallback(y=>{I(w=>w.isGameStarted?{...w,currentPhase:Math.max(0,Math.min(y,Ul.length-1))}:w)},[I]),St=p.useCallback(()=>{I(y=>{if(!y.isGameStarted)return y;const w=JSON.parse(JSON.stringify(y));if(w.isScoringStep){w.isScoringStep=!1;const R=y.activePlayerId;R!==void 0&&(w.board.forEach(S=>{S.forEach(B=>{var P;if(((P=B.card)==null?void 0:P.ownerId)===R&&B.card.statuses){const ye=B.card.statuses.findIndex(be=>be.type==="Stun");ye!==-1&&B.card.statuses.splice(ye,1)}})}),w.board=_t(w));let j=R;if(j!==void 0){const S=[...w.players].sort((P,ye)=>P.id-ye.id),B=S.findIndex(P=>P.id===j);if(B!==-1){const P=(B+1)%S.length;j=S[P].id}}if(w.currentPhase=0,w.activePlayerId=j,j!==void 0&&j!==R){const S=w.players.find(B=>B.id===j);if(S&&S.deck.length>0){let B=!1;if(S.isDummy){const P=w.players.find(ye=>ye.id===1);B=(P==null?void 0:P.autoDrawEnabled)===!0}else B=S.autoDrawEnabled===!0;if(B){const P=S.deck[0];S.deck.splice(0,1),S.hand.push(P)}}}if(j!==void 0&&w.board.forEach(S=>{S.forEach(B=>{const P=B.card;P&&P.ownerId===j&&Mg(P,j)})}),w.startingPlayerId!==void 0&&j===w.startingPlayerId){const S=w.currentRound*10+10,B=w.currentRound===5&&w.turnNumber>=10;let P=-1/0;if(w.players.forEach(be=>{be.score>P&&(P=be.score)}),P>=S||B){const be=w.players.filter(Qe=>Qe.score===P).map(Qe=>Qe.id);w.roundWinners[w.currentRound]=be;const vt=Object.values(w.roundWinners).flat().reduce((Qe,Kt)=>(Qe[Kt]=(Qe[Kt]||0)+1,Qe),{}),xt=Object.keys(vt).filter(Qe=>vt[Number(Qe)]>=2).map(Qe=>Number(Qe));xt.length>0&&(w.gameWinner=xt[0]),w.isRoundEndModalOpen=!0}else w.turnNumber+=1}return w.board.forEach(S=>{S.forEach(B=>{B.card&&delete B.card.enteredThisTurn})}),w.board.forEach(S=>{S.forEach(B=>{var P;if((P=B.card)!=null&&P.statuses){const ye=B.card.statuses.findIndex(be=>be.type==="Resurrected");if(ye!==-1){const be=B.card.statuses[ye].addedByPlayerId;B.card.statuses.splice(ye,1),B.card.baseId!=="luciusTheImmortal"&&(B.card.statuses.push({type:"Stun",addedByPlayerId:be}),B.card.statuses.push({type:"Stun",addedByPlayerId:be}))}}})}),w.board=_t(w),w}const E=y.currentPhase+1;return y.preserveDeployAbilities||w.board.forEach(R=>{R.forEach(j=>{var S;(S=j.card)!=null&&S.statuses&&(j.card.statuses=j.card.statuses.filter(B=>B.type!=="readyDeploy"))})}),E>=Ul.length?(w.isScoringStep=!0,w):(w.board.forEach(R=>{R.forEach(j=>{var S;if((S=j.card)!=null&&S.statuses){const B=j.card.statuses.findIndex(P=>P.type==="Resurrected");if(B!==-1){const P=j.card.statuses[B].addedByPlayerId;j.card.statuses.splice(B,1),j.card.baseId!=="luciusTheImmortal"&&(j.card.statuses.push({type:"Stun",addedByPlayerId:P}),j.card.statuses.push({type:"Stun",addedByPlayerId:P}))}}})}),w.board=_t(w),w.currentPhase=E,w)})},[I]),bt=p.useCallback(()=>{I(y=>y.isGameStarted?y.isScoringStep?{...y,isScoringStep:!1}:{...y,currentPhase:Math.max(0,y.currentPhase-1)}:y)},[I]),Ot=p.useCallback(()=>{I(y=>{const w=JSON.parse(JSON.stringify(y));return w.isRoundEndModalOpen=!1,w.players.forEach(E=>E.score=0),w.currentRound+=1,w.roundEndTriggered=!1,w.turnNumber=1,w.gameWinner=null,w})},[I]),kn=p.useCallback((y,w)=>{I(E=>{var be,et,vt,xt,Qe,Kt;if(!E.isGameStarted||w.target==="board"&&w.boardCoords&&E.board[w.boardCoords.row][w.boardCoords.col].card!==null&&y.source!=="counter_panel")return E;let R=!1;try{const F=localStorage.getItem("auto_abilities_enabled");R=F===null?!0:F==="true"}catch{R=!0}const j=R&&E.currentPhase===0&&y.source==="hand"&&w.target==="board"&&(((be=y.card.types)==null?void 0:be.includes("Unit"))||((et=y.card.types)==null?void 0:et.includes("Command"))),S=JSON.parse(JSON.stringify(E));if(y.source==="board"&&["hand","deck","discard"].includes(w.target)&&!y.bypassOwnershipCheck){const F=y.card.ownerId,Ce=S.players.find(Me=>Me.id===F),Te=F===M.current,Ue=!!(Ce!=null&&Ce.isDummy);if(!Te&&!Ue)return E}if(S.startingPlayerId===void 0&&w.target==="board"&&y.source!=="board"){const F=y.playerId||M.current;F!==null&&(S.startingPlayerId=F)}let B=null;if(y.source==="board"&&w.target==="board"&&y.boardCoords){const F=S.board[y.boardCoords.row][y.boardCoords.col];F.card&&(B=F.card);const Te=E.board[y.boardCoords.row][y.boardCoords.col].card||B;if(Te&&((vt=Te.statuses)==null?void 0:vt.some(Me=>Me.type==="Stun"))){const Me=M.current,ct=Te.ownerId,Ct=E.players.find(un=>un.id===Me),ft=E.players.find(un=>un.id===ct),Qn=Me===ct,Aa=(Ct==null?void 0:Ct.teamId)!==void 0&&(ft==null?void 0:ft.teamId)!==void 0&&Ct.teamId===ft.teamId;if((Qn||Aa)&&!y.isManual)return E}}if(y.source==="counter_panel"&&y.statusType){const F=Gr[y.statusType];if(!((F==null?void 0:F.allowedTargets)||["board","hand"]).includes(w.target))return E;let Te=null;if(w.target==="board"&&w.boardCoords)Te=S.board[w.boardCoords.row][w.boardCoords.col].card;else if(w.playerId!==void 0){const Ue=S.players.find(Me=>Me.id===w.playerId);Ue&&(w.target==="hand"&&w.cardIndex!==void 0&&(Te=Ue.hand[w.cardIndex]),w.target==="announced"&&(Te=Ue.announcedCard||null),w.target==="deck"&&Ue.deck.length>0?w.deckPosition==="top"||!w.deckPosition?Te=Ue.deck[0]:Te=Ue.deck[Ue.deck.length-1]:w.target==="discard"&&Ue.discard.length>0&&(Te=Ue.discard[Ue.discard.length-1]))}if(Te){if(y.statusType==="Stun"&&(Te.baseId==="luciusTheImmortal"||Te.name.includes("Lucius")&&((xt=Te.types)!=null&&xt.includes("Hero"))))return S;const Ue=y.count||1,Me=S.players.find(Ct=>Ct.id===S.activePlayerId),ct=Me!=null&&Me.isDummy?Me.id:M.current!==null?M.current:0;if(y.statusType==="Power+")Te.powerModifier===void 0&&(Te.powerModifier=0),Te.powerModifier+=1*Ue;else if(y.statusType==="Power-")Te.powerModifier===void 0&&(Te.powerModifier=0),Te.powerModifier-=1*Ue;else{Te.statuses||(Te.statuses=[]);for(let Ct=0;Ct<Ue;Ct++)["Support","Threat","Revealed"].includes(y.statusType)?Te.statuses.some(Qn=>Qn.type===y.statusType&&Qn.addedByPlayerId===ct)||Te.statuses.push({type:y.statusType,addedByPlayerId:ct}):Te.statuses.push({type:y.statusType,addedByPlayerId:ct})}return w.target==="board"&&(S.board=_t(S)),S}return E}const P=B?{...B}:{...y.card};if(y.source==="hand"&&y.playerId!==void 0&&y.cardIndex!==void 0){const F=S.players.find(Ce=>Ce.id===y.playerId);F&&F.hand.splice(y.cardIndex,1)}else if(y.source==="board"&&y.boardCoords)S.board[y.boardCoords.row][y.boardCoords.col].card=null;else if(y.source==="discard"&&y.playerId!==void 0&&y.cardIndex!==void 0){const F=S.players.find(Ce=>Ce.id===y.playerId);F&&F.discard.splice(y.cardIndex,1)}else if(y.source==="deck"&&y.playerId!==void 0&&y.cardIndex!==void 0){const F=S.players.find(Ce=>Ce.id===y.playerId);F&&F.deck.splice(y.cardIndex,1)}else if(y.source==="announced"&&y.playerId!==void 0){const F=S.players.find(Ce=>Ce.id===y.playerId);F&&(F.announcedCard=null)}if(["hand","deck","discard"].includes(w.target))P.statuses&&(P.statuses=P.statuses.filter(F=>F.type==="Revealed")),P.isFaceDown=!1,delete P.powerModifier,delete P.bonusPower,delete P.enteredThisTurn;else if(w.target==="board"&&(P.statuses||(P.statuses=[]),y.source!=="board"&&P.isFaceDown===void 0&&(P.isFaceDown=!1),y.source!=="board")){P.enteredThisTurn=!0;let F=P.ownerId;F===void 0&&(y.source==="token_panel"?F=S.activePlayerId??M.current??0:F=M.current??0,P.ownerId=F),Ms(P,F),y.source==="discard"&&(P.baseId==="luciusTheImmortal"||P.name.includes("Lucius"))&&(P.powerModifier===void 0&&(P.powerModifier=0),P.powerModifier+=2)}if(w.target==="hand"&&w.playerId!==void 0){if(P.deck===Be.Tokens||P.deck==="counter")return S;zs(P);const F=S.players.find(Ce=>Ce.id===w.playerId);F&&(F.hand.push(P),y.source==="deck"&&(F.deck=Xa(F.deck)))}else if(w.target==="board"&&w.boardCoords){if(S.board[w.boardCoords.row][w.boardCoords.col].card===null){if(P.ownerId===void 0&&M.current!==null){const F=S.players.find(Ce=>Ce.id===M.current);F&&(P.ownerId=F.id,P.ownerName=F.name)}if(y.source!=="board"&&y.isManual&&P.ownerId!==void 0){const F=S.players.find(Ce=>Ce.id===P.ownerId);F&&(F.boardHistory||(F.boardHistory=[]),F.boardHistory.push(P.id))}S.board[w.boardCoords.row][w.boardCoords.col].card=P}}else if(w.target==="discard"&&w.playerId!==void 0){if(!(P.deck===Be.Tokens||P.deck==="counter")){zs(P);const F=S.players.find(Ce=>Ce.id===w.playerId);F&&(P.ownerId===void 0&&(P.ownerId=w.playerId,P.ownerName=F.name),F.discard.push(P))}}else if(w.target==="deck"&&w.playerId!==void 0){if(P.deck===Be.Tokens||P.deck==="counter")return S;zs(P);const F=S.players.find(Ce=>Ce.id===w.playerId);F&&(P.ownerId===void 0&&(P.ownerId=w.playerId,P.ownerName=F.name),w.deckPosition==="top"||!w.deckPosition?F.deck.unshift(P):F.deck.push(P))}else if(w.target==="announced"&&w.playerId!==void 0){const F=S.players.find(Ce=>Ce.id===w.playerId);F&&(F.announcedCard&&(F.announcedCard.statuses&&(F.announcedCard.statuses=F.announcedCard.statuses.filter(Ce=>Ce.type==="Revealed")),delete F.announcedCard.enteredThisTurn,delete F.announcedCard.powerModifier,delete F.announcedCard.bonusPower,F.hand.push(F.announcedCard)),F.announcedCard=P)}if(y.source==="board"&&w.target!=="board"&&P.ownerId!==void 0){const F=S.players.find(Ce=>Ce.id===P.ownerId);F&&(F.boardHistory||(F.boardHistory=[]),F.boardHistory=F.boardHistory.filter(Ce=>Ce!==P.id))}if((y.source==="board"||w.target==="board")&&P.ownerId!==void 0){const F=S.players.find(Ce=>Ce.id===P.ownerId);F&&Tc(S.board,F)}if(y.source==="hand"&&w.target==="board"){const F=P;if(F.revealedTo==="all"||((Qe=F.statuses)==null?void 0:Qe.some(Te=>Te.type==="Revealed"))){const Te=S.board.length;for(let Ue=0;Ue<Te;Ue++)for(let Me=0;Me<Te;Me++){const ct=S.board[Ue][Me].card;if(ct&&ct.name.toLowerCase().includes("vigilant spotter")&&ct.ownerId!==F.ownerId&&(S.board=_t(S),(Kt=S.board[Ue][Me].card.statuses)!=null&&Kt.some(ft=>ft.type==="Support"))){const ft=S.players.find(Qn=>Qn.id===ct.ownerId);ft&&(ft.score+=2)}}}}return(y.source==="board"||w.target==="board")&&(S.board=_t(S)),j&&(S.currentPhase=1),S})},[I]),Ut=p.useCallback((y,w,E,R)=>{I(j=>{if(!j.isGameStarted||j.board[E.row][E.col].card!==null)return j;const S=JSON.parse(JSON.stringify(j)),B=S.players.find(P=>P.id===y);if(B&&B.discard.length>w){const[P]=B.discard.splice(w,1);P.enteredThisTurn=!0,Ms(P,y),(P.baseId==="luciusTheImmortal"||P.name.includes("Lucius"))&&(P.powerModifier===void 0&&(P.powerModifier=0),P.powerModifier+=2),P.statuses||(P.statuses=[]),P.statuses.push({type:"Resurrected",addedByPlayerId:y}),R&&R.forEach(ye=>{var be;ye.type!=="Resurrected"&&((be=P.statuses)==null||be.push({type:ye.type,addedByPlayerId:y}))}),B.boardHistory||(B.boardHistory=[]),B.boardHistory.push(P.id),S.board[E.row][E.col].card=P,Tc(S.board,B),S.board=_t(S)}return S})},[I]),Ft=p.useCallback((y,w)=>{I(E=>{const R=JSON.parse(JSON.stringify(E)),j=R.players.find(S=>S.id===y);if(j&&w.length>0){const S=new Set(w.map(P=>P.id)),B=j.deck.filter(P=>!S.has(P.id));j.deck=[...w,...B]}return R})},[I]),_o=p.useCallback((y,w,E)=>{I(R=>{const j=JSON.parse(JSON.stringify(R)),S=j.players.find(B=>B.id===y);return S&&(E==="deck"?S.deck=w:E==="discard"&&(S.discard=w)),j})},[I]),ht=p.useCallback(y=>{var E;const w={...y,timestamp:Date.now()};x(w),((E=f.current)==null?void 0:E.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"TRIGGER_HIGHLIGHT",gameId:O.current.gameId,highlightData:w}))},[]),it=p.useCallback(y=>{var j;const w=Array.isArray(y)?y:[y],E=Date.now(),R=w.map((S,B)=>({...S,timestamp:E+B}));T(R),((j=f.current)==null?void 0:j.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"TRIGGER_FLOATING_TEXT_BATCH",gameId:O.current.gameId,batch:R}))},[]),Vr=p.useCallback(y=>{var E;const w=Date.now();m({coords:y,timestamp:w}),((E=f.current)==null?void 0:E.readyState)===WebSocket.OPEN&&O.current.gameId&&f.current.send(JSON.stringify({type:"TRIGGER_NO_TARGET",gameId:O.current.gameId,coords:y,timestamp:w}))},[]),Hr=p.useCallback((y,w,E,R)=>{I(j=>{if(!j.isGameStarted)return j;const S=JSON.parse(JSON.stringify(j)),B=S.board[y.row][y.col].card;return B&&R&&B.statuses&&(B.statuses=B.statuses.filter(P=>P.type!==R)),S})},[I]),$r=p.useCallback(y=>{I(w=>{if(!w.isGameStarted)return w;const E=JSON.parse(JSON.stringify(w)),R=E.board[y.row][y.col].card;if(R&&(R.statuses||(R.statuses=[]),(R.ability||"").toLowerCase().includes("deploy:")&&!R.statuses.some(S=>S.type==="readyDeploy"))){const S=R.ownerId;if(S==null||S===0)return console.warn("[resetDeployStatus] Card missing or invalid ownerId:",R.id),w;R.statuses.push({type:"readyDeploy",addedByPlayerId:S})}return E})},[I]),Tr=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.board[y.row][y.col].card;return j!=null&&j.statuses&&(j.statuses=j.statuses.filter(S=>S.type!==w)),R.board=_t(R),R})},[I]),Ve=p.useCallback((y,w,E,R,j)=>{I(S=>{if(!S.isGameStarted)return S;const B=JSON.parse(JSON.stringify(S));return w.forEach(({row:P,col:ye})=>{var et;const be=B.board[P][ye].card;if(be){if(E==="Stun"&&(be.baseId==="luciusTheImmortal"||be.name.includes("Lucius")&&((et=be.types)!=null&&et.includes("Hero"))))return;be.statuses||(be.statuses=[]),["Support","Threat","Revealed"].includes(E)?be.statuses.some(xt=>xt.type===E&&xt.addedByPlayerId===R)||be.statuses.push({type:E,addedByPlayerId:R}):be.statuses.push({type:E,addedByPlayerId:R})}}),B})},[I]),Zn=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.board[y.row][y.col].card,S=R.board[w.row][w.col].card;return R.board[y.row][y.col].card=S,R.board[w.row][w.col].card=j,R.board=_t(R),R})},[I]),Ra=p.useCallback((y,w,E)=>{I(R=>{if(!R.isGameStarted)return R;const j=JSON.parse(JSON.stringify(R)),S=j.board[y.row][y.col].card,B=j.board[w.row][w.col].card;if(S&&B&&S.statuses){const P=S.statuses.findIndex(ye=>ye.type===E);if(P>-1){const[ye]=S.statuses.splice(P,1);B.statuses||(B.statuses=[]),B.statuses.push(ye)}}return j.board=_t(j),j})},[I]),Er=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.board[y.row][y.col].card,S=R.board[w.row][w.col].card,B=["Support","Threat"];if(j&&S&&j.statuses){const P=j.statuses.filter(be=>!B.includes(be.type)),ye=j.statuses.filter(be=>B.includes(be.type));P.length>0&&(S.statuses||(S.statuses=[]),S.statuses.push(...P),j.statuses=ye)}return R.board=_t(R),R})},[I]),Ge=p.useCallback((y,w)=>{I(E=>{if(!E.isGameStarted)return E;const R=JSON.parse(JSON.stringify(E)),j=R.players.find(S=>S.id===y);if(j&&j.discard.length>w){const[S]=j.discard.splice(w,1);j.hand.push(S)}return R})},[I]),Dn=p.useCallback((y,w,E)=>{I(R=>{if(!R.isGameStarted)return R;const j=JSON.parse(JSON.stringify(R));if(!Zr)return R;const S=Zr.tokenDatabase,B=Object.keys(S).find(be=>S[be].name===w);if(!B)return R;const P=S[B],ye=j.players.find(be=>be.id===E);if(P&&j.board[y.row][y.col].card===null){const be={id:`TKN_${w.toUpperCase().replace(/\s/g,"_")}_${Date.now()}`,deck:Be.Tokens,name:w,baseId:P.baseId||B,imageUrl:P.imageUrl,fallbackImage:P.fallbackImage,power:P.power,ability:P.ability,flavorText:P.flavorText,color:P.color,types:P.types||["Unit"],faction:"Tokens",ownerId:E,ownerName:ye==null?void 0:ye.name,enteredThisTurn:!0,statuses:[]};Ms(be,E),j.board[y.row][y.col].card=be}return j.board=_t(j),j})},[I]),Wr=p.useCallback((y,w,E,R,j)=>{var Kt,F;const S=O.current;if(!S.isGameStarted)return;const B=S.board.some(Ce=>Ce.some(Te=>{var Ue,Me;return((Ue=Te.card)==null?void 0:Ue.ownerId)===j&&Te.card.name.toLowerCase().includes("data liberator")&&((Me=Te.card.statuses)==null?void 0:Me.some(ct=>ct.type==="Support"))})),P=S.board.length;let ye=y,be=y,et=w,vt=w;if(y===E)ye=y,be=y,et=0,vt=P-1;else if(w===R)et=w,vt=w,ye=0,be=P-1;else return;let xt=0;const Qe=[];for(let Ce=ye;Ce<=be;Ce++)for(let Te=et;Te<=vt;Te++){const Me=S.board[Ce][Te].card;if(Me&&!((Kt=Me.statuses)!=null&&Kt.some(ct=>ct.type==="Stun"))){const ct=Me.ownerId===j,Ct=(F=Me.statuses)==null?void 0:F.some(ft=>ft.type==="Exploit"&&ft.addedByPlayerId===j);if(ct||B&&Ct&&Me.ownerId!==j){const ft=Math.max(0,Me.power+(Me.powerModifier||0)+(Me.bonusPower||0));ft>0&&(xt+=ft,Qe.push({row:Ce,col:Te,text:`+${ft}`,playerId:j}))}}}Qe.length>0&&it(Qe),I(Ce=>{const Te=JSON.parse(JSON.stringify(Ce)),Ue=Te.players.find(Me=>Me.id===j);return Ue&&(Ue.score+=xt),Te})},[I,it]),dn=p.useCallback((y,w,E,R,j,S)=>{var Qe,Kt;const B=O.current;if(!B.isGameStarted)return;const P=E>y?1:-1,ye=R>w?1:-1,be=Math.abs(y-E);let et=0,vt=0;const xt=[];for(let F=0;F<=be;F++){const Ce=y+F*P,Te=w+F*ye;if(Ce<0||Ce>=B.board.length||Te<0||Te>=B.board.length)continue;const Me=B.board[Ce][Te].card;if(Me&&!((Qe=Me.statuses)!=null&&Qe.some(ct=>ct.type==="Stun"))&&Me.ownerId===j){const Ct=Math.max(0,Me.power+(Me.powerModifier||0)+(Me.bonusPower||0));Ct>0&&(et+=Ct,xt.push({row:Ce,col:Te,text:`+${Ct}`,playerId:j})),S&&((Kt=Me.statuses)!=null&&Kt.some(ft=>ft.type==="Support"&&ft.addedByPlayerId===j))&&(vt+=1)}}S==="point_per_support"&&vt>0&&(et+=vt),xt.length>0&&it(xt),I(F=>{const Ce=JSON.parse(JSON.stringify(F)),Te=Ce.players.find(Ue=>Ue.id===j);if(Te&&(Te.score+=et,S==="draw_per_support"&&vt>0&&Te.deck.length>0))for(let Ue=0;Ue<vt;Ue++)Te.deck.length>0&&Te.hand.push(Te.deck.shift());return Ce})},[I,it]);return{gameState:r,localPlayerId:a,setLocalPlayerId:s,draggedItem:l,setDraggedItem:c,connectionStatus:d,gamesList:k,latestHighlight:b,latestFloatingTexts:A,latestNoTarget:u,createGame:ae,joinGame:we,requestGamesList:De,exitGame:me,startReadyCheck:ve,cancelReadyCheck:Pe,playerReady:J,assignTeams:z,setGameMode:K,setGamePrivacy:ne,setActiveGridSize:Ne,setDummyPlayerCount:v,updatePlayerName:G,changePlayerColor:le,updatePlayerScore:je,changePlayerDeck:Ee,loadCustomDeck:ie,drawCard:ke,shufflePlayerDeck:Oe,moveItem:kn,handleDrop:kn,addBoardCardStatus:L,removeBoardCardStatus:$,removeBoardCardStatusByOwner:ee,modifyBoardCardPower:oe,addAnnouncedCardStatus:Ie,removeAnnouncedCardStatus:_e,modifyAnnouncedCardPower:Y,addHandCardStatus:Ae,removeHandCardStatus:xe,flipBoardCard:re,flipBoardCardFaceDown:Re,revealHandCard:Se,revealBoardCard:de,requestCardReveal:q,respondToRevealRequest:H,syncGame:W,removeRevealedStatus:Z,resetGame:he,toggleActivePlayer:We,toggleAutoDraw:qe,forceReconnect:ce,triggerHighlight:ht,triggerFloatingText:it,triggerNoTarget:Vr,nextPhase:St,prevPhase:bt,setPhase:$e,markAbilityUsed:Hr,applyGlobalEffect:Ve,swapCards:Zn,transferStatus:Ra,transferAllCounters:Er,recoverDiscardedCard:Ge,resurrectDiscardedCard:Ut,spawnToken:Dn,scoreLine:Wr,confirmRoundEnd:Ot,resetDeployStatus:$r,scoreDiagonal:dn,removeStatusByType:Tr,reorderTopDeck:Ft,reorderCards:_o,updateState:I}},Ec=-1,bv=-2,Yo=1,ei=2,Sa=(e,t,n,r)=>{var l,c,d,h,k;const{card:o,ownerId:a,location:s}=e;if(t.targetOwnerId!==void 0&&t.targetOwnerId!==Ec&&t.targetOwnerId!==bv&&t.targetOwnerId!==a||t.excludeOwnerId!==void 0&&t.excludeOwnerId===a)return!1;if(t.onlyOpponents||t.targetOwnerId===Ec){if(a===n)return!1;const g=r.find(x=>x.id===n),b=r.find(x=>x.id===a);if(g&&b&&g.teamId!==void 0&&g.teamId===b.teamId)return!1}if(t.targetType&&!((l=o.types)!=null&&l.includes(t.targetType))||t.onlyFaceDown&&((c=o.statuses)!=null&&c.some(g=>g.type==="Revealed"&&g.addedByPlayerId===n)||s==="board"&&!o.isFaceDown)||t.tokenType==="Revealed"&&(d=o.statuses)!=null&&d.some(g=>g.type==="Revealed"&&g.addedByPlayerId===n)||t.requiredTargetStatus&&(!((h=o.statuses)!=null&&h.some(g=>g.type===t.requiredTargetStatus))||t.requireStatusFromSourceOwner&&n!==null&&!((k=o.statuses)==null?void 0:k.some(b=>b.type===t.requiredTargetStatus&&b.addedByPlayerId===n))))return!1;if(t.mustBeAdjacentToSource&&t.sourceCoords&&e.boardCoords){const{row:g,col:b}=t.sourceCoords,{row:x,col:A}=e.boardCoords;if(Math.abs(g-x)+Math.abs(b-A)!==Yo)return!1}if(t.mustBeInLineWithSource&&t.sourceCoords&&e.boardCoords){const{row:g,col:b}=t.sourceCoords,{row:x,col:A}=e.boardCoords;if(g!==x&&b!==A)return!1}return!0},Vl=(e,t,n,r)=>{if(!e||e.type!=="ENTER_MODE"&&e.type!=="CREATE_STACK")return[];const o=[],a=t.board,s=a.length,l=t.activeGridSize,c=Math.floor((s-l)/2),d=c,h=c+l-1,k=(T,u)=>T>=d&&T<=h&&u>=d&&u<=h;if(e.type==="CREATE_STACK"){const T={targetOwnerId:e.targetOwnerId,excludeOwnerId:e.excludeOwnerId,onlyOpponents:e.onlyOpponents,onlyFaceDown:e.onlyFaceDown,targetType:e.targetType,requiredTargetStatus:e.requiredTargetStatus,requireStatusFromSourceOwner:e.requireStatusFromSourceOwner,mustBeAdjacentToSource:e.mustBeAdjacentToSource,mustBeInLineWithSource:e.mustBeInLineWithSource,sourceCoords:e.sourceCoords,tokenType:e.tokenType};for(let u=0;u<s;u++)for(let m=0;m<s;m++){if(!k(u,m))continue;const f=a[u][m];f.card&&f.card.ownerId!==void 0&&Sa({card:f.card,ownerId:f.card.ownerId,location:"board",boardCoords:{row:u,col:m}},T,n,t.players)&&o.push({row:u,col:m})}return o}const{mode:g,payload:b,sourceCoords:x,contextCheck:A}=e;if((g==="SELECT_TARGET"||g==="CENSOR_SWAP"||g==="ZEALOUS_WEAKEN"||g==="CENTURION_BUFF"||g==="SELECT_UNIT_FOR_MOVE")&&b.filter&&typeof b.filter=="function"){if(b.actionType==="SELECT_HAND_FOR_DISCARD_THEN_SPAWN"||b.actionType==="LUCIUS_SETUP"||b.actionType==="SELECT_HAND_FOR_DEPLOY")return[];for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=a[T][u];let f=m.card&&b.filter(m.card,T,u);if(f&&A==="ADJACENT_TO_LAST_MOVE"&&(r!=null&&r.lastMovedCardCoords)){const{row:D,col:N}=r.lastMovedCardCoords;Math.abs(T-D)+Math.abs(u-N)===1||(f=!1)}f&&o.push({row:T,col:u})}}else if(g==="SELECT_TARGET"&&(b.actionType==="ENHANCED_INT_REVEAL"||b.actionType==="ENHANCED_INT_MOVE"))for(let T=0;T<s;T++)for(let u=0;u<s;u++)a[T][u].card&&o.push({row:T,col:u});else if(g==="PATROL_MOVE"&&x)for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=T===x.row||u===x.col,f=T===x.row&&u===x.col,D=!a[T][u].card;m&&(D||f)&&o.push({row:T,col:u})}else if(g==="RIOT_PUSH"&&x)[{r:x.row-1,c:x.col},{r:x.row+1,c:x.col},{r:x.row,c:x.col-1},{r:x.row,c:x.col+1}].forEach(u=>{if(k(u.r,u.c)){const m=a[u.r][u.c].card;if(m&&m.ownerId!==n){const f=t.players.find(_=>_.id===n),D=t.players.find(_=>_.id===m.ownerId);if(!((f==null?void 0:f.teamId)!==void 0&&(D==null?void 0:D.teamId)!==void 0&&f.teamId===D.teamId)){const _=u.r-x.row,O=u.c-x.col,M=u.r+_,I=u.c+O;k(M,I)&&(a[M][I].card||o.push({row:u.r,col:u.c}))}}}});else if(g==="RIOT_MOVE"&&b.vacatedCoords)o.push(b.vacatedCoords),x&&o.push(x);else if(g==="SWAP_POSITIONS"&&b.filter)for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=a[T][u];m.card&&b.filter(m.card,T,u)&&o.push({row:T,col:u})}else if((g==="TRANSFER_STATUS_SELECT"||g==="TRANSFER_ALL_STATUSES")&&b.filter)for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=a[T][u];m.card&&b.filter(m.card,T,u)&&o.push({row:T,col:u})}else if(g==="SPAWN_TOKEN"||g==="SELECT_CELL"||g==="IMMUNIS_RETRIEVE")for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=!a[T][u].card;if(g==="IMMUNIS_RETRIEVE"&&b.filter){m&&b.filter(T,u)&&o.push({row:T,col:u});continue}if(g==="SELECT_CELL"){if(b.moveFromHand){m&&o.push({row:T,col:u});continue}if(!x)continue;const f=T===x.row&&u===x.col,D=b.range==="global";let N=!1;if(D)N=!0;else if(b.range==="line")N=T===x.row||u===x.col;else if(b.range===ei){const _=Math.abs(T-x.row),O=Math.abs(u-x.col),M=_+O;if(M===Yo)N=!0;else if(M===ei){const I=[];_===ei&&O===0?I.push({r:(T+x.row)/2,c:u}):_===0&&O===ei?I.push({r:T,c:(u+x.col)/2}):_===Yo&&O===Yo&&(I.push({r:T,c:x.col}),I.push({r:x.row,c:u})),N=I.some(V=>V.r<0||V.r>=s||V.c<0||V.c>=s?!1:!a[V.r][V.c].card)}}else N=Math.abs(T-x.row)+Math.abs(u-x.col)===Yo;(m&&N||b.allowSelf&&f)&&o.push({row:T,col:u})}else if(g==="SPAWN_TOKEN"&&x){const f=Math.abs(T-x.row)+Math.abs(u-x.col)===1;m&&f&&o.push({row:T,col:u})}}else if(g==="REVEAL_ENEMY"&&b.filter)for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=a[T][u];m.card&&b.filter(m.card,T,u)&&o.push({row:T,col:u})}else if(g==="SELECT_LINE_START")for(let T=0;T<s;T++)for(let u=0;u<s;u++)o.push({row:T,col:u});else if(g==="SELECT_LINE_END"&&b.firstCoords)for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=T===b.firstCoords.row,f=u===b.firstCoords.col;(m||f)&&o.push({row:T,col:u})}else if(g==="INTEGRATOR_LINE_SELECT"&&x)for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=T===x.row,f=u===x.col;(m||f)&&o.push({row:T,col:u})}else if(g==="ZIUS_LINE_SELECT"&&x)for(let T=0;T<s;T++)for(let u=0;u<s;u++){const m=T===x.row,f=u===x.col;(m||f)&&o.push({row:T,col:u})}else if(g==="SELECT_DIAGONAL")if(b.firstCoords){const{row:T,col:u}=b.firstCoords;for(let m=0;m<s;m++)for(let f=0;f<s;f++)Math.abs(m-T)===Math.abs(f-u)&&o.push({row:m,col:f})}else for(let T=0;T<s;T++)for(let u=0;u<s;u++)o.push({row:T,col:u});return o},Hl=(e,t,n,r)=>{var a,s,l,c,d;if(e.type==="OPEN_MODAL"||e.mode==="SELECT_DECK"||e.mode==="PRINCEPS_SHIELD_THEN_AIM"||e.mode==="SHIELD_SELF_THEN_SPAWN"||e.mode==="SHIELD_SELF_THEN_RIOT_PUSH"||e.mode==="ABR_DEPLOY_SHIELD_AIM")return!0;if(e.mode==="SELECT_TARGET"&&((a=e.payload)!=null&&a.actionType)){const h=e.payload.actionType;if(h==="SELECT_HAND_FOR_DISCARD_THEN_SPAWN"||h==="LUCIUS_SETUP"||h==="SELECT_HAND_FOR_DEPLOY"){const k=((s=e.sourceCard)==null?void 0:s.ownerId)||n;if(k!==null){const g=t.players.find(b=>b.id===k);if(g&&g.hand.length>0)return!0}return!1}}if(e.type==="CREATE_STACK"){if(Vl(e,t,n,r).length>0)return!0;if(e.tokenType==="Revealed"||(l=e.tokenType)!=null&&l.startsWith("Power"))for(const k of t.players)for(let g=0;g<k.hand.length;g++){const b={targetOwnerId:e.targetOwnerId,excludeOwnerId:e.excludeOwnerId,onlyOpponents:e.onlyOpponents,onlyFaceDown:e.onlyFaceDown,targetType:e.targetType,tokenType:e.tokenType};if(Sa({card:k.hand[g],ownerId:k.id,location:"hand"},b,n,t.players))return!0}return!1}if(Vl(e,t,n,r).length>0)return!0;if(e.mode==="SELECT_TARGET"&&((c=e.payload)!=null&&c.filter)&&(e.payload.allowHandTargets||e.payload.actionType==="DESTROY")){for(const h of t.players)if(h.hand.some(k=>e.payload.filter(k)))return!0}return(e.mode==="CENSOR_SWAP"||e.mode==="ZEALOUS_WEAKEN"||e.mode==="CENTURION_BUFF"||e.mode==="SELECT_UNIT_FOR_MOVE")&&((d=e.payload)!=null&&d.filter),!1},Cv=({gameState:e,localPlayerId:t,abilityMode:n,setAbilityMode:r,cursorStack:o,setCursorStack:a,commandContext:s,setCommandContext:l,setViewingDiscard:c,triggerNoTarget:d,setPlayMode:h,setCounterSelectionData:k,interactionLock:g,onAbilityComplete:b,moveItem:x,drawCard:A,updatePlayerScore:T,markAbilityUsed:u,applyGlobalEffect:m,swapCards:f,transferStatus:D,transferAllCounters:N,resurrectDiscardedCard:_,spawnToken:O,scoreLine:M,nextPhase:I,modifyBoardCardPower:V,addBoardCardStatus:ce,removeBoardCardStatus:we,removeBoardCardStatusByOwner:ae,resetDeployStatus:De,scoreDiagonal:me,removeStatusByType:ve,triggerFloatingText:Pe})=>{const J=p.useCallback((v,L)=>{var ee,oe,Ie,_e,Y,Ae,xe,re,Re;if(v.type==="ABILITY_COMPLETE"){b==null||b();return}if(v.type==="GLOBAL_AUTO_APPLY"){if(((ee=v.payload)==null?void 0:ee.customAction)==="FINN_SCORING"){let Se=0;const de=(oe=v.sourceCard)==null?void 0:oe.ownerId;if(de===void 0){console.warn("[FINN_SCORING] Source card missing ownerId, skipping scoring"),u(v.sourceCoords||L,!!v.isDeployAbility);return}if(e.players.forEach(q=>{q.id!==de&&q.hand.forEach(H=>{var Z;(Z=H.statuses)!=null&&Z.some(G=>G.type==="Revealed"&&G.addedByPlayerId===de)&&Se++})}),e.board.forEach(q=>{q.forEach(H=>{var G;const Z=H.card;if(Z&&Z.ownerId!==de){const le=((G=Z.statuses)==null?void 0:G.filter(je=>je.type==="Revealed"&&je.addedByPlayerId===de).length)||0;Se+=le}})}),Se>0){const q=v.sourceCoords||L;Pe({row:q.row,col:q.col,text:`+${Se}`,playerId:de}),T(de,Se)}u(v.sourceCoords||L,!!v.isDeployAbility);return}if(((Ie=v.payload)==null?void 0:Ie.customAction)==="REMOVE_ALL_AIM_FROM_CONTEXT"){v.sourceCoords&&v.sourceCoords.row>=0?ve(v.sourceCoords,"Aim"):s.lastMovedCardCoords?ve(s.lastMovedCardCoords,"Aim"):L&&L.row>=0&&ve(L,"Aim");return}if(v.payload&&!v.payload.cleanupCommand){const{tokenType:Se,filter:de}=v.payload,q=[],H=e.board.length;if(v.payload.contextReward&&v.sourceCard){let Z=0;const G=L&&L.row>=0?L:s.lastMovedCardCoords;if(G){const{row:le,col:je}=G;let Ee=e.board[le][je].card;const ie=v.payload._tempContextId||s.lastMovedCardId;if((!Ee||ie&&Ee.id!==ie)&&ie)for(let ke=0;ke<H;ke++){for(let Oe=0;Oe<H;Oe++)if(((_e=e.board[ke][Oe].card)==null?void 0:_e.id)===ie){Ee=e.board[ke][Oe].card;break}if(Ee)break}Ee&&(Z=Math.max(0,Ee.power+(Ee.powerModifier||0)+(Ee.bonusPower||0)))}if(Z>0){const le=v.sourceCard.ownerId;if(le===void 0){console.error("Cannot apply reward: sourceCard has no ownerId");return}const je=v.payload.contextReward;if(je==="DRAW_MOVED_POWER"||je==="DRAW_EQUAL_POWER")for(let Ee=0;Ee<Z;Ee++)A(le);else je==="SCORE_MOVED_POWER"&&(Pe({row:L.row,col:L.col,text:`+${Z}`,playerId:le}),T(le,Z))}if(v.payload.contextReward==="STUN_MOVED_UNIT"&&G){const le=v.sourceCard.ownerId;le!==void 0?ce(G,"Stun",le):console.error("Cannot apply stun: sourceCard has no ownerId")}return}if(de)for(let Z=0;Z<H;Z++)for(let G=0;G<H;G++){const le=e.board[Z][G].card;le&&de(le)&&q.push({row:Z,col:G})}else v.sourceCoords&&v.sourceCoords.row>=0?q.push(v.sourceCoords):L&&L.row>=0?q.push(L):s.lastMovedCardCoords&&q.push(s.lastMovedCardCoords);if(q.length>0){if(Se){const Z=v.payload.count||1,G=v.payload.ownerId!==void 0?v.payload.ownerId:((Y=v.sourceCard)==null?void 0:Y.ownerId)??t;for(let le=0;le<Z;le++)m(L,q,Se,G,!!v.isDeployAbility)}}else d(L),u(L,!!v.isDeployAbility);return}}if(!Hl(v,e,((Ae=v.sourceCard)==null?void 0:Ae.ownerId)||t,s)){d(L),v.chainedAction&&setTimeout(()=>{J(v.chainedAction,L)},500);return}if(v.type==="CREATE_STACK"&&v.tokenType){let Se=v.count||0;if(v.dynamicCount){const{factor:de,ownerId:q}=v.dynamicCount;let H=0;e.board.forEach(Z=>Z.forEach(G=>{var le;if((le=G.card)!=null&&le.statuses){const je=G.card.statuses.filter(Ee=>Ee.type===de&&Ee.addedByPlayerId===q);H+=je.length}})),Se=H}Se>0?a({type:v.tokenType,count:Se,isDragging:!1,sourceCoords:L,excludeOwnerId:v.excludeOwnerId,onlyOpponents:v.onlyOpponents,onlyFaceDown:v.onlyFaceDown,targetType:v.targetType,isDeployAbility:v.isDeployAbility,requiredTargetStatus:v.requiredTargetStatus,requireStatusFromSourceOwner:v.requireStatusFromSourceOwner,mustBeAdjacentToSource:v.mustBeAdjacentToSource,mustBeInLineWithSource:v.mustBeInLineWithSource,placeAllAtOnce:v.placeAllAtOnce,chainedAction:v.chainedAction,targetOwnerId:v.targetOwnerId,recordContext:v.recordContext}):d(L)}else if(v.type==="ENTER_MODE"){if(v.mode==="SHIELD_SELF_THEN_SPAWN"){ce(L,"Shield",v.sourceCard.ownerId),r({type:"ENTER_MODE",mode:"SPAWN_TOKEN",sourceCard:v.sourceCard,sourceCoords:L,isDeployAbility:v.isDeployAbility,payload:v.payload});return}if(v.mode==="SHIELD_SELF_THEN_RIOT_PUSH"){const q=v.sourceCard.ownerId;ce(L,"Shield",q);const H=e.board.length,Z=Math.floor((H-e.activeGridSize)/2),G=Z,le=Z+e.activeGridSize-1;let je=!1;const{row:Ee,col:ie}=L,ke=[[-1,0],[1,0],[0,-1],[0,1]];for(const[Oe,We]of ke){const qe=Ee+Oe,$e=ie+We;if(qe<G||qe>le||$e<G||$e>le)continue;const St=e.board[qe][$e];if(!St.card)continue;const bt=e.players.find(ht=>ht.id===St.card.ownerId),Ot=e.players.find(ht=>ht.id===q),kn=(bt==null?void 0:bt.teamId)!==void 0&&(Ot==null?void 0:Ot.teamId)!==void 0&&bt.teamId===Ot.teamId;if(St.card.ownerId===q||kn)continue;const Ut=qe+Oe,Ft=$e+We;if(Ut<G||Ut>le||Ft<G||Ft>le)continue;if(e.board[Ut][Ft].card===null){je=!0;break}}je?r({type:"ENTER_MODE",mode:"RIOT_PUSH",sourceCard:v.sourceCard,sourceCoords:L,isDeployAbility:v.isDeployAbility,payload:v.payload}):d(L);return}if(v.mode==="PRINCEPS_SHIELD_THEN_AIM"){ce(L,"Shield",v.sourceCard.ownerId),a({type:"Aim",count:1,isDragging:!1,sourceCoords:L,mustBeInLineWithSource:!0,isDeployAbility:v.isDeployAbility});return}if(v.mode==="ABR_DEPLOY_SHIELD_AIM"){const q=v.sourceCard.ownerId;ce(L,"Shield",q);const H={type:"CREATE_STACK",tokenType:"Aim",requiredTargetStatus:"Threat",requireStatusFromSourceOwner:!0,sourceCard:v.sourceCard,sourceCoords:L,isDeployAbility:v.isDeployAbility};Hl(H,e,q,s)?a({type:"Aim",count:1,isDragging:!1,sourceCoords:L,requiredTargetStatus:"Threat",requireStatusFromSourceOwner:!0,isDeployAbility:v.isDeployAbility}):d(L);return}if(v.mode==="RIOT_PUSH"&&v.sourceCoords){const q=e.board.length,H=Math.floor((q-e.activeGridSize)/2),Z=H,G=H+e.activeGridSize-1;let le=!1;const{row:je,col:Ee}=v.sourceCoords,ie=(xe=v.sourceCard)==null?void 0:xe.ownerId,ke=[[-1,0],[1,0],[0,-1],[0,1]];for(const[Oe,We]of ke){const qe=je+Oe,$e=Ee+We;if(qe<Z||qe>G||$e<Z||$e>G)continue;const St=e.board[qe][$e];if(!St.card||ie===void 0)continue;const bt=e.players.find(ht=>ht.id===St.card.ownerId),Ot=e.players.find(ht=>ht.id===ie),kn=(bt==null?void 0:bt.teamId)!==void 0&&(Ot==null?void 0:Ot.teamId)!==void 0&&bt.teamId===Ot.teamId;if(St.card.ownerId===ie||kn)continue;const Ut=qe+Oe,Ft=$e+We;if(Ut<Z||Ut>G||Ft<Z||Ft>G)continue;if(e.board[Ut][Ft].card===null){le=!0;break}}if(!le){d(v.sourceCoords);return}}if(v.mode==="SELECT_TARGET"&&((re=v.payload)==null?void 0:re.actionType)==="SELECT_HAND_FOR_DISCARD_THEN_SPAWN"&&v.sourceCard){const q=v.sourceCard.ownerId,H=e.players.find(Z=>Z.id===q);if(H&&H.hand.length<1){d(v.sourceCoords||L);return}}if(v.mode==="SELECT_TARGET"&&((Re=v.payload)==null?void 0:Re.actionType)==="LUCIUS_SETUP"&&v.sourceCard){const q=v.sourceCard.ownerId,H=e.players.find(Z=>Z.id===q);if(H&&H.hand.length<1){d(v.sourceCoords||L);return}}let Se=v.sourceCard,de=L;if(v.sourceCoords&&v.sourceCoords.row>=0&&(de=v.sourceCoords),v.mode==="SELECT_CELL"&&s.lastMovedCardCoords&&s.lastMovedCardId){const{row:q,col:H}=s.lastMovedCardCoords,Z=e.board[q][H].card;Z&&(Se=Z,de=s.lastMovedCardCoords)}r({...v,sourceCard:Se,sourceCoords:de})}else if(v.type==="OPEN_MODAL")if(v.mode==="RETRIEVE_DEVICE"){const Se=e.players.find(de=>{var q;return de.id===((q=v.sourceCard)==null?void 0:q.ownerId)});Se&&(c({player:Se,pickConfig:{filterType:"Device",action:"recover"}}),L.row>=0&&u(L,!!v.isDeployAbility))}else if(v.mode==="IMMUNIS_RETRIEVE"){const Se=e.players.find(de=>{var q;return de.id===((q=v.sourceCard)==null?void 0:q.ownerId)});Se&&(c({player:Se,pickConfig:{filterType:"Optimates",action:"resurrect"}}),r({type:"ENTER_MODE",mode:"IMMUNIS_RETRIEVE",sourceCard:v.sourceCard,sourceCoords:L,isDeployAbility:v.isDeployAbility,payload:v.payload}))}else if(v.mode==="SEARCH_DECK"){const Se=e.players.find(de=>{var q;return de.id===((q=v.sourceCard)==null?void 0:q.ownerId)});Se&&(c({player:Se,pickConfig:{filterType:v.payload.filterType||"Unit",action:"recover",isDeck:!0}}),L.row>=0&&u(L,!!v.isDeployAbility))}else v.mode==="ZIUS_LINE_SELECT"?s.lastMovedCardCoords?r({type:"ENTER_MODE",mode:"ZIUS_LINE_SELECT",sourceCard:v.sourceCard,sourceCoords:s.lastMovedCardCoords,isDeployAbility:v.isDeployAbility,payload:v.payload}):r({type:"ENTER_MODE",mode:"ZIUS_LINE_SELECT",sourceCard:v.sourceCard,sourceCoords:L,isDeployAbility:v.isDeployAbility,payload:v.payload}):v.mode==="SELECT_DECK"&&r({type:"ENTER_MODE",mode:"SELECT_DECK",sourceCard:v.sourceCard,sourceCoords:L,isDeployAbility:v.isDeployAbility,payload:v.payload})},[e,t,s,u,r,a,d,m,c,ce,T,A,ve,b,Pe]);p.useEffect(()=>{(n==null?void 0:n.type)==="GLOBAL_AUTO_APPLY"&&(J(n,n.sourceCoords||{row:-1,col:-1}),r(null))},[n,J,r]);const z=p.useCallback((v,L)=>{if(n||o||!e.isGameStarted||t===null)return;const $=e.players.find(Ie=>Ie.id===v.ownerId),ee=t===v.ownerId||($==null?void 0:$.isDummy)&&t===1;if(e.activePlayerId!==v.ownerId||!ee||!Zp(v,e)||!Bl(v,e.currentPhase,e.activePlayerId,e))return;const oe=Lg(v,e,v.ownerId,L);if(oe){oe.readyStatusToRemove&&u(L,!!oe.isDeployAbility,!1,oe.readyStatusToRemove);const Ie={...oe,chainedAction:oe.chainedAction?{...oe.chainedAction,chainedAction:{type:"ABILITY_COMPLETE"}}:{type:"ABILITY_COMPLETE"}};J(Ie,L)}},[n,o,e,t,J,u]),K=p.useCallback(v=>{var _e,Y,Ae;if(!n)return;const{mode:L,sourceCard:$,sourceCoords:ee,payload:oe,isDeployAbility:Ie}=n;if(L==="SCORE_LAST_PLAYED_LINE"&&n.sourceCoords){const{row:xe,col:re}=n.sourceCoords,{row:Re,col:Se}=v;if(xe!==Re&&re!==Se)return;M(xe,re,Re,Se,e.activePlayerId),I(),r(null);return}if(L==="SELECT_LINE_START"){r({type:"ENTER_MODE",mode:"SELECT_LINE_END",sourceCard:$,sourceCoords:ee,isDeployAbility:Ie,payload:{...oe,firstCoords:v}});return}if(L==="SELECT_LINE_END"&&(oe!=null&&oe.firstCoords)){const{row:xe,col:re}=oe.firstCoords,{row:Re,col:Se}=v;if(xe!==Re&&re!==Se)return;const de=oe.actionType,q=($==null?void 0:$.ownerId)??((_e=e.players.find(H=>H.id===e.activePlayerId))!=null&&_e.isDummy?e.activePlayerId:t||e.activePlayerId);if(de==="ZIUS_SCORING"){const H=s.lastMovedCardCoords;if(H){const ke=xe===Re&&H.row===xe,Oe=re===Se&&H.col===re;if(!ke&&!Oe)return}const Z=e.board.length;let G=0,le=Z-1,je=0,Ee=Z-1;if(xe===Re)G=le=xe;else if(re===Se)je=Ee=re;else return;let ie=0;for(let ke=G;ke<=le;ke++)for(let Oe=je;Oe<=Ee;Oe++){const We=e.board[ke][Oe];We.card&&(ie+=((Y=We.card.statuses)==null?void 0:Y.filter(qe=>qe.type==="Exploit"&&qe.addedByPlayerId===q).length)||0)}ie>0&&q&&(ee&&Pe({row:ee.row,col:ee.col,text:`+${ie}`,playerId:q}),T(q,ie)),ee&&ee.row>=0&&u(ee,Ie)}else if(de==="CENTURION_BUFF"&&$&&ee&&q){const H=e.board.length;let Z=0,G=H-1,le=0,je=H-1;xe===Re?Z=G=xe:le=je=re;for(let Ee=Z;Ee<=G;Ee++)for(let ie=le;ie<=je;ie++){const ke=e.board[Ee][ie].card;if(ke){const Oe=ke.id===$.id,We=ke.ownerId===q,qe=e.players.find(bt=>bt.id===q),$e=e.players.find(bt=>bt.id===ke.ownerId),St=(qe==null?void 0:qe.teamId)!==void 0&&($e==null?void 0:$e.teamId)!==void 0&&qe.teamId===$e.teamId;!Oe&&(We||St)&&V({row:Ee,col:ie},1)}}u(ee,Ie)}else(de==="SCORE_LINE"||!de)&&(M(xe,re,Re,Se,q),e.isScoringStep&&I());setTimeout(()=>r(null),100)}if(L==="SELECT_DIAGONAL"&&oe.actionType==="SCORE_DIAGONAL"){const xe=($==null?void 0:$.ownerId)??((Ae=e.players.find(re=>re.id===e.activePlayerId))!=null&&Ae.isDummy?e.activePlayerId:t||e.activePlayerId);if(oe.firstCoords){const{row:re,col:Re}=oe.firstCoords,{row:Se,col:de}=v;if(Math.abs(re-Se)!==Math.abs(Re-de)){r(null);return}me(re,Re,Se,de,xe,oe.bonusType),setTimeout(()=>r(null),100)}else{r({...n,payload:{...oe,firstCoords:v}});return}}},[n,e,t,M,I,r,V,u,me,T,Pe,s]),ne=p.useCallback((v,L)=>{var $,ee,oe,Ie,_e,Y,Ae,xe,re,Re,Se,de;if(!(h!=null&&o)&&!g.current){if(n&&(n.mode==="SCORE_LAST_PLAYED_LINE"||n.mode==="SELECT_LINE_END"||n.mode==="SELECT_DIAGONAL")){K(L);return}if((n==null?void 0:n.type)==="ENTER_MODE"){if(n.sourceCard&&n.sourceCard.id===v.id&&n.mode!=="SELECT_LINE_START"&&n.mode!=="INTEGRATOR_LINE_SELECT"&&n.mode!=="ZIUS_LINE_SELECT"&&n.mode!=="SELECT_UNIT_FOR_MOVE"&&n.mode!=="SELECT_TARGET"&&n.mode!=="RIOT_PUSH"&&n.mode!=="RIOT_MOVE")return;const{mode:q,payload:H,sourceCard:Z,sourceCoords:G,isDeployAbility:le}=n;if(q==="SELECT_LINE_START"||q==="SELECT_LINE_END"){K(L);return}const je=(Z==null?void 0:Z.ownerId)??(($=e.players.find(Ee=>Ee.id===e.activePlayerId))!=null&&$.isDummy?e.activePlayerId:t||e.activePlayerId);if(q==="SELECT_TARGET"&&H.tokenType){if(H.filter&&!H.filter(v,L.row,L.col))return;if(x({card:{id:"dummy",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:H.tokenType,count:H.count||1},{target:"board",boardCoords:L}),n.recordContext&&l({lastMovedCardCoords:L,lastMovedCardId:v.id}),H.chainedAction){const Ee={...H.chainedAction,sourceCard:v,sourceCoords:L,isDeployAbility:le,recordContext:!0};J(Ee,L),Ee.type!=="ENTER_MODE"&&r(null)}else G&&G.row>=0&&u(G,le),setTimeout(()=>r(null),100);return}if(q==="SELECT_TARGET"&&H.actionType==="OPEN_COUNTER_MODAL"){if(H.filter&&!H.filter(v))return;k({card:v,callbackAction:H.rewardType}),r(null);return}if(q==="SELECT_TARGET"&&H.actionType==="SACRIFICE_AND_BUFF_LINES"){if(H.filter&&!H.filter(v,L.row,L.col))return;x({card:v,source:"board",boardCoords:L,bypassOwnershipCheck:!0},{target:"discard",playerId:v.ownerId});const Ee=e.board.length,{row:ie,col:ke}=L;for(let Oe=0;Oe<Ee;Oe++){if(Oe===ke)continue;const qe=e.board[ie][Oe].card;qe&&(qe.ownerId===je||((ee=e.players.find($e=>$e.id===je))==null?void 0:ee.teamId)!==void 0&&((oe=e.players.find($e=>$e.id===qe.ownerId))==null?void 0:oe.teamId)===((Ie=e.players.find($e=>$e.id===je))==null?void 0:Ie.teamId))&&V({row:ie,col:Oe},1)}for(let Oe=0;Oe<Ee;Oe++){if(Oe===ie)continue;const qe=e.board[Oe][ke].card;qe&&(qe.ownerId===je||((_e=e.players.find($e=>$e.id===je))==null?void 0:_e.teamId)!==void 0&&((Y=e.players.find($e=>$e.id===qe.ownerId))==null?void 0:Y.teamId)===((Ae=e.players.find($e=>$e.id===je))==null?void 0:Ae.teamId))&&V({row:Oe,col:ke},1)}G&&G.row>=0&&u(G,le),setTimeout(()=>r(null),100);return}if(q==="SELECT_TARGET"&&H.actionType==="DESTROY"){if(H.filter&&!H.filter(v,L.row,L.col))return;if(((xe=v.statuses)==null?void 0:xe.some(ie=>ie.type==="Shield"))?we(L,"Shield"):x({card:v,source:"board",boardCoords:L,bypassOwnershipCheck:!0},{target:"discard",playerId:v.ownerId}),H.chainedAction){const ie={...H.chainedAction,sourceCard:Z,sourceCoords:G,isDeployAbility:le};J(ie,G),ie.type!=="ENTER_MODE"&&r(null)}else G&&G.row>=0&&u(G,le),setTimeout(()=>r(null),100);return}if(q==="SELECT_TARGET"&&H.actionType==="DRAW_EQUAL_POWER"){if(H.filter&&!H.filter(v))return;const Ee=Math.max(0,v.power+(v.powerModifier||0));for(let ie=0;ie<Ee;ie++)A(je);setTimeout(()=>r(null),100);return}if(q==="SELECT_TARGET"&&H.actionType==="SCORE_EQUAL_POWER"){if(H.filter&&!H.filter(v))return;const Ee=Math.max(0,v.power+(v.powerModifier||0));G&&Pe({row:G.row,col:G.col,text:`+${Ee}`,playerId:je}),T(je,Ee),setTimeout(()=>r(null),100);return}if(q==="SELECT_TARGET"&&H.actionType==="RESET_DEPLOY"){if(H.filter&&!H.filter(v))return;De(L),setTimeout(()=>r(null),100);return}if(q==="SELECT_TARGET"&&H.actionType==="SHIELD_AND_REMOVE_AIM"){if(H.filter&&!H.filter(v))return;ce(L,"Shield",je),ve(L,"Aim"),setTimeout(()=>r(null),100);return}if(q==="SELECT_TARGET"&&H.actionType==="MODIFY_POWER"){if(H.filter&&!H.filter(v))return;H.amount&&V(L,H.amount),G&&G.row>=0&&u(G,le),setTimeout(()=>r(null),100);return}if(q==="RIOT_PUSH"&&G&&G.row>=0){if(L.row===G.row&&L.col===G.col){u(G,le),setTimeout(()=>r(null),100);return}const Ee=Math.abs(L.row-G.row)+Math.abs(L.col-G.col)===1,ie=e.players.find(Ft=>Ft.id===v.ownerId),ke=e.players.find(Ft=>Ft.id===je),Oe=(ie==null?void 0:ie.teamId)!==void 0&&(ke==null?void 0:ke.teamId)!==void 0&&ie.teamId===ke.teamId;if(!Ee||v.ownerId===je||Oe)return;const We=L.row-G.row,qe=L.col-G.col,$e=L.row+We,St=L.col+qe,bt=e.board.length,Ot=Math.floor((bt-e.activeGridSize)/2),kn=Ot,Ut=Ot+e.activeGridSize-1;if($e<kn||$e>Ut||St<kn||St>Ut||e.board[$e][St].card!==null)return;x({card:v,source:"board",boardCoords:L,bypassOwnershipCheck:!0},{target:"board",boardCoords:{row:$e,col:St}}),r({type:"ENTER_MODE",mode:"RIOT_MOVE",sourceCard:n.sourceCard,sourceCoords:n.sourceCoords,isDeployAbility:le,payload:{vacatedCoords:L}});return}if(q==="RIOT_MOVE"&&G&&G.row>=0){L.row===G.row&&L.col===G.col&&(u(G,le),setTimeout(()=>r(null),100));return}if(q==="SWAP_POSITIONS"&&G&&G.row>=0){if(Z&&Z.id===v.id||H.filter&&!H.filter(v,L.row,L.col))return;f(G,L),u(L,le),setTimeout(()=>r(null),100);return}if(q==="TRANSFER_STATUS_SELECT"&&G&&G.row>=0){if(Z&&Z.id===v.id||H.filter&&!H.filter(v,L.row,L.col))return;v.statuses&&v.statuses.length>0&&(D(L,G,v.statuses[0].type),u(G,le),setTimeout(()=>r(null),100));return}if(q==="TRANSFER_ALL_STATUSES"&&G&&G.row>=0){if(Z&&Z.id===v.id||H.filter&&!H.filter(v,L.row,L.col))return;N(L,G),u(G,le),setTimeout(()=>r(null),100);return}if(q==="REVEAL_ENEMY"){if(Z&&Z.id===v.id||H.filter&&!H.filter(v,L.row,L.col))return;a({type:"Revealed",count:1,isDragging:!1,sourceCoords:G,targetOwnerId:v.ownerId,onlyFaceDown:!0,onlyOpponents:!0,isDeployAbility:le}),setTimeout(()=>r(null),100);return}if(q==="CENSOR_SWAP"&&G&&G.row>=0){if(H.filter&&!H.filter(v))return;ae(L,"Exploit",je),ce(L,"Stun",je),u(G,le),setTimeout(()=>r(null),100);return}if(q==="ZEALOUS_WEAKEN"&&G&&G.row>=0){if(H.filter&&!H.filter(v))return;V(L,-1),u(G,le),setTimeout(()=>r(null),100);return}if(q==="CENTURION_BUFF"&&G&&G.row>=0){u(G,le),setTimeout(()=>r(null),100);return}if(q==="SELECT_UNIT_FOR_MOVE"&&G&&G.row>=0){if(H.filter&&!H.filter(v))return;r({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:v,sourceCoords:L,isDeployAbility:le,recordContext:n.recordContext,payload:{allowSelf:!1,abilitySourceCoords:G,range:H.range,chainedAction:H.chainedAction,originalActorId:je}});return}if(q==="SELECT_UNIT_FOR_MOVE"&&!G){if(H.filter&&!H.filter(v))return;r({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:v,sourceCoords:L,recordContext:n.recordContext,payload:{allowSelf:!1,range:H.range,chainedAction:H.chainedAction,originalActorId:je}});return}if(q==="INTEGRATOR_LINE_SELECT"&&G&&G.row>=0){if(L.row!==G.row&&L.col!==G.col)return;const Ee=e.board.length;let ie=0;if(L.row===G.row)for(let ke=0;ke<Ee;ke++){const Oe=e.board[L.row][ke];Oe.card&&(ie+=((re=Oe.card.statuses)==null?void 0:re.filter(We=>We.type==="Exploit"&&We.addedByPlayerId===je).length)||0)}else for(let ke=0;ke<Ee;ke++){const Oe=e.board[ke][L.col];Oe.card&&(ie+=((Re=Oe.card.statuses)==null?void 0:Re.filter(We=>We.type==="Exploit"&&We.addedByPlayerId===je).length)||0)}ie>0&&(Pe({row:G.row,col:G.col,text:`+${ie}`,playerId:je}),T(je,ie)),u(G,le),setTimeout(()=>r(null),100);return}if(q==="ZIUS_LINE_SELECT"&&G&&G.row>=0){if(L.row!==G.row&&L.col!==G.col)return;const Ee=e.board.length;let ie=0;if(L.row===G.row)for(let ke=0;ke<Ee;ke++){const Oe=e.board[L.row][ke];Oe.card&&(ie+=((Se=Oe.card.statuses)==null?void 0:Se.filter(We=>We.type==="Exploit"&&We.addedByPlayerId===je).length)||0)}else for(let ke=0;ke<Ee;ke++){const Oe=e.board[ke][L.col];Oe.card&&(ie+=((de=Oe.card.statuses)==null?void 0:de.filter(We=>We.type==="Exploit"&&We.addedByPlayerId===je).length)||0)}ie>0&&(Pe({row:G.row,col:G.col,text:`+${ie}`,playerId:je}),T(je,ie)),u(G,le),setTimeout(()=>r(null),100);return}return}!n&&!o&&z(v,L)}},[n,o,e,t,g,K,x,u,r,a,h,we,ae,ce,V,f,D,N,T,A,z,k,De,ve,J,l,Pe]),W=p.useCallback(v=>{var Y,Ae,xe,re,Re,Se;if(g.current||(n==null?void 0:n.type)!=="ENTER_MODE")return;const{mode:L,sourceCoords:$,sourceCard:ee,payload:oe,isDeployAbility:Ie}=n;if(L==="SCORE_LAST_PLAYED_LINE"||L==="SELECT_LINE_END"||L==="SELECT_DIAGONAL"){K(v);return}if(L==="SELECT_LINE_START"){K(v);return}const _e=(ee==null?void 0:ee.ownerId)??((Y=e.players.find(de=>de.id===e.activePlayerId))!=null&&Y.isDummy?e.activePlayerId:t||e.activePlayerId);if(L==="PATROL_MOVE"&&$&&ee&&$.row>=0){const de=v.row===$.row,q=v.col===$.col;if(v.row===$.row&&v.col===$.col){u($,Ie),setTimeout(()=>r(null),100);return}(de||q)&&(u($,Ie),x({card:ee,source:"board",boardCoords:$},{target:"board",boardCoords:v}),setTimeout(()=>r(null),100));return}if(L==="RIOT_MOVE"&&$&&ee&&oe.vacatedCoords){v.row===oe.vacatedCoords.row&&v.col===oe.vacatedCoords.col&&(x({card:ee,source:"board",boardCoords:$},{target:"board",boardCoords:v}),u(v,Ie),setTimeout(()=>r(null),100));return}if(L==="SPAWN_TOKEN"&&$&&oe.tokenName&&$.row>=0){if(Math.abs(v.row-$.row)+Math.abs(v.col-$.col)===1){const q=(ee==null?void 0:ee.ownerId)??_e;O(v,oe.tokenName,q),u($,Ie),setTimeout(()=>r(null),100)}return}if(L==="SELECT_CELL"&&ee){const de=(()=>{var H;if(oe.moveFromHand)return null;if($&&$.row>=0)return $;for(let Z=0;Z<e.board.length;Z++)for(let G=0;G<e.board.length;G++)if(((H=e.board[Z][G].card)==null?void 0:H.id)===ee.id)return{row:Z,col:G};return null})();if(oe.moveFromHand&&s.selectedHandCard){const{playerId:H,cardIndex:Z}=s.selectedHandCard,G=e.players.find(je=>je.id===H),le=G==null?void 0:G.hand[Z];le&&(x({card:le,source:"hand",playerId:H,cardIndex:Z,isManual:!0},{target:"board",boardCoords:v}),setTimeout(()=>r(null),100));return}let q=!1;if(de)if(oe.range==="line")q=v.row===de.row||v.col===de.col;else if(oe.range==="global")q=!0;else if(oe.range===2){const H=Math.abs(v.row-de.row)+Math.abs(v.col-de.col);if(H===1)q=!0;else if(H===2){const Z=de.row,G=de.col,le=v.row,je=v.col;q=[{r:le,c:G},{r:Z,c:je},{r:(Z+le)/2,c:(G+je)/2}].some(ie=>{if(!Number.isInteger(ie.r)||!Number.isInteger(ie.c))return!1;const ke=Math.floor((e.board.length-e.activeGridSize)/2),Oe=ke,We=ke+e.activeGridSize-1;return ie.r<Oe||ie.r>We||ie.c<Oe||ie.c>We||Math.abs(ie.r-Z)+Math.abs(ie.c-G)!==1?!1:!e.board[ie.r][ie.c].card})}}else q=Math.abs(v.row-de.row)+Math.abs(v.col-de.col)===1;if(q&&de){const H=oe.allowSelf&&v.row===de.row&&v.col===de.col;if(!H){const Z=e.board[de.row][de.col].card;Z&&x({card:Z,source:"board",boardCoords:de,bypassOwnershipCheck:!0},{target:"board",boardCoords:v})}if(n.recordContext&&l({lastMovedCardCoords:v,lastMovedCardId:ee.id}),oe.chainedAction){const Z={...oe.chainedAction};Z.targetOwnerId===-2&&(Z.targetOwnerId=ee.ownerId),n.recordContext&&(Z.payload||(Z.payload={}),Z.payload._tempContextId=ee.id),J(Z,v),Z.type!=="ENTER_MODE"&&r(null)}else{if(oe.abilitySourceCoords)u(oe.abilitySourceCoords,Ie);else{const Z=H?$:v;Z&&Z.row>=0&&(oe.originalActorId===void 0||ee.ownerId===oe.originalActorId)&&u(Z,Ie)}setTimeout(()=>r(null),100)}return}return}if(L==="IMMUNIS_RETRIEVE"&&$&&$.row>=0){if(oe.selectedCardIndex!==void 0&&((Ae=oe.filter)!=null&&Ae.call(oe,v.row,v.col))){_(_e,oe.selectedCardIndex,v),u($,Ie),setTimeout(()=>r(null),100);return}if(oe.selectedCardIndex===void 0)return}if(L==="INTEGRATOR_LINE_SELECT"&&$&&$.row>=0){if(v.row!==$.row&&v.col!==$.col)return;const de=e.board.length;let q=0;if(v.row===$.row)for(let H=0;H<de;H++){const Z=e.board[v.row][H];Z.card&&(q+=((xe=Z.card.statuses)==null?void 0:xe.filter(G=>G.type==="Exploit"&&G.addedByPlayerId===_e).length)||0)}else for(let H=0;H<de;H++){const Z=e.board[H][v.col];Z.card&&(q+=((re=Z.card.statuses)==null?void 0:re.filter(G=>G.type==="Exploit"&&G.addedByPlayerId===_e).length)||0)}q>0&&(Pe({row:$.row,col:$.col,text:`+${q}`,playerId:_e}),T(_e,q)),u($,Ie),setTimeout(()=>r(null),100);return}if(L==="ZIUS_LINE_SELECT"&&$&&$.row>=0){if(v.row!==$.row&&v.col!==$.col)return;const de=e.board.length;let q=0;if(v.row===$.row)for(let H=0;H<de;H++){const Z=e.board[v.row][H];Z.card&&(q+=((Re=Z.card.statuses)==null?void 0:Re.filter(G=>G.type==="Exploit"&&G.addedByPlayerId===_e).length)||0)}else for(let H=0;H<de;H++){const Z=e.board[H][v.col];Z.card&&(q+=((Se=Z.card.statuses)==null?void 0:Se.filter(G=>G.type==="Exploit"&&G.addedByPlayerId===_e).length)||0)}q>0&&(Pe({row:$.row,col:$.col,text:`+${q}`,playerId:_e}),T(_e,q)),u($,Ie),setTimeout(()=>r(null),100);return}},[g,n,e,t,K,x,u,r,O,l,_,T,s,J,Pe]),he=p.useCallback((v,L,$)=>{if(!g.current&&(n==null?void 0:n.type)==="ENTER_MODE"&&n.mode==="SELECT_TARGET"){const{payload:ee,sourceCoords:oe,isDeployAbility:Ie,sourceCard:_e}=n;if(ee.actionType==="SELECT_HAND_FOR_DEPLOY"){if(ee.filter&&!ee.filter(L))return;l(Y=>({...Y,selectedHandCard:{playerId:v.id,cardIndex:$}})),r({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:L,payload:{range:"global",moveFromHand:!0}});return}if(ee.actionType==="SELECT_HAND_FOR_DISCARD_THEN_SPAWN"){if(v.id!==(_e==null?void 0:_e.ownerId))return;x({card:L,source:"hand",playerId:v.id,cardIndex:$,bypassOwnershipCheck:!0},{target:"discard",playerId:v.id}),r({type:"ENTER_MODE",mode:"SPAWN_TOKEN",sourceCard:n.sourceCard,sourceCoords:n.sourceCoords,isDeployAbility:n.isDeployAbility,payload:{tokenName:ee.tokenName}});return}if(ee.actionType==="LUCIUS_SETUP"){if(v.id!==(_e==null?void 0:_e.ownerId))return;x({card:L,source:"hand",playerId:v.id,cardIndex:$,bypassOwnershipCheck:!0},{target:"discard",playerId:v.id});const Y={type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:n.sourceCard,sourceCoords:n.sourceCoords,isDeployAbility:n.isDeployAbility,payload:{filterType:"Command"}};J(Y,n.sourceCoords||{row:-1,col:-1}),r(null);return}if(ee.actionType==="DESTROY"){if(ee.filter&&!ee.filter(L))return;x({card:L,source:"hand",playerId:v.id,cardIndex:$,bypassOwnershipCheck:!0},{target:"discard",playerId:v.id}),oe&&oe.row>=0&&u(oe,Ie),setTimeout(()=>r(null),100)}}},[g,n,x,u,r,l,J]),Ne=p.useCallback((v,L)=>{n||o||g.current||e.isGameStarted&&e.activePlayerId===v.id&&Bl(L,e.currentPhase,e.activePlayerId,e)&&z(L,{row:-1,col:-1})},[n,o,g,e,z]);return{activateAbility:z,executeAction:J,handleLineSelection:K,handleBoardCardClick:ne,handleEmptyCellClick:W,handleHandCardClick:he,handleAnnouncedCardDoubleClick:Ne}},Gs=(e,t,n,r,o)=>{const a=(n.baseId||e.split("_")[1]||e).toLowerCase(),s=t===-1,l=[];return a==="overwatch"?s?l.push({type:"CREATE_STACK",tokenType:"Aim",count:1,sourceCard:n}):t===0?l.push({type:"CREATE_STACK",tokenType:"Revealed",dynamicCount:{factor:"Aim",ownerId:o},targetOwnerId:-1,onlyOpponents:!0,sourceCard:n}):t===1&&l.push({type:"GLOBAL_AUTO_APPLY",payload:{dynamicResource:{type:"draw",factor:"Aim",ownerId:o}},sourceCard:n}):a==="tacticalmaneuver"?t===0?l.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",recordContext:!0,sourceCard:n,payload:{range:"line",filter:c=>c.ownerId===o,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{contextReward:"DRAW_MOVED_POWER"},sourceCard:n}}}):t===1&&l.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",recordContext:!0,sourceCard:n,payload:{range:"line",filter:c=>c.ownerId===o,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{contextReward:"SCORE_MOVED_POWER"},sourceCard:n}}}):a==="inspiration"?s&&l.push({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:n,payload:{actionType:"OPEN_COUNTER_MODAL",filter:c=>c.ownerId===o}}):a==="datainterception"?s?l.push({type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:n}):t===0?l.push({type:"CREATE_STACK",tokenType:"Revealed",dynamicCount:{factor:"Exploit",ownerId:o},onlyFaceDown:!0,onlyOpponents:!0,targetOwnerId:-1,sourceCard:n}):t===1&&l.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:n,payload:{range:2,filter:c=>{var d;return((d=c.statuses)==null?void 0:d.some(h=>h.type==="Exploit"&&h.addedByPlayerId===o))||!1}}}):a==="falseorders"?s?l.push({type:"CREATE_STACK",tokenType:"Exploit",count:1,sourceCard:n,onlyOpponents:!0,targetType:"Unit",recordContext:!0}):t===0?l.push({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:n,recordContext:!0,payload:{range:2,chainedAction:{type:"CREATE_STACK",tokenType:"Revealed",count:2,targetOwnerId:-2,onlyFaceDown:!0,excludeOwnerId:o}}}):t===1&&l.push({type:"ENTER_MODE",mode:"SELECT_CELL",sourceCard:n,recordContext:!0,payload:{range:2,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{tokenType:"Stun",count:2,ownerId:o}}}}):a==="experimentalstimulants"?t===0?l.push({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:n,payload:{actionType:"RESET_DEPLOY",filter:c=>{var d;return c.ownerId===o&&((d=c.types)==null?void 0:d.includes("Unit"))}}}):t===1&&l.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:n,payload:{range:"line",filter:c=>c.ownerId===o}}):a==="logisticschain"?t===0?l.push({type:"ENTER_MODE",mode:"SELECT_DIAGONAL",sourceCard:n,payload:{actionType:"SCORE_DIAGONAL",bonusType:"point_per_support"}}):t===1&&l.push({type:"ENTER_MODE",mode:"SELECT_DIAGONAL",sourceCard:n,payload:{actionType:"SCORE_DIAGONAL",bonusType:"draw_per_support"}}):a==="quickresponseteam"?t===0?l.push({type:"ENTER_MODE",mode:"SELECT_TARGET",sourceCard:n,payload:{actionType:"SELECT_HAND_FOR_DEPLOY",filter:c=>{var d;return c.ownerId===o&&((d=c.types)==null?void 0:d.includes("Unit"))}}}):t===1&&l.push({type:"OPEN_MODAL",mode:"SEARCH_DECK",sourceCard:n,payload:{filterType:"Unit"}}):a==="temporaryshelter"?t===0?l.push({type:"CREATE_STACK",tokenType:"Shield",count:1,targetOwnerId:o,recordContext:!0,sourceCard:n,chainedAction:{type:"GLOBAL_AUTO_APPLY",payload:{customAction:"REMOVE_ALL_AIM_FROM_CONTEXT"}}}):t===1&&l.push({type:"CREATE_STACK",tokenType:"Shield",count:1,targetOwnerId:o,recordContext:!0,sourceCard:n,chainedAction:{type:"ENTER_MODE",mode:"SELECT_CELL",payload:{range:2}}}):a==="enhancedinterrogation"?s?l.push({type:"CREATE_STACK",tokenType:"Aim",count:1,sourceCard:n}):t===0?l.push({type:"CREATE_STACK",tokenType:"Revealed",dynamicCount:{factor:"Aim",ownerId:o},onlyFaceDown:!0,onlyOpponents:!0,targetOwnerId:-1,sourceCard:n}):t===1&&l.push({type:"ENTER_MODE",mode:"SELECT_UNIT_FOR_MOVE",sourceCard:n,payload:{range:2,filter:c=>{var d;return((d=c.statuses)==null?void 0:d.some(h=>h.type==="Aim"&&h.addedByPlayerId===o))||!1}}}):(a==="mobilization1"||a==="linebreach")&&s&&l.push({type:"ENTER_MODE",mode:"SELECT_LINE_START",sourceCard:n,payload:{actionType:"SCORE_LINE"}}),l},Tv=({gameState:e,localPlayerId:t,setActionQueue:n,setCommandContext:r,setCommandModalCard:o,setCounterSelectionData:a,moveItem:s,drawCard:l,updatePlayerScore:c,removeBoardCardStatus:d})=>{const h=p.useCallback((b,x)=>{if(t===null)return;const A=e.players.find(f=>f.id===x.playerId);if(!(x.playerId===t||(A==null?void 0:A.isDummy)))return;s(x,{target:"announced",playerId:x.playerId}),r({});const u=(b.baseId||b.id.split("_")[1]||b.id).toLowerCase();if(["overwatch","tacticalmaneuver","repositioning","inspiration","datainterception","falseorders","experimentalstimulants","logisticschain","quickresponseteam","temporaryshelter","enhancedinterrogation"].some(f=>u.includes(f)))o(b);else{const f=Gs(b.id,-1,b,e,x.playerId);f.length>0?n([...f,{type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:b,ownerId:x.playerId},sourceCard:b}]):n([{type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:b,ownerId:x.playerId},sourceCard:b}])}},[e,t,s,n,r,o]),k=p.useCallback((b,x)=>{var D,N;if(!x||t===null)return;const A=x.ownerId||t,T=[],u=Gs(x.id,-1,x,e,A);let m;(D=x.baseId)!=null&&D.toLowerCase().includes("inspiration")&&(m=b===0?"DRAW_REMOVED":"SCORE_REMOVED",u.length>0&&u[0].type==="ENTER_MODE"&&(u[0]={...u[0],payload:{...u[0].payload,rewardType:m}})),u.forEach(_=>{T.push(_)}),Gs(x.id,b,x,e,A).forEach(_=>{T.push(_)}),(N=x.baseId)!=null&&N.toLowerCase().includes("inspiration")||T.push({type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:x,ownerId:A},sourceCard:x}),n(T),o(null)},[e,t,n,o]),g=p.useCallback((b,x)=>{var f;if(t===null)return;const A=x.card.ownerId||t;let T=null;for(let D=0;D<e.board.length;D++){for(let N=0;N<e.board[D].length;N++)if(((f=e.board[D][N].card)==null?void 0:f.id)===x.card.id){T={row:D,col:N};break}if(T)break}if(!T){console.warn(`Card ${x.card.id} not found on board during counter removal`),a(null);return}let u=0;if(Object.entries(b).forEach(([D,N])=>{for(let _=0;_<N;_++)d(T,D),u++}),u>0)if(x.callbackAction==="DRAW_REMOVED")for(let D=0;D<u;D++)l(A);else x.callbackAction==="SCORE_REMOVED"&&c(A,u);const m=e.players.find(D=>D.id===A);m!=null&&m.announcedCard&&n([{type:"GLOBAL_AUTO_APPLY",payload:{cleanupCommand:!0,card:m.announcedCard,ownerId:A},sourceCard:m.announcedCard}]),a(null)},[t,l,c,n,a,e,d]);return{playCommandCard:h,handleCommandConfirm:k,handleCounterSelectionConfirm:g}},Ev=({gameState:e,localPlayerId:t,handleDrop:n,markAbilityUsed:r,setAbilityMode:o,requestCardReveal:a,interactionLock:s,setCommandContext:l,onAction:c,cursorStack:d,setCursorStack:h})=>{const k=p.useRef(null),g=p.useRef({x:0,y:0});return p.useLayoutEffect(()=>{if(d&&k.current){const{x,y:A}=g.current;k.current.style.transform=`translate(${x-24}px, ${A-24}px)`}},[d]),p.useEffect(()=>{const x=A=>{g.current={x:A.clientX,y:A.clientY},k.current&&(k.current.style.transform=`translate(${A.clientX-24}px, ${A.clientY-24}px)`)};return window.addEventListener("mousemove",x),()=>window.removeEventListener("mousemove",x)},[]),p.useEffect(()=>{const x=A=>{var D;if(A.button!==0||!d)return;const T=document.elementFromPoint(A.clientX,A.clientY);let u=t;if(d.sourceCoords&&d.sourceCoords.row>=0){const{row:N,col:_}=d.sourceCoords;if(N>=0&&N<e.board.length&&_>=0&&_<((D=e.board[N])==null?void 0:D.length)){const O=e.board[N][_].card;O&&(u=O.ownerId||t)}}else if(e.activePlayerId){const N=e.players.find(_=>_.id===e.activePlayerId);N!=null&&N.isDummy&&(u=N.id)}const m=T==null?void 0:T.closest("[data-hand-card]");if(m){const N=m.getAttribute("data-hand-card");if(N){const[_,O]=N.split(","),M=parseInt(_,10),I=parseInt(O,10),V=e.players.find(we=>we.id===M),ce=V==null?void 0:V.hand[I];if(V&&ce){const we={targetOwnerId:d.targetOwnerId,excludeOwnerId:d.excludeOwnerId,onlyOpponents:d.onlyOpponents||d.targetOwnerId===-1,onlyFaceDown:d.onlyFaceDown,targetType:d.targetType,requiredTargetStatus:d.requiredTargetStatus,tokenType:d.type};if(!Sa({card:ce,ownerId:M,location:"hand"},we,u,e.players))return;n({card:{id:"stack",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:d.type,count:1},{target:"hand",playerId:M,cardIndex:I,boardCoords:void 0}),d.sourceCoords&&d.sourceCoords.row>=0&&r(d.sourceCoords,d.isDeployAbility),d.count>1?h(De=>De?{...De,count:De.count-1}:null):(d.chainedAction&&c(d.chainedAction,d.sourceCoords||{row:-1,col:-1}),h(null)),s.current=!0,setTimeout(()=>{s.current=!1},300);return}}}const f=T==null?void 0:T.closest("[data-board-coords]");if(f){const N=f.getAttribute("data-board-coords");if(N){const[_,O]=N.split(","),M=parseInt(_,10),I=parseInt(O,10);if(!isNaN(M)&&!isNaN(I)&&M>=0&&M<e.board.length&&e.board[M]&&I>=0&&I<e.board[M].length&&e.board[M][I]){const V=e.board[M][I].card;if((V==null?void 0:V.ownerId)!==void 0){const ce={targetOwnerId:d.targetOwnerId,excludeOwnerId:d.excludeOwnerId,onlyOpponents:d.onlyOpponents||d.targetOwnerId===-1,onlyFaceDown:d.onlyFaceDown,targetType:d.targetType,requiredTargetStatus:d.requiredTargetStatus,mustBeAdjacentToSource:d.mustBeAdjacentToSource,mustBeInLineWithSource:d.mustBeInLineWithSource,sourceCoords:d.sourceCoords,tokenType:d.type};if(!Sa({card:V,ownerId:V.ownerId,location:"board",boardCoords:{row:M,col:I}},ce,u,e.players))return;const ae=e.players.find(De=>De.id===V.ownerId);if(d.type==="Revealed"&&V.ownerId!==u&&!(ae!=null&&ae.isDummy)){V.isFaceDown?t!==null&&a({source:"board",ownerId:V.ownerId,boardCoords:{row:M,col:I}},t):n({card:{id:"stack",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:d.type,count:1},{target:"board",boardCoords:{row:M,col:I}}),d.sourceCoords&&d.sourceCoords.row>=0&&r(d.sourceCoords,d.isDeployAbility),d.count>1?h(De=>De?{...De,count:De.count-1}:null):(d.chainedAction&&c(d.chainedAction,d.sourceCoords||{row:-1,col:-1}),h(null)),s.current=!0,setTimeout(()=>{s.current=!1},300);return}}if(V){const ce=d.placeAllAtOnce?d.count:1;if(n({card:{id:"stack",deck:"counter",name:"",imageUrl:"",fallbackImage:"",power:0,ability:"",types:[]},source:"counter_panel",statusType:d.type,count:ce},{target:"board",boardCoords:{row:M,col:I}}),d.recordContext&&l(we=>({...we,lastMovedCardCoords:{row:M,col:I},lastMovedCardId:V.id})),d.sourceCoords&&d.sourceCoords.row>=0&&r(d.sourceCoords,d.isDeployAbility),d.count>ce)h(we=>we?{...we,count:we.count-ce}:null);else{if(d.chainedAction){const we={...d.chainedAction};d.recordContext&&(we.mode==="SELECT_CELL"&&(we.sourceCard=V,we.sourceCoords={row:M,col:I},we.recordContext=!0),we.type==="GLOBAL_AUTO_APPLY"&&(we.sourceCoords={row:M,col:I})),c(we,d.sourceCoords||{row:-1,col:-1})}h(null)}s.current=!0,setTimeout(()=>{s.current=!1},300)}}}}else{const N=T==null?void 0:T.closest(".counter-modal-content"),_=(T==null?void 0:T.closest("[data-board-coords]"))!==null,O=(T==null?void 0:T.closest("[data-hand-card]"))!==null;d.isDragging?N?h(M=>M?{...M,isDragging:!1}:null):!_&&!O&&h(null):!N&&!_&&!O&&h(null)}};return window.addEventListener("mouseup",x),()=>{window.removeEventListener("mouseup",x)}},[d,n,e,t,a,r,o,s,l,c,h]),p.useEffect(()=>{const x=A=>{d&&(A.preventDefault(),h(null))};return window.addEventListener("contextmenu",x),()=>{window.removeEventListener("contextmenu",x)}},[d,h]),{cursorFollowerRef:k,handleCounterMouseDown:(x,A)=>{g.current={x:A.clientX,y:A.clientY},h(T=>(T==null?void 0:T.type)===x?{type:x,count:T.count+1,isDragging:!0,sourceCoords:T.sourceCoords}:{type:x,count:1,isDragging:!0})}}},Sv="https://res.cloudinary.com/dxxh6meej/image/upload/v1763653192/background_counter_socvss.png",jv=p.memo(function(){var Xd,eu,tu,nu;const{t}=Nt(),n=kv(),{gameState:r,localPlayerId:o,setLocalPlayerId:a,createGame:s,joinGame:l,startReadyCheck:c,cancelReadyCheck:d,playerReady:h,assignTeams:k,setGameMode:g,setGamePrivacy:b,setActiveGridSize:x,setDummyPlayerCount:A,updatePlayerName:T,changePlayerColor:u,updatePlayerScore:m,changePlayerDeck:f,loadCustomDeck:D,drawCard:N,handleDrop:_,draggedItem:O,setDraggedItem:M,connectionStatus:I,gamesList:V,requestGamesList:ce,exitGame:we,moveItem:ae,shufflePlayerDeck:De,addBoardCardStatus:me,removeBoardCardStatus:ve,removeBoardCardStatusByOwner:Pe,modifyBoardCardPower:J,addAnnouncedCardStatus:z,removeAnnouncedCardStatus:K,modifyAnnouncedCardPower:ne,addHandCardStatus:W,removeHandCardStatus:he,flipBoardCard:Ne,flipBoardCardFaceDown:v,revealHandCard:L,revealBoardCard:$,requestCardReveal:ee,respondToRevealRequest:oe,syncGame:Ie,resetGame:_e,toggleActivePlayer:Y,toggleAutoDraw:Ae,forceReconnect:xe,triggerHighlight:re,latestHighlight:Re,latestFloatingTexts:Se,latestNoTarget:de,triggerNoTarget:q,nextPhase:H,prevPhase:Z,setPhase:G,markAbilityUsed:le,applyGlobalEffect:je,swapCards:Ee,transferStatus:ie,transferAllCounters:ke,recoverDiscardedCard:Oe,resurrectDiscardedCard:We,spawnToken:qe,scoreLine:$e,confirmRoundEnd:St,resetDeployStatus:bt,scoreDiagonal:Ot,removeStatusByType:kn,reorderTopDeck:Ut,reorderCards:Ft,triggerFloatingText:_o}=n,[ht,it]=p.useState({isJoinModalOpen:!1,isDeckBuilderOpen:!1,isSettingsModalOpen:!1,isTokensModalOpen:!1,isCountersModalOpen:!1,isRulesModalOpen:!1,isTeamAssignOpen:!1}),[Vr,Hr]=p.useState(null),[$r,Tr]=p.useState(null),[Ve,Zn]=p.useState(null),[Ra,Er]=p.useState({tokensModalAnchor:null,countersModalAnchor:null}),[Ge,Dn]=p.useState(null),[Wr,dn]=p.useState(null),[y,w]=p.useState(()=>{try{const U=localStorage.getItem("image_refresh_data");if(U){const{version:ue,timestamp:fe}=JSON.parse(U),Q=12*60*60*1e3;if(Date.now()-fe<Q)return ue}}catch(U){console.error("Error parsing image refresh data",U)}const C=Date.now();return localStorage.setItem("image_refresh_data",JSON.stringify({version:C,timestamp:C})),C}),[E,R]=p.useState(null),[j,S]=p.useState(null),[B,P]=p.useState(null),[ye,be]=p.useState([]),[et,vt]=p.useState(()=>{try{const C=localStorage.getItem("auto_abilities_enabled");return C===null?!0:C==="true"}catch{return!0}});p.useEffect(()=>{try{localStorage.setItem("auto_abilities_enabled",String(et))}catch{}},[et]);const xt=p.useMemo(()=>{if(!o)return!1;const C=r.players.find(U=>U.id===o);return(C==null?void 0:C.autoDrawEnabled)??!0},[r.players,o]);p.useEffect(()=>{if(!o||!r.gameId||r.isGameStarted)return;let C=!0;try{const ue=localStorage.getItem("auto_draw_enabled");ue!==null&&(C=ue==="true")}catch{}const U=r.players.find(ue=>ue.id===o);U&&U.autoDrawEnabled!==C&&Ae(o,C)},[o,r.gameId,r.isGameStarted,r.players,Ae]),p.useEffect(()=>{if(!o)return;const C=r.players.find(U=>U.id===o);if(C&&C.autoDrawEnabled!==void 0)try{localStorage.setItem("auto_draw_enabled",String(C.autoDrawEnabled))}catch{}},[o,r.players]);const[Qe,Kt]=p.useState(!1),[F,Ce]=p.useState(null),[Te,Ue]=p.useState([]),[Me,ct]=p.useState([]),[Ct,ft]=p.useState([]),[Qn,Aa]=p.useState(null),[un,Do]=p.useState({}),[lm,is]=p.useState(0),dm=p.useRef(null),um=p.useRef(null),[Vd,cm]=p.useState(void 0),Sr=p.useRef(!1),[pe,ss]=p.useState(null),Ro=p.useMemo(()=>{var C;return o?(C=r.revealRequests)==null?void 0:C.find(U=>U.toPlayerId===o):null},[r.revealRequests,o]),{playCommandCard:Ao,handleCommandConfirm:fm,handleCounterSelectionConfirm:pm}=Tv({gameState:r,localPlayerId:o,setActionQueue:Ue,setCommandContext:Do,setCommandModalCard:Hr,setCounterSelectionData:Tr,moveItem:ae,drawCard:N,updatePlayerScore:m,removeBoardCardStatus:ve}),mm=p.useCallback(()=>{Kt(!0),H()},[H]),{executeAction:Oo,handleBoardCardClick:hm,handleEmptyCellClick:ym,handleHandCardClick:Hd}=Cv({gameState:r,localPlayerId:o,abilityMode:F,setAbilityMode:Ce,cursorStack:pe,setCursorStack:ss,commandContext:un,setCommandContext:Do,setViewingDiscard:Dn,triggerNoTarget:q,setPlayMode:S,setCounterSelectionData:Tr,interactionLock:Sr,onAbilityComplete:()=>is(C=>C+1),moveItem:ae,drawCard:N,updatePlayerScore:m,markAbilityUsed:le,applyGlobalEffect:je,swapCards:Ee,transferStatus:ie,transferAllCounters:ke,resurrectDiscardedCard:We,spawnToken:qe,scoreLine:$e,nextPhase:mm,modifyBoardCardPower:J,addBoardCardStatus:me,removeBoardCardStatus:ve,removeBoardCardStatusByOwner:Pe,resetDeployStatus:bt,scoreDiagonal:Ot,removeStatusByType:kn,triggerFloatingText:_o}),$d=(C,U)=>{if(F||pe||Sr.current)return;const ue=C.id===o,fe=!!C.isDummy;if(ue||fe){if(U.deck===Be.Command){cn(),Ao(U,{card:U,source:"announced",playerId:C.id});return}cn();const Je={card:U,source:"announced",playerId:C.id};S({card:U,sourceItem:Je,faceDown:!1})}else dn({card:U,player:C})},{cursorFollowerRef:gm,handleCounterMouseDown:vm}=Ev({gameState:r,localPlayerId:o,handleDrop:_,markAbilityUsed:le,setAbilityMode:Ce,requestCardReveal:ee,interactionLock:Sr,setCommandContext:Do,onAction:Oo,cursorStack:pe,setCursorStack:ss}),Kr=p.useMemo(()=>o===null&&r.gameId!==null,[o,r.gameId]),xm=p.useMemo(()=>{var C;return((C=r.players)==null?void 0:C.filter(U=>!U.isDummy).length)||0},[r.players]),ls=p.useMemo(()=>o===1,[o]),wt=p.useMemo(()=>{var C;return(C=r.players)==null?void 0:C.find(U=>U.id===o)},[r.players,o]),wm=p.useMemo(()=>r.gameId&&(wt||Kr),[r.gameId,wt,Kr]),Po=p.useMemo(()=>{var U;const C=new Map;return(U=r.players)==null||U.forEach(ue=>C.set(ue.id,ue.color)),C},[r.players]),ds=p.useMemo(()=>!!F||!!pe,[F,pe]),Wd=p.useCallback(C=>{(F==null?void 0:F.mode)==="SELECT_DECK"&&(Zn({targetPlayerId:C,isLocked:!0,initialCount:3,...F.sourceCard&&{sourceCard:F.sourceCard},...F.isDeployAbility!==void 0&&{isDeployAbility:F.isDeployAbility},...F.sourceCoords&&{sourceCoords:F.sourceCoords}}),Ce(null))},[F]),km=p.useCallback((C,U)=>{Ut(C,U)},[Ut]),bm=p.useCallback(C=>{if(!Ve)return;const U=r.players.find(fe=>fe.id===Ve.targetPlayerId);if(!U||U.deck.length<=C)return;const ue=U.deck[C];ue&&ae({card:ue,source:"deck",playerId:Ve.targetPlayerId,cardIndex:C},{target:"deck",playerId:Ve.targetPlayerId,deckPosition:"bottom"})},[Ve,r.players,ae]),Cm=p.useCallback(C=>{if(!Ve)return;const U=r.players.find(fe=>fe.id===Ve.targetPlayerId);if(!U||U.deck.length<=C)return;const ue=U.deck[C];ue&&ae({card:ue,source:"deck",playerId:Ve.targetPlayerId,cardIndex:C},{target:"hand",playerId:Ve.targetPlayerId})},[Ve,r.players,ae]),Tm=p.useCallback(C=>{if(!Ve)return;const U=r.players.find(fe=>fe.id===Ve.targetPlayerId);if(!U||U.deck.length<=C)return;const ue=U.deck[C];ue&&ae({card:ue,source:"deck",playerId:Ve.targetPlayerId,cardIndex:C},{target:"discard",playerId:Ve.targetPlayerId})},[Ve,r.players,ae]),Em=p.useCallback(C=>{if(!Ve)return;const U=r.players.find(Q=>Q.id===Ve.targetPlayerId);if(!U||U.deck.length<=C)return;const ue=U.deck[C];if(!ue)return;Zn(null);const fe={card:ue,source:"deck",playerId:Ve.targetPlayerId,cardIndex:C};S({card:ue,sourceItem:fe,faceDown:!1})},[Ve,r.players,S]),Sm=p.useCallback(()=>{Ve&&Ve.isLocked&&Ve.sourceCard&&(Ve.sourceCard.ownerId!==void 0&&N(Ve.sourceCard.ownerId),Ve.sourceCoords&&le(Ve.sourceCoords,Ve.isDeployAbility)),Zn(null)},[Ve,N,le]),Kd=p.useMemo(()=>Ve?r.players.find(C=>C.id===Ve.targetPlayerId):null,[Ve,r.players]);p.useLayoutEffect(()=>{const C=()=>{const fe=window.innerHeight-56,Je=(window.innerWidth-fe)/2;cm(Math.max(0,Je))};return window.addEventListener("resize",C),C(),()=>window.removeEventListener("resize",C)},[]),p.useEffect(()=>{vg().catch(C=>{console.error("Failed to load content database:",C)})},[]),p.useEffect(()=>{const C=U=>{Sr.current&&(U.stopPropagation(),U.preventDefault())};return window.addEventListener("click",C,!0),()=>window.removeEventListener("click",C,!0)},[]),p.useEffect(()=>{const C=()=>{F!=null&&F.sourceCoords&&F.sourceCoords.row>=0&&le(F.sourceCoords,F.isDeployAbility,!1,F.readyStatusToRemove),pe!=null&&pe.sourceCoords&&pe.sourceCoords.row>=0&&le(pe.sourceCoords,pe.isDeployAbility),r.players.forEach(fe=>{(fe.id===o||fe.isDummy)&&fe.announcedCard&&ae({card:fe.announcedCard,source:"announced",playerId:fe.id},{target:"discard",playerId:fe.id})}),ss(null),S(null),Ce(null),Dn(null),Hr(null),Ue([]),Do({}),Tr(null),Zn(null)},U=fe=>{["INPUT","TEXTAREA","SELECT"].includes(fe.target.tagName)||(fe.code==="Space"&&(fe.preventDefault(),r.isGameStarted&&H()),fe.key==="Escape"&&C())},ue=fe=>{(pe||j||F)&&(fe.preventDefault(),C())};return window.addEventListener("keydown",U),window.addEventListener("contextmenu",ue),()=>{window.removeEventListener("keydown",U),window.removeEventListener("contextmenu",ue)}},[pe,j,F,le,r.isGameStarted,H,wt,ae,r.players,o]),p.useEffect(()=>{if(de){Aa(de.coords);const C=setTimeout(()=>Aa(null),2e3);return()=>clearTimeout(C)}},[de]);const qd=p.useRef("");p.useEffect(()=>{Kt(!1)},[r.currentPhase]),p.useEffect(()=>{is(C=>C+1)},[r.currentPhase]),p.useEffect(()=>{const C=r.activePlayerId;if(C===void 0)return;let U="";r.board.forEach(ue=>{ue.forEach(fe=>{var Q;if(((Q=fe.card)==null?void 0:Q.ownerId)===C&&fe.card.statuses){const Je=fe.card.statuses.filter(se=>se.type==="Support").length,ze=fe.card.statuses.filter(se=>se.type==="Threat").length,Fe=fe.card.statuses.filter(se=>se.type==="Stun").length;U+=`${fe.card.id}:${Je}:${ze}:${Fe};`}})}),qd.current!==U&&(qd.current=U,is(ue=>ue+1))},[r.board,r.activePlayerId]),p.useEffect(()=>{var Q,Je;let C=F;pe&&!F&&(C={type:"CREATE_STACK",tokenType:pe.type,count:pe.count,...pe.onlyFaceDown!==void 0&&{onlyFaceDown:pe.onlyFaceDown},...pe.onlyOpponents!==void 0&&{onlyOpponents:pe.onlyOpponents},...pe.targetOwnerId!==void 0&&{targetOwnerId:pe.targetOwnerId},...pe.excludeOwnerId!==void 0&&{excludeOwnerId:pe.excludeOwnerId},...pe.targetType&&{targetType:pe.targetType},...pe.requiredTargetStatus&&{requiredTargetStatus:pe.requiredTargetStatus},...pe.mustBeAdjacentToSource&&{mustBeAdjacentToSource:pe.mustBeAdjacentToSource},...pe.mustBeInLineWithSource&&{mustBeInLineWithSource:pe.mustBeInLineWithSource},...pe.sourceCoords&&{sourceCoords:pe.sourceCoords}});let U=o||r.activePlayerId||null;if((Q=C==null?void 0:C.sourceCard)!=null&&Q.ownerId)U=C.sourceCard.ownerId;else if(C!=null&&C.sourceCoords&&C.sourceCoords.row>=0&&C.sourceCoords.row<r.board.length&&C.sourceCoords.col>=0&&C.sourceCoords.col<r.board[C.sourceCoords.row].length){const ze=r.board[C.sourceCoords.row][C.sourceCoords.col],Fe=ze==null?void 0:ze.card;Fe!=null&&Fe.ownerId&&(U=Fe.ownerId)}else if(r.activePlayerId){const ze=r.players.find(Fe=>Fe.id===r.activePlayerId);ze!=null&&ze.isDummy&&(U=ze.id)}const ue=Vl(C,r,U??null,un),fe=[];if((F==null?void 0:F.type)==="ENTER_MODE"&&F.mode==="SELECT_TARGET")(F.payload.actionType==="SELECT_HAND_FOR_DEPLOY"||F.payload.filter)&&r.players.forEach(ze=>{ze.hand.forEach((Fe,se)=>{var X,tt;(tt=(X=F.payload).filter)!=null&&tt.call(X,Fe)&&(F.payload.actionType==="SELECT_HAND_FOR_DEPLOY"?ze.id===U&&fe.push({playerId:ze.id,cardIndex:se}):fe.push({playerId:ze.id,cardIndex:se}))})});else if(pe){const ze=Gr[pe.type];(pe.type==="Revealed"||((Je=ze==null?void 0:ze.allowedTargets)==null?void 0:Je.includes("hand")))&&r.players.forEach(se=>{se.hand.forEach((X,tt)=>{const Le={...pe.targetOwnerId!==void 0&&{targetOwnerId:pe.targetOwnerId},...pe.excludeOwnerId!==void 0&&{excludeOwnerId:pe.excludeOwnerId},onlyOpponents:pe.onlyOpponents||pe.targetOwnerId===-1,...pe.onlyFaceDown!==void 0&&{onlyFaceDown:pe.onlyFaceDown},...pe.targetType&&{targetType:pe.targetType},...pe.requiredTargetStatus&&{requiredTargetStatus:pe.requiredTargetStatus},tokenType:pe.type};Sa({card:X,ownerId:se.id,location:"hand"},Le,U,r.players)&&fe.push({playerId:se.id,cardIndex:tt})})})}if(F&&(F.mode==="SCORE_LAST_PLAYED_LINE"||F.mode==="SELECT_LINE_END")){const ze=r.board.length;if(F.sourceCoords){for(let Fe=0;Fe<ze;Fe++)ue.push({row:Fe,col:F.sourceCoords.col});for(let Fe=0;Fe<ze;Fe++)ue.push({row:F.sourceCoords.row,col:Fe})}else for(let Fe=0;Fe<ze;Fe++)for(let se=0;se<ze;se++)ue.push({row:Fe,col:se})}ct(ue),ft(fe)},[F,pe,r.board,r.players,o,un,r.activePlayerId]),p.useEffect(()=>{if(Re){P(Re);const C=setTimeout(()=>P(null),1e3);return()=>clearTimeout(C)}},[Re]),p.useEffect(()=>{if(Se&&Se.length>0){const C=Se.map(ue=>({...ue,id:`float_${Date.now()}_${Math.random()}`}));be(ue=>[...ue,...C]);const U=setTimeout(()=>{be(ue=>ue.filter(fe=>!C.find(Q=>Q.id===fe.id)))},2e3);return()=>clearTimeout(U)}},[Se]),p.useEffect(()=>{var C,U;if(!r.isScoringStep&&(F==null?void 0:F.mode)==="SCORE_LAST_PLAYED_LINE"){Ce(null);return}if(r.isScoringStep&&!F){const ue=r.activePlayerId,fe=r.players.find(Je=>Je.id===ue);if(fe&&(fe.id===o||fe.isDummy)){let Je=!1,ze=null;for(let Fe=0;Fe<r.board.length;Fe++){for(let se=0;se<r.board.length;se++){const X=(C=r.board[Fe])==null?void 0:C[se],tt=X==null?void 0:X.card;if((U=tt==null?void 0:tt.statuses)!=null&&U.some(Le=>Le.type==="LastPlayed"&&Le.addedByPlayerId===ue)){ze={row:Fe,col:se},Je=!0;break}}if(Je)break}Je&&ze?Ce({type:"ENTER_MODE",mode:"SCORE_LAST_PLAYED_LINE",sourceCoords:ze}):(ue===o||fe!=null&&fe.isDummy&&o===1)&&H()}}},[r.isScoringStep,r.activePlayerId,o,r.board,F,H,r.players]),p.useEffect(()=>{var C,U,ue,fe,Q,Je,ze,Fe;if(Te.length>0&&!F&&!pe){const se=Te[0];Ue(Le=>Le.slice(1));const X={...se};if(X.mode==="SELECT_CELL"&&un.lastMovedCardCoords){const{row:Le,col:Ye}=un.lastMovedCardCoords;if(typeof Le=="number"&&typeof Ye=="number"&&Le>=0&&Le<r.board.length&&r.board[Le]&&Ye>=0&&Ye<r.board[Le].length&&r.board[Le][Ye]){const pt=r.board[Le][Ye].card;pt&&(X.sourceCard=pt,X.sourceCoords=un.lastMovedCardCoords,X.recordContext=!0)}}const tt=(Le,Ye)=>{let pt=0;return Le==="Aim"?r.board.forEach(yt=>yt.forEach(tn=>{var fn,pn;(pn=(fn=tn.card)==null?void 0:fn.statuses)!=null&&pn.some(Bt=>Bt.type==="Aim"&&Bt.addedByPlayerId===Ye)&&pt++})):Le==="Exploit"&&r.board.forEach(yt=>yt.forEach(tn=>{var fn,pn;(pn=(fn=tn.card)==null?void 0:fn.statuses)!=null&&pn.some(Bt=>Bt.type==="Exploit"&&Bt.addedByPlayerId===Ye)&&pt++})),pt};if(X.type==="GLOBAL_AUTO_APPLY")if((C=X.payload)!=null&&C.cleanupCommand){const Le=X.payload.ownerId!==void 0?X.payload.ownerId:(U=X.sourceCard)==null?void 0:U.ownerId;if(Le!==void 0){const Ye=r.players.find(yt=>yt.id===Le),pt=(Ye==null?void 0:Ye.announcedCard)||X.sourceCard;pt&&pt.id!=="dummy"&&ae({card:pt,source:"announced",playerId:Le},{target:"discard",playerId:Le})}}else if((ue=X.payload)!=null&&ue.dynamicResource){const{type:Le,factor:Ye,ownerId:pt}=X.payload.dynamicResource,yt=tt(Ye,pt);if(Le==="draw"&&yt>0)for(let tn=0;tn<yt;tn++)N(pt)}else if((fe=X.payload)!=null&&fe.resourceChange){const{draw:Le,score:Ye}=X.payload.resourceChange,pt=((Q=X.sourceCard)==null?void 0:Q.ownerId)||r.activePlayerId;if(pt!=null){if(Le){const yt=typeof Le=="number"?Le:1;for(let tn=0;tn<yt;tn++)N(pt)}Ye&&m(pt,Ye)}}else(Je=X.payload)!=null&&Je.contextReward&&X.sourceCard?Oo(X,X.sourceCoords||{row:-1,col:-1}):(ze=X.payload)!=null&&ze.customAction&&X.sourceCard&&Oo(X,X.sourceCoords||{row:-1,col:-1});else if(X.type==="CREATE_STACK"||X.type==="OPEN_MODAL")Oo(X,X.sourceCoords||{row:-1,col:-1});else{const Le=((Fe=X.sourceCard)==null?void 0:Fe.ownerId)||o;Hl(X,r,Le,un)?Ce(X):X.sourceCoords&&X.sourceCoords.row>=0&&q(X.sourceCoords)}}},[Te,F,pe,o,N,m,r.activePlayerId,r.board,ae,un,me,r.players,Oo,q]);const cn=p.useCallback(()=>{it(C=>({...C,isTokensModalOpen:!1,isCountersModalOpen:!1,isRulesModalOpen:!1})),Dn(null),dn(null),Hr(null),Tr(null),Zn(null),Er({tokensModalAnchor:null,countersModalAnchor:null})},[]),jm=p.useCallback(()=>{ls&&(r.gameMode===vr.FreeForAll?c():it(C=>({...C,isTeamAssignOpen:!0})))},[ls,r.gameMode,c]),Im=p.useCallback(C=>{k(C),it(U=>({...U,isTeamAssignOpen:!1})),c()},[k,c]),Nm=p.useCallback(C=>{l(C),it(U=>({...U,isJoinModalOpen:!1}))},[l]),_m=p.useCallback(()=>{s(),a(1)},[s,a]),Dm=p.useCallback(()=>{ce(),it(C=>({...C,isJoinModalOpen:!0}))},[ce]),Rm=p.useCallback(C=>{localStorage.setItem("custom_ws_url",C.trim()),it(U=>({...U,isSettingsModalOpen:!1})),xe()},[xe]),Am=p.useCallback(()=>{const C=Date.now();w(C),localStorage.setItem("image_refresh_data",JSON.stringify({version:C,timestamp:C})),Ie()},[Ie]),Xn=p.useCallback(C=>{o!==null&&re({...C,playerId:o})},[o,re]),er=p.useCallback(()=>R(null),[]),Lo=p.useCallback((C,U,ue)=>{C.preventDefault(),!(F||pe||j)&&(C.stopPropagation(),o!==null&&R({x:C.clientX,y:C.clientY,type:U,data:ue}))},[F,pe,j,o]),Om=(C,U)=>{var ze;if(F||pe||Sr.current)return;const ue=C.ownerId===o;if(ue&&C.isFaceDown){Ne(U);return}const fe=C.ownerId?r.players.find(Fe=>Fe.id===C.ownerId):void 0,Q=(ze=C.statuses)==null?void 0:ze.some(Fe=>Fe.type==="Revealed"&&Fe.addedByPlayerId===o);!C.isFaceDown||C.revealedTo==="all"||Array.isArray(C.revealedTo)&&C.revealedTo.includes(o)||Q||ue?dn({card:C,player:fe}):o!==null&&ee({source:"board",ownerId:C.ownerId,boardCoords:U},o)},Pm=C=>{F||pe||Sr.current||Xn({type:"cell",row:C.row,col:C.col})},Jd=(C,U,ue)=>{var fe;if(!(F||pe)&&!Sr.current){if(C.id===o||C.isDummy){if(U.deck===Be.Command){cn(),Ao(U,{card:U,source:"hand",playerId:C.id,cardIndex:ue});return}cn();const Q={card:U,source:"hand",playerId:C.id,cardIndex:ue};S({card:U,sourceItem:Q,faceDown:!1})}else if(o!==null){const Q=U.revealedTo==="all",Je=Array.isArray(U.revealedTo)&&U.revealedTo.includes(o),ze=(fe=U.statuses)==null?void 0:fe.some(se=>se.type==="Revealed"&&se.addedByPlayerId===o);Q||Je||ze||!!C.isDummy||!!C.isDisconnected?dn({card:U,player:C}):ee({source:"hand",ownerId:C.id,cardIndex:ue},o)}}},Yd=p.useCallback(C=>{Dn({player:C,isDeckView:!0})},[]),Zd=p.useCallback(C=>{Dn({player:C,isDeckView:!1})},[]),qt=p.useMemo(()=>Ge?r.players.find(C=>C.id===Ge.player.id)||Ge.player:null,[Ge,r.players]),Lm=p.useMemo(()=>{var C,U,ue;if(((C=Ge==null?void 0:Ge.pickConfig)==null?void 0:C.filterType)==="Unit")return fe=>{var Q;return!!((Q=fe.types)!=null&&Q.includes("Unit"))};if(((U=Ge==null?void 0:Ge.pickConfig)==null?void 0:U.filterType)==="Command")return fe=>{var Q;return fe.deck===Be.Command||!!((Q=fe.types)!=null&&Q.includes("Command"))};if(((ue=Ge==null?void 0:Ge.pickConfig)==null?void 0:ue.filterType)==="Optimates")return fe=>{var Q,Je;return!!((Q=fe.types)!=null&&Q.includes("Unit"))&&!!((Je=fe.types)!=null&&Je.includes("Optimates"))}},[(Xd=Ge==null?void 0:Ge.pickConfig)==null?void 0:Xd.filterType]),Qd=C=>{if(!(Ge!=null&&Ge.pickConfig))return;const{action:U,isDeck:ue}=Ge.pickConfig;U==="recover"?(ue?ae({card:qt.deck[C],source:"deck",playerId:qt.id,cardIndex:C},{target:"hand",playerId:qt.id}):Oe(qt.id,C),Dn(null)):U==="resurrect"&&(F==null?void 0:F.mode)==="IMMUNIS_RETRIEVE"&&(Ce(fe=>({...fe,payload:{...fe.payload,selectedCardIndex:C}})),Dn(null))},Mm=(C,U)=>{var ze;if(!Ge||!qt)return;const ue=Ge.isDeckView||((ze=Ge.pickConfig)==null?void 0:ze.isDeck),fe=ue?"deckCard":"discardCard",Je=(ue?qt.deck:qt.discard)[U];Je&&Lo(C,fe,{card:Je,player:qt,cardIndex:U})},zm=p.useMemo(()=>{var Je,ze,Fe;if(!E||o===null)return null;const{type:C,data:U,x:ue,y:fe}=E;let Q=[];if(C==="emptyBoardCell")Q.push({label:t("highlightCell"),onClick:()=>Xn({type:"cell",row:U.boardCoords.row,col:U.boardCoords.col})}),Q.push({label:t("highlightColumn"),onClick:()=>Xn({type:"col",col:U.boardCoords.col})}),Q.push({label:t("highlightRow"),onClick:()=>Xn({type:"row",row:U.boardCoords.row})});else if(C==="boardItem"||C==="announcedCard"){const se=C==="boardItem";let X=se?r.board[U.boardCoords.row][U.boardCoords.col].card:U.card,tt=se?null:U.player;if(!se&&tt){const ot=r.players.find(bn=>bn.id===tt.id);ot&&(tt=ot,X=ot.announcedCard||X)}if(!X)return R(null),null;const Le=X.ownerId?r.players.find(ot=>ot.id===X.ownerId):void 0,Ye=X.ownerId===o,pt=!!(Le!=null&&Le.isDummy),yt=Ye||pt,tn=(Je=X.statuses)==null?void 0:Je.some(ot=>ot.type==="Revealed"&&ot.addedByPlayerId===o),fn=!X.isFaceDown||X.revealedTo==="all"||Array.isArray(X.revealedTo)&&X.revealedTo.includes(o)||tn;(fn||Ye&&X.isFaceDown)&&Q.push({label:t("view"),isBold:!0,onClick:()=>dn({card:X,player:Le})}),!se&&yt&&X.deck===Be.Command&&Q.push({label:t("play"),isBold:!0,onClick:()=>{Ao(X,{card:X,source:"announced",playerId:tt.id})}}),se&&yt&&(X.isFaceDown?Q.push({label:t("flipUp"),isBold:!0,onClick:()=>Ne(U.boardCoords)}):Q.push({label:t("flipDown"),onClick:()=>v(U.boardCoords)}));const pn=se?{card:X,source:"board",boardCoords:U.boardCoords}:{card:X,source:"announced",playerId:tt.id},Bt=X.ownerId,Fn=(X==null?void 0:X.deck)===Be.Tokens||(X==null?void 0:X.deck)==="counter";if(se&&(yt&&X.isFaceDown&&Q.push({label:t("revealToAll"),onClick:()=>$(U.boardCoords,"all")}),!Ye&&!fn&&Q.push({label:t("requestReveal"),onClick:()=>ee({source:"board",ownerId:X.ownerId,boardCoords:U.boardCoords},o)})),Q.length>0&&Q.push({isDivider:!0}),yt&&fn&&(Q.push({label:t("toHand"),disabled:Fn,onClick:()=>ae(pn,{target:"hand",playerId:Bt})}),Bt)){const ot=t(Fn?"remove":"toDiscard");Q.push({label:ot,onClick:()=>ae(pn,{target:"discard",playerId:Bt})}),Q.push({label:t("toDeckTop"),disabled:Fn,onClick:()=>ae(pn,{target:"deck",playerId:Bt,deckPosition:"top"})}),Q.push({label:t("toDeckBottom"),disabled:Fn,onClick:()=>ae(pn,{target:"deck",playerId:Bt,deckPosition:"bottom"})})}if(se&&(Q.push({isDivider:!0}),Q.push({label:t("highlightCell"),onClick:()=>Xn({type:"cell",row:U.boardCoords.row,col:U.boardCoords.col})}),Q.push({label:t("highlightColumn"),onClick:()=>Xn({type:"col",col:U.boardCoords.col})}),Q.push({label:t("highlightRow"),onClick:()=>Xn({type:"row",row:U.boardCoords.row})})),fn&&(yt||se)){const ot=["Aim","Exploit","Stun","Shield","Support","Threat","Revealed"],bn=[];ot.forEach(Cn=>{var qr;(((qr=X.statuses)==null?void 0:qr.filter(Bm=>Bm.type===Cn).length)||0)>0&&bn.push({type:"statusControl",label:Cn,onAdd:()=>se?me(U.boardCoords,Cn,o):z(tt.id,Cn,o),onRemove:()=>se?ve(U.boardCoords,Cn):K(tt.id,Cn),removeDisabled:!1})}),bn.length>0&&(Q.length>0&&!("isDivider"in Q[Q.length-1])&&Q.push({isDivider:!0}),Q.push(...bn)),Q.length>0&&!("isDivider"in Q[Q.length-1])&&Q.push({isDivider:!0}),Q.push({type:"statusControl",label:t("power"),onAdd:()=>se?J(U.boardCoords,1):ne(tt.id,1),onRemove:()=>se?J(U.boardCoords,-1):ne(tt.id,-1),removeDisabled:!1})}}else if(C==="token_panel_item"){const{card:se}=U,X={card:se,source:"token_panel"};Q.push({label:t("view"),isBold:!0,onClick:()=>dn({card:se})}),Q.push({isDivider:!0}),Q.push({label:t("play"),isBold:!0,onClick:()=>{cn(),S({card:se,sourceItem:X,faceDown:!1})}}),Q.push({label:t("playFaceDown"),onClick:()=>{cn(),S({card:se,sourceItem:X,faceDown:!0})}})}else if(["handCard","discardCard","deckCard"].includes(C)){let{card:se,player:X}=U;const{boardCoords:tt,cardIndex:Le}=U,Ye=r.players.find(Rn=>Rn.id===X.id);Ye&&(X=Ye,C==="handCard"?se=Ye.hand[Le]||se:C==="discardCard"?se=Ye.discard[Le]||se:C==="deckCard"&&(se=Ye.deck[Le]||se));const pt=X.id===o||!!X.isDummy,yt=r.players.find(Rn=>Rn.id===o),tn=(yt==null?void 0:yt.teamId)!==void 0&&X.teamId===yt.teamId,fn=se.revealedTo==="all"||Array.isArray(se.revealedTo)&&se.revealedTo.includes(o),pn=(ze=se.statuses)==null?void 0:ze.some(Rn=>Rn.type==="Revealed"&&Rn.addedByPlayerId===o),Bt=C!=="handCard"?!0:X.id===o||tn||!!X.isDummy||!!X.isDisconnected||fn||pn;let Fn;C==="handCard"?Fn="hand":C==="discardCard"?Fn="discard":Fn="deck";const ot={card:se,source:Fn,playerId:X==null?void 0:X.id,cardIndex:Le,boardCoords:tt},bn=se.ownerId,Cn=(se==null?void 0:se.deck)===Be.Tokens||(se==null?void 0:se.deck)==="counter";if(Bt){const Rn=se.ownerId?r.players.find(qr=>qr.id===se.ownerId):void 0;Q.push({label:t("view"),isBold:!0,onClick:()=>dn({card:se,player:Rn})})}pt?(se.deck===Be.Command?Q.push({label:t("play"),isBold:!0,onClick:()=>{cn(),Ao(se,ot)}}):C==="handCard"?(Q.push({label:t("play"),isBold:!0,onClick:()=>{cn(),S({card:se,sourceItem:ot,faceDown:!1})}}),Q.push({label:t("playFaceDown"),onClick:()=>{cn(),S({card:se,sourceItem:ot,faceDown:!0})}})):Bt&&["discardCard","deckCard"].includes(C)&&(Q.push({label:t("play"),isBold:!0,onClick:()=>{cn(),S({card:se,sourceItem:ot,faceDown:!1})}}),Q.push({label:t("playFaceDown"),onClick:()=>{cn(),S({card:se,sourceItem:ot,faceDown:!0})}})),Q.length>0&&Q.push({isDivider:!0}),C==="handCard"&&Q.push({label:t("revealToAll"),onClick:()=>L(X.id,Le,"all")}),Q.length>0&&!("isDivider"in Q[Q.length-1])&&Q.push({isDivider:!0}),C==="discardCard"?Q.push({label:t("toHand"),disabled:Cn,onClick:()=>ae(ot,{target:"hand",playerId:bn})}):C==="handCard"&&Q.push({label:t("toDiscard"),onClick:()=>ae(ot,{target:"discard",playerId:bn})}),["handCard","discardCard"].includes(C)&&bn&&(Q.push({label:t("toDeckTop"),disabled:Cn,onClick:()=>ae(ot,{target:"deck",playerId:bn,deckPosition:"top"})}),Q.push({label:t("toDeckBottom"),disabled:Cn,onClick:()=>ae(ot,{target:"deck",playerId:bn,deckPosition:"bottom"})})),C==="deckCard"&&(Q.push({label:t("toHand"),disabled:Cn,onClick:()=>ae(ot,{target:"hand",playerId:X.id})}),Q.push({label:t("toDiscard"),onClick:()=>ae(ot,{target:"discard",playerId:X.id})})),C==="handCard"&&(((Fe=se.statuses)==null?void 0:Fe.filter(qr=>qr.type==="Revealed").length)||0)>0&&(Q.length>0&&!("isDivider"in Q[Q.length-1])&&Q.push({isDivider:!0}),Q.push({type:"statusControl",label:t("revealed"),onAdd:()=>W(X.id,Le,"Revealed",o),onRemove:()=>he(X.id,Le,"Revealed"),removeDisabled:!1}))):C==="handCard"&&!Bt&&Q.push({label:t("requestReveal"),onClick:()=>ee({source:"hand",ownerId:X.id,cardIndex:Le},o)})}else if(C==="deckPile"){const{player:se}=U;(se.id===o||!!se.isDummy)&&(Q.push({label:t("drawCard"),onClick:()=>N(se.id)}),Q.push({label:t("drawStartingHand"),onClick:()=>{for(let tt=0;tt<6;tt++)N(se.id)}}),Q.push({label:t("viewTopCards"),onClick:()=>Zn({targetPlayerId:se.id,isLocked:!1,initialCount:1})}),Q.push({label:t("shuffle"),onClick:()=>De(se.id)})),Q.push({label:t("view"),onClick:()=>Yd(se)})}else if(C==="discardPile"){const{player:se}=U;Q.push({label:t("view"),onClick:()=>Zd(se)})}return Q=Q.filter((se,X)=>"isDivider"in se?!(X===0||X===Q.length-1||"isDivider"in Q[X-1]):!0),i.jsx(im,{x:ue,y:fe,items:Q,onClose:er})},[r,o,ae,Xn,me,ve,J,z,K,ne,W,he,N,De,Ne,v,L,$,ee,t,Ao,E,cn,er,Yd,Zd]);p.useEffect(()=>{window.addEventListener("click",er);const C=U=>{U.target.closest("[data-interactive]")||er()};return window.addEventListener("contextmenu",C),()=>{window.removeEventListener("click",er),window.removeEventListener("contextmenu",C)}},[er]),p.useEffect(()=>{O&&er()},[O,er]);const Um=p.useCallback(C=>{if(ht.isTokensModalOpen)it(U=>({...U,isTokensModalOpen:!1})),Er(U=>({...U,tokensModalAnchor:null}));else{it(ue=>({...ue,isTokensModalOpen:!0,isCountersModalOpen:!1}));const U=C.currentTarget.getBoundingClientRect();Er({tokensModalAnchor:{top:U.top,left:U.left},countersModalAnchor:null})}},[ht.isTokensModalOpen]),Fm=p.useCallback(C=>{if(ht.isCountersModalOpen)it(U=>({...U,isCountersModalOpen:!1})),Er(U=>({...U,countersModalAnchor:null}));else{it(ue=>({...ue,isCountersModalOpen:!0,isTokensModalOpen:!1}));const U=C.currentTarget.getBoundingClientRect();Er({countersModalAnchor:{top:U.top,left:U.left},tokensModalAnchor:null})}},[ht.isCountersModalOpen]);return wm?i.jsxs("div",{className:`relative w-screen h-screen overflow-hidden ${pe?"cursor-none":""}`,children:[i.jsx(Gg,{gameId:r.gameId,isGameStarted:r.isGameStarted,onStartGame:jm,onResetGame:_e,activeGridSize:r.activeGridSize,onGridSizeChange:x,dummyPlayerCount:r.dummyPlayerCount,onDummyPlayerCountChange:A,realPlayerCount:xm,connectionStatus:I,onExitGame:we,onOpenTokensModal:Um,onOpenCountersModal:Fm,gameMode:r.gameMode,onGameModeChange:g,isPrivate:r.isPrivate,onPrivacyChange:b,isHost:ls,onSyncGame:Am,currentPhase:r.currentPhase,onNextPhase:H,onPrevPhase:Z,onSetPhase:G,isAutoAbilitiesEnabled:et,onToggleAutoAbilities:vt,isAutoDrawEnabled:xt,onToggleAutoDraw:C=>{o&&Ae(o,C)},isScoringStep:r.isScoringStep,currentRound:r.currentRound,turnNumber:r.turnNumber}),r.isRoundEndModalOpen&&i.jsx(mv,{gameState:r,onConfirm:St,onExit:we}),ht.isTeamAssignOpen&&i.jsx(Kg,{players:r.players,gameMode:r.gameMode,onCancel:()=>it(C=>({...C,isTeamAssignOpen:!1})),onConfirm:Im}),r.isReadyCheckActive&&wt&&i.jsx(qg,{players:r.players,localPlayer:wt,onReady:h,onCancel:d}),Ro&&i.jsx(Jg,{fromPlayer:r.players.find(C=>C.id===Ro.fromPlayerId),cardCount:Ro.cardIdentifiers.length,onAccept:()=>oe(Ro.fromPlayerId,!0),onDecline:()=>oe(Ro.fromPlayerId,!1)}),Vr&&i.jsx(Yg,{isOpen:!!Vr,card:Vr,playerColorMap:new Map(r.players.map(C=>[C.id,C.color])),onConfirm:C=>fm(C,Vr),onCancel:()=>{Hr(null),Ue([]),Do({})}}),$r&&i.jsx(hv,{isOpen:!!$r,data:$r,onConfirm:C=>pm(C,$r),onCancel:()=>{Tr(null),Ce(null)}}),Ve&&Kd&&i.jsx(yv,{isOpen:!!Ve,player:Kd,onClose:Sm,onReorder:km,onMoveToBottom:bm,onViewCard:C=>dn({card:C}),onMoveToHand:Cm,onMoveToDiscard:Tm,onPlayCard:Em,playerColorMap:Po,localPlayerId:o,imageRefreshVersion:y,initialCount:Ve.initialCount,isLocked:Ve.isLocked}),Wr&&i.jsx(am,{card:Wr.card,ownerPlayer:Wr.player,onClose:()=>dn(null),statusDescriptions:Bi,allPlayers:r.players,imageRefreshVersion:y}),Ge&&qt&&i.jsx(Vg,{isOpen:!!Ge,onClose:()=>{Dn(null),Ce(null)},title:Ge.isDeckView||(eu=Ge.pickConfig)!=null&&eu.isDeck?Ge.pickConfig?t("selectCardFromDeck"):t("deckView"):Ge.pickConfig?t("selectCardFromDiscard"):t("discardView"),player:qt,cards:Ge.isDeckView||(tu=Ge.pickConfig)!=null&&tu.isDeck?qt.deck:qt.discard,setDraggedItem:M,canInteract:!!Ge.pickConfig||qt.id===o||!!qt.isDummy,onCardClick:Qd,onCardDoubleClick:Qd,onCardContextMenu:Mm,onReorder:(C,U)=>{var fe;const ue=Ge.isDeckView||(fe=Ge.pickConfig)!=null&&fe.isDeck?"deck":"discard";Ft(C,U,ue)},isDeckView:Ge.isDeckView||((nu=Ge.pickConfig)==null?void 0:nu.isDeck),playerColorMap:Po,localPlayerId:o,imageRefreshVersion:y,highlightFilter:Lm}),i.jsx(Hg,{isOpen:ht.isTokensModalOpen,onClose:()=>it(C=>({...C,isTokensModalOpen:!1})),setDraggedItem:M,openContextMenu:Lo,canInteract:!!o&&!Kr,anchorEl:Ra.tokensModalAnchor,imageRefreshVersion:y}),i.jsx(Wg,{isOpen:ht.isCountersModalOpen,onClose:()=>it(C=>({...C,isCountersModalOpen:!1})),canInteract:!!o&&!Kr,anchorEl:Ra.countersModalAnchor,imageRefreshVersion:y,onCounterMouseDown:vm,cursorStack:pe}),zm,pe&&i.jsx("div",{ref:gm,className:"fixed top-0 left-0 pointer-events-none z-[99999] flex items-center justify-center",style:{willChange:"transform"},children:i.jsxs("div",{className:"w-12 h-12 rounded-full border-2 border-white flex items-center justify-center relative bg-gray-900",style:{backgroundImage:`url(${Sv})`,backgroundSize:"contain",backgroundPosition:"center",backgroundRepeat:"no-repeat"},children:[Eo[pe.type]?i.jsx("img",{src:`${Eo[pe.type]}${y?`?v=${y}`:""}`,alt:pe.type,className:"w-8 h-8 object-contain"}):i.jsx("span",{className:`font-bold text-white drop-shadow-md ${pe.type.startsWith("Power")?"text-sm":"text-lg"}`,children:pe.type.startsWith("Power")?pe.type:pe.type.charAt(0)}),pe.count>1&&i.jsx("div",{className:"absolute -top-2 -right-2 bg-red-600 text-white text-xs font-bold w-6 h-6 flex items-center justify-center rounded-full border-2 border-white shadow-sm z-10",children:pe.count})]})}),i.jsxs("div",{className:"relative h-full w-full pt-14 overflow-hidden bg-gray-900",children:[wt&&i.jsx("div",{ref:dm,className:"absolute left-0 top-14 bottom-[2px] z-30 bg-panel-bg shadow-xl flex flex-col border-r border-gray-700 w-fit min-w-0 pl-[2px] py-[2px] pr-0 transition-all duration-100 overflow-hidden",style:{width:Vd},children:i.jsx(wc,{player:wt,isLocalPlayer:!0,localPlayerId:o,isSpectator:Kr,isGameStarted:r.isGameStarted,onNameChange:C=>T(wt.id,C),onColorChange:C=>u(wt.id,C),onScoreChange:C=>m(wt.id,C),onDeckChange:C=>f(wt.id,C),onLoadCustomDeck:C=>D(wt.id,C),onDrawCard:()=>N(wt.id),handleDrop:_,draggedItem:O,setDraggedItem:M,openContextMenu:Lo,onHandCardDoubleClick:Jd,playerColorMap:Po,allPlayers:r.players,localPlayerTeamId:wt==null?void 0:wt.teamId,activePlayerId:r.activePlayerId,onToggleActivePlayer:Y,imageRefreshVersion:y,layoutMode:"list-local",onCardClick:Hd,validHandTargets:Ct,onAnnouncedCardDoubleClick:$d,currentPhase:r.currentPhase,disableActiveHighlights:ds,preserveDeployAbilities:Qe,roundWinners:r.roundWinners,startingPlayerId:r.startingPlayerId,onDeckClick:Wd,isDeckSelectable:(F==null?void 0:F.mode)==="SELECT_DECK"},wt.id)}),i.jsx("div",{className:"absolute top-14 bottom-0 z-10 flex items-center justify-center pointer-events-none w-full left-0",children:i.jsx("div",{ref:um,className:"pointer-events-auto h-full aspect-square flex items-center justify-center py-[2px]",children:i.jsx(em,{board:r.board,isGameStarted:r.isGameStarted,activeGridSize:r.activeGridSize,handleDrop:_,draggedItem:O,setDraggedItem:M,openContextMenu:Lo,playMode:j,setPlayMode:S,highlight:B,playerColorMap:Po,localPlayerId:o,onCardDoubleClick:Om,onEmptyCellDoubleClick:Pm,imageRefreshVersion:y,cursorStack:pe,currentPhase:r.currentPhase,activePlayerId:r.activePlayerId,onCardClick:hm,onEmptyCellClick:ym,validTargets:Me,noTargetOverlay:Qn,disableActiveHighlights:ds,preserveDeployAbilities:Qe,activeFloatingTexts:ye,abilitySourceCoords:(F==null?void 0:F.sourceCoords)||null,abilityCheckKey:lm})})}),i.jsx("div",{className:"absolute right-0 top-14 bottom-[2px] z-30 bg-panel-bg shadow-xl flex flex-col border-l border-gray-700 min-w-0 pr-[2px] py-[2px] pl-0 transition-all duration-100 overflow-hidden",style:{width:Vd},children:i.jsx("div",{className:"flex flex-col h-full w-full gap-[2px]",children:r.players.filter(C=>C.id!==o).map(C=>i.jsx("div",{className:"w-full flex-1 min-h-0 flex flex-col",children:i.jsx(wc,{player:C,isLocalPlayer:!1,localPlayerId:o,isSpectator:Kr,isGameStarted:r.isGameStarted,onNameChange:U=>T(C.id,U),onColorChange:U=>u(C.id,U),onScoreChange:U=>m(C.id,U),onDeckChange:U=>f(C.id,U),onLoadCustomDeck:U=>D(C.id,U),onDrawCard:()=>N(C.id),handleDrop:_,draggedItem:O,setDraggedItem:M,openContextMenu:Lo,onHandCardDoubleClick:Jd,playerColorMap:Po,allPlayers:r.players,localPlayerTeamId:wt==null?void 0:wt.teamId,activePlayerId:r.activePlayerId,onToggleActivePlayer:Y,imageRefreshVersion:y,layoutMode:"list-remote",onCardClick:Hd,currentPhase:r.currentPhase,validHandTargets:Ct,onAnnouncedCardDoubleClick:$d,disableActiveHighlights:ds,preserveDeployAbilities:Qe,roundWinners:r.roundWinners,startingPlayerId:r.startingPlayerId,onDeckClick:Wd,isDeckSelectable:(F==null?void 0:F.mode)==="SELECT_DECK"})},C.id))})})]})]}):i.jsx(cv,{handleCreateGame:_m,setSettingsModalOpen:C=>it(U=>({...U,isSettingsModalOpen:C})),handleOpenJoinModal:Dm,setDeckBuilderOpen:C=>it(U=>({...U,isDeckBuilderOpen:C})),setRulesModalOpen:C=>it(U=>({...U,isRulesModalOpen:C})),isJoinModalOpen:ht.isJoinModalOpen,setJoinModalOpen:C=>it(U=>({...U,isJoinModalOpen:C})),handleJoinGame:Nm,gamesList:V,isDeckBuilderOpen:ht.isDeckBuilderOpen,setViewingCard:dn,isSettingsModalOpen:ht.isSettingsModalOpen,handleSaveSettings:Rm,isRulesModalOpen:ht.isRulesModalOpen,viewingCard:Wr,gameState:r,imageRefreshVersion:y,t})});class Iv extends dr.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0}}componentDidCatch(t,n){console.error("Uncaught error:",t,n)}render(){return this.state.hasError?i.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 text-white p-4 text-center",children:[i.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Something went wrong"}),i.jsx("p",{className:"mb-6 text-gray-400",children:"The application encountered an unexpected error."}),i.jsx("button",{onClick:()=>window.location.reload(),className:"bg-indigo-600 px-6 py-3 rounded-lg hover:bg-indigo-700 transition font-bold shadow-lg",children:"Reload Game"})]}):this.props.children}}const sm=document.getElementById("root");if(!sm)throw new Error("Could not find root element to mount to");const Nv=Vs.createRoot(sm);Nv.render(i.jsx(Iv,{children:i.jsx(Og,{children:i.jsx(jv,{})})}));
